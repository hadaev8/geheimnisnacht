# Skaven
# Skaven on Skaven
skaven_tributary_cb = {
	name = CB_NAME_SKAVEN_TRIBUTARY
	war_name = WAR_NAME_SKAVEN_TRIBUTARY
	sprite = 1
	truce_days = 100
	is_permanent = yes
	hostile_against_others = yes
	can_ask_to_join_war = yes
	allow_whitepeace = no
	can_call_allies = yes
	display_on_map = yes
	battle_warscore_mult = 0.75	# Skaven stubborness
	can_use = {
		has_dlc = "Horse Lords"
		ROOT = {
			culture_group = skaven_group
			higher_tier_than = BARON
			mercenary = no
			is_tributary = no
			NOT = {
				is_vassal_or_below = FROM
			}
			NOT = {
				is_liege_or_above = FROM
			}
			wh_cb_pays_tribute_to_from_trigger = no
		}
		FROM = {
			independent = yes
			culture_group = skaven_group
			higher_tier_than = BARON
			wh_cb_pays_tribute_to_root_trigger = no
		}
		# The attacker needs a border, or be at most two sea zones away from one of the target's counties
		FROM = {
			any_realm_province = {
				any_neighbor_province = {
					OR = {
						AND = {
							has_owner = yes
							owner = {
								OR = {
									character = ROOT
									is_liege_or_above = ROOT
								}
							}
						}
						AND = {
							is_land = no
							any_neighbor_province = {
								OR = {
									AND = {
										has_owner = yes
										owner = {
											OR = {
												character = ROOT
												is_liege_or_above = ROOT
											}
										}
									}
									AND = {
										is_land = no
										any_neighbor_province = {
											owner = {
												OR = {
													character = ROOT
													is_liege_or_above = ROOT
												}
											}
										}
									}
								}
							}
						}
					}
				}
			}
		}
		# The defender is not in any tributary war
		FROM = {
			NOT = {
				any_war = {
					using_cb = tributary_cb
				}
			}
		}
	}
	on_attacker_leader_death = {
		end_war = invalid
	}
	on_success = {
		FROM = {
			save_event_target_as = target_loser
			prestige = -100
			custom_tooltip = {
				text = "REMOVE_PREVIOUS_SUZERAIN"
				hidden_tooltip = {
					any_suzerain = {
						event_target:target_loser = {
							remove_tributary = PREV
						}
					}
				}
			}
		}
		ROOT = {
			prestige = 200
			make_tributary = {
				who = FROM
				percentage = 0.75
			}
		}
		if = {
			limit = {
				ROOT = {
					is_nomadic = yes
				}
			}
			ROOT = {
				clan_title = {
					save_event_target_as = liege_clan
				}
				any_vassal = {
					limit = {
						is_nomadic = yes
					}
					clan_title = {
						clan_opinion = {
							who = event_target:liege_clan
							modifier = won_tributary_war
							years = 5
						}
					}
				}
			}
		}
		if = {
			limit = {
				ROOT = {
					is_tribal = yes
				}
			}
			ROOT = {
				any_vassal = {
					limit = {
						is_tribal = yes
					}
					opinion = {
						who = PREV
						modifier = won_tributary_war
						years = 5
					}
				}
			}
		}
	}
	on_fail = {
		ROOT = {
			prestige = -100
		}
		FROM = {
			prestige = 100
		}
	}
	on_reverse_demand = {
		ROOT = {
			prestige = -200
			transfer_scaled_wealth = {
				to = FROM
				value = 4.0
			}
		}
		FROM = {
			prestige = 200
		}
	}
	attacker_ai_victory_worth = {
		factor = -1 # always accept
	}
	attacker_ai_defeat_worth = {
		factor = 100
	}
	defender_ai_victory_worth = {
		factor = -1 # always accept
	}
	defender_ai_defeat_worth = {
		factor = 100
		modifier = {
			factor = 1.5
		}
		modifier = {
			factor = 0.85
			ROOT = {
				relative_power = {
					who = FROM power = 1.2
				}
			}
		}
		modifier = {
			factor = 0.85
			ROOT = {
				relative_power = {
					who = FROM power = 1.5
				}
			}
		}
		modifier = {
			factor = 0.8
			ROOT = {
				relative_power = {
					who = FROM power = 2.0
				}
			}
		}
		modifier = {
			factor = 0.8
			ROOT = {
				relative_power = {
					who = FROM power = 2.5
				}
			}
		}
		modifier = {
			factor = 0.8
			ROOT = {
				relative_power = {
					who = FROM power = 3
				}
			}
		}
		modifier = {
			factor = 0.75
			ROOT = {
				relative_power = {
					who = FROM power = 4
				}
			}
		}
		modifier = {
			factor = 0.75
			ROOT = {
				relative_power = {
					who = FROM power = 5
				}
			}
		}
		modifier = {
			factor = 0.75
			ROOT = {
				relative_power = {
					who = FROM power = 6
				}
			}
		}
		modifier = {
			factor = 0.5
			ROOT = {
				relative_power = {
					who = FROM power = 8
				}
			}
		}
		modifier = {
			factor = 0.25
			ROOT = {
				relative_power = {
					who = FROM power = 10
				}
			}
		}
		modifier = {
			factor = 2
			ROOT = {
				distance_from_realm = {
					who = FROM
					value = 20
				}
			}
		}
		modifier = {
			factor = 2
			ROOT = {
				distance_from_realm = {
					who = FROM
					value = 40
				}
			}
		}
		modifier = {
			factor = 3
			ROOT = {
				distance_from_realm = {
					who = FROM
					value = 80
				}
			}
		}
		modifier = {
			factor = 4
			ROOT = {
				distance_from_realm = {
					who = FROM
					value = 120
				}
			}
		}
	}
	ai_will_do = {
		factor = 1
		modifier = {
			factor = 2
		}
		modifier = {
			factor = 5
			ROOT = {
				OR = {
					trait = warlock_engineer
					trait = plaguelord
					trait = master_moulder
					trait = eshin_assassin
					trait = council_warlord
					trait = grey_seer
				}
			}
		}
		# Nobody attacks chaos wastes but chaos cultists
		modifier = {
			factor = 0
			FROM = {
				de_jure_liege = e_chaos_wastes
			}
			FROM = {
				top_liege = {
					de_jure_liege = e_chaos_wastes
				}
			}
			ROOT = {
				NOR = {
					religion_group = chaos_gods_group
					religion_group = old_gods_group
				}
			}
		}
		modifier = {
			factor = 2
			ROOT = {
				trait = proud
			}
		}
		modifier = {
			factor = 2
			ROOT = {
				trait = brave
			}
		}
		modifier = {
			factor = 2
			ROOT = {
				trait = greedy
			}
		}
		modifier = {
			factor = 3
			ROOT = {
				tier = KING
			}
		}
		modifier = {
			factor = 0.1 # Nomads are the only ones who like using the CB
			ROOT = {
				is_nomadic = no
			}
		}
		modifier = {
			factor = 4
			ROOT = {
				trait = greedy
			}
		}
	}
}

skaven_county_conquest = {
	name = CB_NAME_COUNTY_CONQUEST
	war_name = WAR_NAME_COUNTY_CONQUEST
	sprite = 16
	truce_days = 450
	hostile_against_others = yes
	is_permanent = yes
	check_all_titles = yes
	press_claim = yes
	can_ask_to_join_war = yes
	allow_whitepeace = no
	can_call_allies = yes
	battle_warscore_mult = 0.3	# Skaven stubborness
	can_use = {
		ROOT = {
			culture_group = skaven_group
			mercenary = no
			is_nomadic = no # Use the 'pagan_county_conquest' CB instead
			wh_cb_pays_tribute_to_from_trigger = no
		}
		FROM = {
			culture_group = skaven_group
		}
	}
	can_use_title = {
		tier = count
		wh_cb_albion_check_trigger = yes
		NOT = {
			region = world_nehekhara
		} # the title must have at least one county which is NOT nehekharan (if all are, it is dead land, and cannot be occupied).
		OR = {
			FROM = {
				has_landed_title = PREV
			}
			holder_scope = {
				is_liege_or_above = FROM
				NOT = {
					same_realm = ROOT
				}
			}
		}
		wh_cb_can_use_title_trigger = yes
		# The attacker needs a border, or be at most two sea zones away from one of the target's counties
		FROM = {
			any_realm_province = {
				any_neighbor_province = {
					OR = {
						AND = {
							has_owner = yes
							owner = {
								OR = {
									character = ROOT
									is_liege_or_above = ROOT
								}
							}
						}
						AND = {
							is_land = no
							any_neighbor_province = {
								OR = {
									AND = {
										has_owner = yes
										owner = {
											OR = {
												character = ROOT
												is_liege_or_above = ROOT
											}
										}
									}
									AND = {
										is_land = no
										any_neighbor_province = {
											owner = {
												OR = {
													character = ROOT
													is_liege_or_above = ROOT
												}
											}
										}
									}
								}
							}
						}
					}
				}
			}
		}
	}
	is_valid_title = {
		wh_cb_is_valid_title_trigger = yes
	}
	on_success_title = {
		if = {
			limit = {
				holder_scope = {
					tier = count
					NOT = {
						num_of_count_titles = 2
					}
					lower_tier_than = ROOT
				}
			}
			holder_scope = {
				set_defacto_liege = ROOT
			}
		}
		if = {
			limit = {
				holder_scope = {
					OR = {
						higher_tier_than = count
						num_of_count_titles = 2
						NOT = {
							lower_tier_than = ROOT
						}
					}
				}
			}
			usurp_title_plus_barony_if_unlanded = {
				target = ROOT
				type = invasion
			}
			any_de_jure_vassal_title = {
				# take all baronies under the one we're fighting for
				limit = {
					has_holder = yes
					NOT = {
						de_facto_liege = PREV
					}
					holder_scope = {
						OR = {
							character = FROM
							is_liege_or_above = FROM
						}
					}
				}
				usurp_title_plus_barony_if_unlanded = {
					target = ROOT
					type = invasion
				}
			}
		}
		any_attacker = {
			limit = {
				character = ROOT
			}
			participation_scaled_prestige = 100
		}
		any_attacker = {
			limit = {
				NOT = {
					character = ROOT
				}
			}
			hidden_tooltip = {
				participation_scaled_prestige = 100
			}
		}
	}
	on_fail_title = {
		ROOT = {
			prestige = -100
		}
		any_defender = {
			limit = {
				character = FROM
			}
			participation_scaled_prestige = 50
		}
		any_defender = {
			limit = {
				NOT = {
					character = FROM
				}
			}
			hidden_tooltip = {
				participation_scaled_prestige = 50
			}
		}
	}
	on_reverse_demand = {
		ROOT = {
			prestige = -200
			transfer_scaled_wealth = {
				to = FROM
				value = 4.0
			}
		}
		any_defender = {
			limit = {
				character = FROM
			}
			participation_scaled_prestige = 100
		}
		any_defender = {
			limit = {
				NOT = {
					character = FROM
				}
			}
			hidden_tooltip = {
				participation_scaled_prestige = 100
			}
		}
	}
	attacker_ai_victory_worth = {
		factor = -1 # always accept
	}
	attacker_ai_defeat_worth = {
		factor = 100
	}
	defender_ai_victory_worth = {
		factor = -1 # always accept
	}
	defender_ai_defeat_worth = {
		factor = 100
	}
	ai_will_do = {
		factor = 1
		modifier = {
			factor = 5
			ROOT = {
				OR = {
					trait = warlock_engineer
					trait = plaguelord
					trait = master_moulder
					trait = eshin_assassin
					trait = council_warlord
					trait = grey_seer
				}
			}
		}
	}
}

# Surface Duchy Conquest
skaven_foreignconquest = {
	name = CB_NAME_DUCHY_SKAVEN
	war_name = WAR_NAME_DUCHY_SKAVEN
	sprite = 1
	truce_days = 3650
	is_permanent = yes
	is_holy_war = yes
	check_de_jure_tier = DUKE # this scans all dejure duchies for the counties which are held by or vassals(or below) of selected character. Only valid if is_permanent = yes
	can_use = {
		# Greenskins are barred from using most usual CBs
		ROOT = {
			culture_group = skaven_group
			higher_tier_than = DUKE	# Only for big Clans
			wh_cb_pays_tribute_to_from_trigger = no
			is_nomadic = no
			NOT = {
				OR = {
					religion_group = greenskin_gods_group
					culture_group = orc_group
					culture_group = goblin_group
				}
			}
		}
		FROM = {
			NOT = {
				trait = vampire_necrarch_visible
			}
			NOT = {
				culture_group = skaven_group
			}
			NOT = {
				OR = {
					religion_group = greenskin_gods_group
					culture_group = orc_group
					culture_group = goblin_group
				}
			}
		}
		ROOT = {
			NOT = {
				trait = creature_nehekharan
			} # handled by separate county-level cb
			NOT = {
				trait = creature_beastman
			} # handled by separate county-level cb
			NOT = {
				religion_group = cadai_group
			}	# They expand through colonial cb
			NOT = {
				religion = hashut
			}	# They get different stuff
			NOT = {
				same_realm = FROM
			}
		}
	}
	can_use_title = {
		wh_cb_albion_check_trigger = yes
		NOT = {
			region = world_nehekhara
		} # the duchy must have at least one county which is NOT nehekharan (if all are, it is dead land, and cannot be occupied).
		# The attacker needs at least one county in the target kingdom, or a border, or be only two sea zones away from one of your counties
		any_direct_de_jure_vassal_title = {
			OR = {
				holder_scope = {
					OR = {
						character = ROOT
						is_liege_or_above = ROOT
					}
				}
				location = {
					any_neighbor_province = {
						OR = {
							AND = {
								has_owner = yes
								owner = {
									OR = {
										character = ROOT
										is_liege_or_above = ROOT
									}
								}
							}
							AND = {
								is_land = no
								any_neighbor_province = {
									OR = {
										AND = {
											has_owner = yes
											owner = {
												OR = {
													character = ROOT
													is_liege_or_above = ROOT
												}
											}
										}
										AND = {
											is_land = no
											any_neighbor_province = {
												owner = {
													OR = {
														character = ROOT
														is_liege_or_above = ROOT
													}
												}
											}
										}
									}
								}
							}
						}
					}
				}
			}
		}
	}
	is_valid = {
		wh_cb_root_not_same_realm_from_rigger = yes
	}
	on_success = {
		any_attacker = {
			limit = {
				character = ROOT
			}
			participation_scaled_piety = 100
			participation_scaled_prestige = 50
		}
		any_attacker = {
			limit = {
				NOT = {
					character = ROOT
				}
			}
			hidden_tooltip = {
				participation_scaled_piety = 100
				participation_scaled_prestige = 50
			}
		}
		ROOT = {
			religion_authority = {
				modifier = won_holy_war
				years = 20
			}
		}
		FROM = {
			religion_authority = {
				modifier = lost_holy_war
				years = 20
			}
		}
		FROM = {
			piety = -100
		}
		FROM = {
			prestige = -50
		}
	}
	on_success_title = {
		custom_tooltip = {
			text = religious_cb_succ_tip
			hidden_tooltip = {
				ROOT = {
					vassalize_or_take_under_title = {
						title = PREV
						enemy = FROM
						same_religion = yes # Only vassalize rulers of my religion
						is_religious = yes
						type = holy_war
					}
				}
			}
		}
	}
	on_fail = {
		ROOT = {
			piety = -50
			prestige = -100
		}
	}
	on_reverse_demand = {
		ROOT = {
			transfer_scaled_wealth = {
				to = FROM
				value = 4.0
			}
			piety = -75
			prestige = -150
		}
		any_defender = {
			limit = {
				character = FROM
			}
			participation_scaled_piety = 200
			participation_scaled_prestige = 100
			if = {
				limit = {
					uses_decadence = yes
				}
				participation_scaled_decadence = -5
			}
		}
		any_defender = {
			limit = {
				NOT = {
					character = FROM
				}
			}
			hidden_tooltip = {
				participation_scaled_piety = 200
				participation_scaled_prestige = 100
				if = {
					limit = {
						uses_decadence = yes
					}
					participation_scaled_decadence = -5
				}
			}
		}
		ROOT = {
			religion_authority = {
				modifier = lost_holy_war
				years = 20
			}
		}
		FROM = {
			religion_authority = {
				modifier = won_holy_war
				years = 20
			}
		}
	}
	attacker_ai_victory_worth = {
		factor = -1 # always accept
	}
	attacker_ai_defeat_worth = {
		factor = 100
	}
	defender_ai_victory_worth = {
		factor = -1 # always accept
	}
	defender_ai_defeat_worth = {
		factor = 100
	}
	ai_will_do = {
		factor = 1
		modifier = {
			factor = 5
			ROOT = {
				OR = {
					trait = warlock_engineer
					trait = plaguelord
					trait = master_moulder
					trait = eshin_assassin
					trait = council_warlord
					trait = grey_seer
				}
			}
		}
	}
}

underempire_conquest = {
	name = CB_NAME_UNDEREMPIRE_CONQUEST
	war_name = WAR_NAME_UNDEREMPIRE_CONQUEST
	sprite = 16
	truce_days = 12750
	hostile_against_others = yes
	is_permanent = yes
	check_all_titles = yes
	press_claim = yes
	can_ask_to_join_war = yes
	allow_whitepeace = no
	can_call_allies = yes
	battle_warscore_mult = 0.05	# Skaven stubborness
	can_use = {
		ROOT = {
			OR = {
				trait = creature_dwarf
				trait = creature_chaos_dwarf
				trait = creature_goblin
			}
			NOT = {
				culture_group = FROM
			}
			mercenary = no
			is_nomadic = no # Use the 'pagan_county_conquest' CB instead
			wh_cb_pays_tribute_to_from_trigger = no
		}
	}
	can_use_title = {
		tier = count
		wh_cb_albion_check_trigger = yes
		region = world_underempire
		OR = {
			FROM = {
				has_landed_title = PREV
			}
			holder_scope = {
				is_liege_or_above = FROM
				NOT = {
					same_realm = ROOT
				}
			}
		}
		wh_cb_can_use_title_trigger = yes
		location = {
			any_neighbor_province = {
				owner = {
					OR = {
						character = ROOT
						is_liege_or_above = ROOT
					}
				}
			}
		}
	}
	is_valid_title = {
		wh_cb_is_valid_title_trigger = yes
	}
	on_success_title = {
		usurp_title_plus_barony_if_unlanded = {
			target = ROOT
			type = invasion
		}
		any_de_jure_vassal_title = {
			# take all baronies under the one we're fighting for
			limit = {
				has_holder = yes
				NOT = {
					de_facto_liege = PREV
				}
				holder_scope = {
					OR = {
						character = FROM
						is_liege_or_above = FROM
					}
				}
			}
			usurp_title_plus_barony_if_unlanded = {
				target = ROOT
				type = invasion
			}
		}
		any_attacker = {
			limit = {
				character = ROOT
			}
			participation_scaled_prestige = 100
		}
		any_attacker = {
			limit = {
				NOT = {
					character = ROOT
				}
			}
			hidden_tooltip = {
				participation_scaled_prestige = 100
			}
		}
	}
	on_fail_title = {
		ROOT = {
			prestige = -100
		}
		any_defender = {
			limit = {
				character = FROM
			}
			participation_scaled_prestige = 50
		}
		any_defender = {
			limit = {
				NOT = {
					character = FROM
				}
			}
			hidden_tooltip = {
				participation_scaled_prestige = 50
			}
		}
	}
	on_reverse_demand = {
		ROOT = {
			prestige = -200
			transfer_scaled_wealth = {
				to = FROM
				value = 4.0
			}
		}
		any_defender = {
			limit = {
				character = FROM
			}
			participation_scaled_prestige = 100
		}
		any_defender = {
			limit = {
				NOT = {
					character = FROM
				}
			}
			hidden_tooltip = {
				participation_scaled_prestige = 100
			}
		}
	}
	attacker_ai_victory_worth = {
		factor = -1 # always accept
	}
	attacker_ai_defeat_worth = {
		factor = 100
	}
	defender_ai_victory_worth = {
		factor = -1 # always accept
	}
	defender_ai_defeat_worth = {
		factor = 100
	}
	ai_will_do = {
		factor = 1
		modifier = {
			factor = 2
			ROOT = {
				trait = creature_dwarf
			}
		}
	}
}

# Nehekhara
nehekharan_county_conquest = {
	name = CB_NAME_TOMBCOUNTY_CONQUEST
	war_name = WAR_NAME_TOMBCOUNTY_CONQUEST
	sprite = 16
	truce_days = 8250
	hostile_against_others = yes
	is_permanent = yes
	check_all_titles = yes
	press_claim = yes
	can_ask_to_join_war = yes
	can_call_allies = yes
	battle_warscore_mult = 0.75
	can_use_gui = {
		ROOT = {
			piety = 5
		}
	}
	on_add = {
		ROOT = {
			piety = -5
		}
	}
	can_use = {
		ROOT = {
			NOT = {
				is_liege_or_above = FROM
			}
		}
	}
	can_use_title = {
		tier = count
		wh_cb_albion_check_trigger = yes
		NOT = {
			region = world_underempire
		}
		OR = {
			FROM = {
				has_landed_title = PREV
			}
			holder_scope = {
				is_liege_or_above = FROM
				NOT = {
					same_realm = ROOT
				}
			}
		}
		ROOT = {
			trait = khemri_tomb_king
		}
		wh_cb_can_use_title_trigger = yes
		location = {
			any_neighbor_province = {
				owner = {
					OR = {
						character = ROOT
						is_liege_or_above = ROOT
					}
				}
			}
		}
	}
	is_valid_title = {
		wh_cb_is_valid_title_trigger = yes
	}
	on_success_title = {
		usurp_title_plus_barony_if_unlanded = ROOT
		any_de_jure_vassal_title = {
		 	limit = {
			 	has_holder = yes
			 	holder_scope = {
					OR = {
					 	character = FROM
					 	is_liege_or_above = FROM
					 	AND = {
						 	is_liege_or_above = ROOT
					 		NOT = {
								culture = ROOT
							}
					 		NOT = {
								religion = ROOT
							}
						}
					}
				}
			}
	 		usurp_title = ROOT
		}
		any_attacker = {
			limit = {
				character = ROOT
			}
			participation_scaled_prestige = 100
		}
		any_attacker = {
			limit = {
				NOT = {
					character = ROOT
				}
			}
			hidden_tooltip = {
				participation_scaled_prestige = 100
			}
		}
	}
	on_fail_title = {
		ROOT = {
			prestige = -100
		}
		any_defender = {
			limit = {
				character = FROM
			}
			participation_scaled_prestige = 50
		}
		any_defender = {
			limit = {
				NOT = {
					character = FROM
				}
			}
			hidden_tooltip = {
				participation_scaled_prestige = 50
			}
		}
	}
	on_reverse_demand = {
		ROOT = {
			prestige = -200
			transfer_scaled_wealth = {
				to = FROM
				value = 4.0
			}
		}
		any_defender = {
			limit = {
				character = FROM
			}
			participation_scaled_prestige = 100
		}
		any_defender = {
			limit = {
				NOT = {
					character = FROM
				}
			}
			hidden_tooltip = {
				participation_scaled_prestige = 100
			}
		}
	}
	attacker_ai_victory_worth = {
		factor = -1 # always accept
	}
	attacker_ai_defeat_worth = {
		factor = 100
	}
	defender_ai_victory_worth = {
		factor = -1 # always accept
	}
	defender_ai_defeat_worth = {
		factor = 100
	}
	ai_will_do = {
		factor = 1
		modifier = {
			factor = 10
			ROOT = {
				trait = lunatic_3
			}
		}
	}
}

# Tomb King Subjugation
nehekharan_subjugation = {
	name = CB_NAME_NEHEKHARAN_SUBJUGATION
	war_name = WAR_NAME_NEHEKHARAN_SUBJUGATION
	sprite = 6
	truce_days = 18000
	hostile_against_others = yes
	is_permanent = yes
	can_ask_to_join_war = yes
	allow_whitepeace = no
	can_call_allies = yes
	check_de_jure_tier = KING # this scans all de jure kingdoms for the counties which are held by or vassals(or below) of selected character. Only valid if is_permanent = yes
	battle_warscore_mult = 0.25
	can_use_gui = {
		ROOT = {
			prestige = 750
		}
	}
	on_add = {
		ROOT = {
			prestige = -750
		}
	}
	can_use = {
		ROOT = {
			trait = khemri_tomb_king
			higher_tier_than = DUKE
			NOT = {
				same_realm = FROM
			}
			NOT = {
				is_liege_or_above = FROM
			}
		}
		FROM = {
			trait = khemri_tomb_king
			NOT = {
				any_war = {
					defender = {
						character = FROM
					}
					using_cb = nehekharan_subjugation
				}
			}
		}
	}
	can_use_title = {
		wh_cb_albion_check_trigger = yes
		NOT = {
			region = world_underempire
		}
		region = world_nehekhara
		FROM = {
			any_realm_title = {
				de_jure_liege_or_above = PREVPREV
			}
		}
	}
	is_valid_title = {
		NOT = {
			region = world_underempire
		}
		FROM = {
			any_realm_title = {
				de_jure_liege_or_above = PREVPREV
			}
		}
	}
	on_add_title = {
	}
	on_success = {
		ROOT = {
			piety = 100
		}
		any_attacker = {
			limit = {
				character = ROOT
			}
			participation_scaled_prestige = 100
		}
		any_attacker = {
			limit = {
				NOT = {
					character = ROOT
				}
			}
			hidden_tooltip = {
				participation_scaled_prestige = 100
			}
		}
		FROM = {
			piety = -100
			prestige = -100
		}
	}
	on_success_title = {
		# Usurp the target kingdom itself, if the enemy holds it
		if = {
			limit = {
				holder_scope = {
					character = FROM
				}
				NOT = {
					ROOT = {
						tier = EMPEROR
					}
				}
			}
			ROOT = {
				usurp_title = {
					target = PREV
					type = invasion
				}
			}
		}
		if = {
			# Take the enemy's duchies within the target kingdom, if we are the same or lower tier
			limit = {
				ROOT = {
					NOT = {
						higher_tier_than = FROM
					}
				}
			}
			FROM = {
				any_demesne_title = {
					limit = {
						tier = DUKE
						OR = {
							title = PREVPREV
							de_jure_liege_or_above = PREVPREV
						}
					}
					ROOT = {
						usurp_title = {
							target = PREV
							type = invasion
						}
					}
				}
			}
		}
		# Have I become the vassal of the loser due to taking a duchy or kingdom?
		if = {
			limit = {
				ROOT = {
					is_liege_or_above = FROM
				}
			}
			ROOT = {
				set_defacto_liege = ROOT
			}
		}
		# Vassalize the rest
		custom_tooltip = {
			text = pagan_subjugation_tip
			hidden_tooltip = {
				ROOT = {
					subjugate_or_take_under_title = {
						# If the target only has territory within the kingdom, he is simply vassalized
						title = PREV
						enemy = FROM
					}
				}
			}
		}
	}
	on_fail = {
		FROM = {
			piety = 50
		}
		any_defender = {
			limit = {
				character = FROM
			}
			participation_scaled_prestige = 50
		}
		any_defender = {
			limit = {
				NOT = {
					character = FROM
				}
			}
			hidden_tooltip = {
				participation_scaled_prestige = 50
			}
		}
		ROOT = {
			piety = -100
		}
	}
	on_reverse_demand = {
		ROOT = {
			piety = -200
			transfer_scaled_wealth = {
				to = FROM
				value = 2.0
			}
		}
		FROM = {
			piety = 100
		}
		any_defender = {
			limit = {
				character = FROM
			}
			participation_scaled_prestige = 100
		}
		any_defender = {
			limit = {
				NOT = {
					character = FROM
				}
			}
			hidden_tooltip = {
				participation_scaled_prestige = 100
			}
		}
	}
	attacker_ai_victory_worth = {
		factor = 200
	}
	attacker_ai_defeat_worth = {
		factor = 100
	}
	defender_ai_victory_worth = {
		factor = -1 # always accept
	}
	defender_ai_defeat_worth = {
		factor = 100
	}
}

# Graverobbers
desert_expedition = {
	name = CB_NAME_DESERT_EXPEDITION
	war_name = WAR_NAME_DESERT_EXPEDITION
	sprite = 8
	truce_days = 1825
	hostile_against_others = yes
	is_permanent = yes
	can_ask_to_join_war = yes
	can_call_allies = yes
	check_de_jure_tier = DUKE # this scans all de jure kingdoms for the counties which are held by or vassals(or below) of selected character. Only valid if is_permanent = yes
	battle_warscore_mult = 1.5
	can_use_gui = {
		ROOT = {
			wealth = 20
		}
	}
	on_add = {
		ROOT = {
			wealth = -20
		}
	}
	can_use = {
		ROOT = {
			NOT = {
				trait = creature_nehekharan
			}
			NOT = {
				same_realm = FROM
			}
			NOT = {
				is_liege_or_above = FROM
			}
		}
		FROM = {
			capital_scope = {
				empire = {
					title = e_nehekhara
				}
			}
			trait = creature_nehekharan
		}
	}
	can_use_title = {
		wh_cb_albion_check_trigger = yes
		NOT = {
			region = world_underempire
		}
		# The attacker needs at least one county in the target kingdom, or a border, or be only two sea zones away from one of your counties
		any_direct_de_jure_vassal_title = {
			OR = {
				holder_scope = {
					OR = {
						character = ROOT
						is_liege_or_above = ROOT
					}
				}
				location = {
					any_neighbor_province = {
						OR = {
							AND = {
								has_owner = yes
								owner = {
									OR = {
										character = ROOT
										is_liege_or_above = ROOT
									}
								}
							}
							AND = {
								is_land = no
								any_neighbor_province = {
									OR = {
										AND = {
											has_owner = yes
											owner = {
												OR = {
													character = ROOT
													is_liege_or_above = ROOT
												}
											}
										}
										AND = {
											is_land = no
											any_neighbor_province = {
												owner = {
													OR = {
														character = ROOT
														is_liege_or_above = ROOT
													}
												}
											}
										}
									}
								}
							}
						}
					}
				}
			}
		}
	}
	is_valid = {
		ROOT = {
			NOT = {
				same_realm = FROM
			}
			OR = {
				NOT = {
					religion = FROM
				}
				is_heresy_of = FROM
				is_parent_religion = FROM
			}
			top_liege = {
				NOT = {
					religion = FROM
				}
			}
		}
	}
	on_add_title = {
	}
	on_success = {
		ROOT = {
			piety = 100
			participation_scaled_piety = 100
		}
		any_attacker = {
			limit = {
				character = ROOT
			}
			participation_scaled_prestige = 100
		}
		any_attacker = {
			limit = {
				NOT = {
					character = ROOT
				}
			}
			hidden_tooltip = {
				participation_scaled_prestige = 100
				participation_scaled_piety = 100
			}
		}
		FROM = {
			piety = -200
			prestige = -300
		}
	}
	on_fail = {
		FROM = {
			piety = 100
		}
		any_defender = {
			limit = {
				character = FROM
			}
			participation_scaled_piety = 100
			participation_scaled_prestige = 50
		}
		any_defender = {
			limit = {
				NOT = {
					character = FROM
				}
			}
			hidden_tooltip = {
				participation_scaled_piety = 100
				participation_scaled_prestige = 50
			}
		}
		ROOT = {
			piety = -150
		}
	}
	on_reverse_demand = {
		ROOT = {
			piety = -300
			transfer_scaled_wealth = {
				to = FROM
				value = 2.0
			}
		}
		FROM = {
			piety = 150
		}
		any_defender = {
			limit = {
				character = FROM
			}
			participation_scaled_prestige = 100
			participation_scaled_piety = 100
		}
		any_defender = {
			limit = {
				NOT = {
					character = FROM
				}
			}
			hidden_tooltip = {
				participation_scaled_prestige = 100
				participation_scaled_piety = 100
			}
		}
	}
	attacker_ai_victory_worth = {
		factor = 200
	}
	attacker_ai_defeat_worth = {
		factor = 100
	}
	defender_ai_victory_worth = {
		factor = -1 # always accept
	}
	defender_ai_defeat_worth = {
		factor = 100
	}
	ai_will_do = {
		factor = 1
		modifier = {
			factor = 2
			ROOT = {
				trait = creature_orc
			}
		}
		modifier = {
			factor = 2
			ROOT = {
				trait = creature_goblin
			}
		}
		modifier = {
			factor = 2
			ROOT = {
				trait = creature_dwarf
			}
		}
		modifier = {
			factor = 2
			ROOT = {
				trait = creature_chaos_dwarf
			}
		}
		modifier = {
			factor = 1.25
			ROOT = {
				trait = creature_beastman
			}
		}
		modifier = {
			factor = 1.25
			ROOT = {
				trait = creature_human
			}
		}
		modifier = {
			factor = 0.5
			ROOT = {
				trait = creature_elf
			}
		}
		modifier = {
			factor = 5
			ROOT = {
				trait = greedy
			}
		}
	}
}

# Anti-Graverobbers
punish_graverobbers = {
	name = CB_NAME_ANTIGRAVEROBBERS
	war_name = WAR_NAME_ANTIGRAVEROBBERS
	sprite = 19
	truce_days = 825
	hostile_against_others = yes
	is_permanent = yes
	can_ask_to_join_war = yes
	can_call_allies = yes
	check_de_jure_tier = DUKE # this scans all de jure kingdoms for the counties which are held by or vassals(or below) of selected character. Only valid if is_permanent = yes
	battle_warscore_mult = 1.25
	can_use = {
		ROOT = {
			trait = creature_nehekharan
			NOT = {
				same_realm = FROM
			}
			NOT = {
				is_liege_or_above = FROM
			}
			has_opinion_modifier = {
				who = FROM
				modifier = opinion_graverobbed_me
			}
		}
	}
	is_valid = {
		wh_cb_root_not_same_realm_from_rigger = yes
	}
	can_use_title = {
		wh_cb_albion_check_trigger = yes
		NOT = {
			region = world_underempire
		}
	}
	on_add_title = {
	}
	on_success = {
		any_attacker = {
			limit = {
				character = ROOT
			}
			participation_scaled_prestige = 100
		}
		any_attacker = {
			limit = {
				NOT = {
					character = ROOT
				}
			}
			hidden_tooltip = {
				participation_scaled_prestige = 100
				participation_scaled_piety = 100
			}
		}
		FROM = {
			transfer_scaled_wealth = {
				to = ROOT
				value = 25.0
			}
			hidden_tooltip = {
				ROOT = {
	 				remove_opinion = {
						who = FROM
						modifier = opinion_graverobbed_me
					}
				}
				random = {
					chance = 25
					FROM = {
						character_event = {
							id = snehekharan.7 days = 1
						}
					}
				}
			}
			prestige = -300
		}
	}
	on_fail = {
		FROM = {
			piety = 100
		}
		any_defender = {
			limit = {
				character = FROM
			}
			participation_scaled_piety = 100
			participation_scaled_prestige = 50
		}
		any_defender = {
			limit = {
				NOT = {
					character = FROM
				}
			}
			hidden_tooltip = {
				participation_scaled_piety = 100
				participation_scaled_prestige = 50
			}
		}
		ROOT = {
			piety = -150
		}
	}
	on_reverse_demand = {
		ROOT = {
			piety = -300
			transfer_scaled_wealth = {
				to = FROM
				value = 1.0
			}
		}
		FROM = {
			piety = 150
		}
		any_defender = {
			limit = {
				character = FROM
			}
			participation_scaled_prestige = 100
			participation_scaled_piety = 100
		}
		any_defender = {
			limit = {
				NOT = {
					character = FROM
				}
			}
			hidden_tooltip = {
				participation_scaled_prestige = 100
				participation_scaled_piety = 100
			}
		}
	}
	attacker_ai_victory_worth = {
		factor = 200
	}
	attacker_ai_defeat_worth = {
		factor = 100
	}
	defender_ai_victory_worth = {
		factor = -1 # always accept
	}
	defender_ai_defeat_worth = {
		factor = 100
	}
	ai_will_do = {
		factor = 100
	}
}

# cb for living
nehekharan_county_colonisation = {
	name = CB_NAME_TOMBCOUNTY_COLONISATION
	war_name = WAR_NAME_TOMBCOUNTY_COLONISATION
	sprite = 16
	truce_days = 3650
	hostile_against_others = yes
	is_permanent = yes
	check_all_titles = yes
	press_claim = yes
	can_ask_to_join_war = yes
	can_call_allies = yes
	battle_warscore_mult = 0.5
	can_use_gui = {
		ROOT = {
			piety = 5
		}
	}
	on_add = {
		ROOT = {
			piety = -5
		}
	}
	can_use = {
		ROOT = {
			NOT = {
				is_liege_or_above = FROM
			}
		}
	}
	can_use_title = {
		tier = count
		wh_cb_albion_check_trigger = yes
		NOT = {
			region = world_underempire
		}
		region = world_nehekhara
		OR = {
			FROM = {
				has_landed_title = PREV
			}
			holder_scope = {
				is_liege_or_above = FROM
				NOT = {
					same_realm = ROOT
				}
			}
		}
		ROOT = {
			NOT = {
				trait = khemri_tomb_king
			}
		}
		wh_cb_can_use_title_trigger = yes
		location = {
			any_neighbor_province = {
				owner = {
					OR = {
						character = ROOT
						is_liege_or_above = ROOT
					}
				}
			}
		}
	}
	is_valid_title = {
		wh_cb_is_valid_title_trigger = yes
	}
	on_success_title = {
		usurp_title_plus_barony_if_unlanded = ROOT
		any_de_jure_vassal_title = {
		 	limit = {
			 	has_holder = yes
			 	holder_scope = {
					OR = {
					 	character = FROM
					 	is_liege_or_above = FROM
					 	AND = {
						 	is_liege_or_above = ROOT
					 		NOT = {
								culture = ROOT
							}
					 		NOT = {
								religion = ROOT
							}
						}
					}
				}
			}
	 		usurp_title = ROOT
		}
		any_attacker = {
			limit = {
				character = ROOT
			}
			participation_scaled_prestige = 100
		}
		any_attacker = {
			limit = {
				NOT = {
					character = ROOT
				}
			}
			hidden_tooltip = {
				participation_scaled_prestige = 100
			}
		}
	}
	on_fail_title = {
		ROOT = {
			prestige = -100
		}
		any_defender = {
			limit = {
				character = FROM
			}
			participation_scaled_prestige = 50
		}
		any_defender = {
			limit = {
				NOT = {
					character = FROM
				}
			}
			hidden_tooltip = {
				participation_scaled_prestige = 50
			}
		}
	}
	on_reverse_demand = {
		ROOT = {
			prestige = -200
			transfer_scaled_wealth = {
				to = FROM
				value = 4.0
			}
		}
		any_defender = {
			limit = {
				character = FROM
			}
			participation_scaled_prestige = 100
		}
		any_defender = {
			limit = {
				NOT = {
					character = FROM
				}
			}
			hidden_tooltip = {
				participation_scaled_prestige = 100
			}
		}
	}
	attacker_ai_victory_worth = {
		factor = -1 # always accept
	}
	attacker_ai_defeat_worth = {
		factor = 100
	}
	defender_ai_victory_worth = {
		factor = -1 # always accept
	}
	defender_ai_defeat_worth = {
		factor = 100
	}
	ai_will_do = {
		factor = 1
		modifier = {
			factor = 0.01
		}
		modifier = {
			factor = 0
			ROOT = {
				NOT = {
					trait = lunatic_3
				}
				NOT = {
					trait = possessed
				}
			}
		}
	}
}

# Lustria
lustrian_rampage = {
	name = CB_NAME_LUSTRIA_BEAST_RAMPAGE
	war_name = WAR_NAME_LUSTRIA_BEAST_RAMPAGE
	sprite = 16
	truce_days = 365
	hostile_against_others = yes
	check_all_titles = yes
	attacker_can_call_allies = no
	defender_can_call_allies = no
	can_ask_to_join_war = no
	is_independence = no
	can_use = {
		ROOT = {
			primary_title = {
				temporary = yes
			} # Revolter or adventurer trigger
			war = no
			NOT = {
				is_liege_or_above = FROM
			}
		}
	}
	can_use_title = {
		wh_cb_albion_check_trigger = yes
	}
	is_valid_title = {
		tier = count
		NOT = {
			region = world_underempire
		}
		wh_cb_is_valid_title_trigger = yes
	}
	on_success_title = {
		FROM = {
			prestige = -100
		}
		ROOT = {
			death = {
				death_reason = death_execution
			}
			any_courtier = {
				if = {
					limit = {
						has_character_flag = rampaging_beast
					}
					death = {
						death_reason = death_execution
					}
				}
			}
		}
	}
	on_fail_title = {
		FROM = {
			prestige = 10
		}
		ROOT = {
			death = {
				death_reason = death_execution
			}
			any_courtier = {
				if = {
					limit = {
						has_character_flag = rampaging_beast
					}
					death = {
						death_reason = death_execution
					}
				}
			}
		}
	}
	on_reverse_demand = {
		FROM = {
			prestige = 20
			hidden_tooltip = {
				add_character_modifier = {
					name = crushed_revolt
					days = 3650
				}
			}
		}
		ROOT = {
			death = {
				death_reason = death_execution
			}
			any_courtier = {
				if = {
					limit = {
						has_character_flag = rampaging_beast
					}
					death = {
						death_reason = death_execution
					}
				}
			}
		}
	}
	attacker_ai_victory_worth = {
		factor = 90 # always accept
	}
	attacker_ai_defeat_worth = {
		factor = 100
	}
	defender_ai_victory_worth = {
		factor = 90 # always accept
	}
	defender_ai_defeat_worth = {
		factor = 100
	}
}

realignment_process_cb = {
	name = CB_NAME_REALIGN_CHIEF
	war_name = WAR_NAME_REALIGN_CHIEF
	sprite = 6
	truce_days = 3000
	attacker_can_call_allies = no
	can_ask_to_join_war = no
	major_revolt = yes
	can_use = {
		ROOT = {
			vassal_of = FROM
			or = {
				trait = creature_skink
				AND = {
					trait = creature_slann
					not = {
						trait = lizardman_sleepingslann
					}
				}
			}
		}
	}
	is_valid = {
		FROM = {
			trait = creature_skink
			in_revolt = no
			liege_before_war = {
				in_revolt = no
				liege_before_war = {
					in_revolt = no
				}
			}
		}
		ROOT = {
			OR = {
				liege = {
					character = PREV # either independent
				}
				liege = {
					FROM = {
						is_liege_or_above = PREV # or have shared liege
					}
				}
			}
		}
	}
	is_valid_title = {
		NOT = {
			region = world_underempire
		}
		OR = {
			tier = emperor
			is_primary_holder_title = yes
		}
	}
	on_add = {
		ROOT = {
			if = {
				limit = {
					FROM = {
						NOT = {
							trait = defective
						}
					}
				}
				decadence = 10
			}
		}
	}
	on_success = {
		FROM = {
			hidden_tooltip = {
				disband_event_forces = faction_loyalists
			}
			any_demesne_title = {
				# All titles
				limit = {
					OR = {
						tier = king
						tier = emperor
					}
					NOT = {
						has_law = tribal_organization_0
					}
				}
				if = {
					limit = {
						has_law = tribal_organization_1
					}
					add_law = tribal_organization_0
				}
				if = {
					limit = {
						has_law = tribal_organization_2
					}
					add_law = tribal_organization_1
				}
				if = {
					limit = {
						has_law = tribal_organization_3
					}
					add_law = tribal_organization_2
				}
				if = {
					limit = {
						has_law = tribal_organization_4
					}
					add_law = tribal_organization_3
				}
			}
			any_demesne_title = {
				limit = {
					higher_tier_than = COUNT
				}
				gain_title = {
					target = ROOT
					type = faction_demand
				}
			}
		}
		any_attacker = {
			limit = {
				character = ROOT
			}
			participation_scaled_prestige = 100
			hidden_tooltip = {
				disband_event_forces = faction_revolters
			}
		}
		any_attacker = {
			limit = {
				NOT = {
					character = ROOT
				}
			}
			hidden_tooltip = {
				participation_scaled_prestige = 100
				disband_event_forces = faction_revolters
			}
		}
	}
	on_success_title = {
	}
	on_fail = {
		ROOT = {
			prestige = -100
			piety = -100
			decadence = 10
		}
		any_defender = {
			limit = {
				character = FROM
			}
			participation_scaled_prestige = 50
		}
		any_defender = {
			limit = {
				NOT = {
					character = FROM
				}
			}
			hidden_tooltip = {
				participation_scaled_prestige = 50
			}
		}
		hidden_tooltip = {
			any_attacker = {
				disband_event_forces = faction_revolters
				add_character_modifier = {
					name = faction_misaligned_chief_ultimatum_timer
					hidden = yes
					duration = 3650
				}
			}
		}
		FROM = {
			decadence = -5
			hidden_tooltip = {
				disband_event_forces = faction_loyalists
			}
		}
	}
	on_reverse_demand = {
		ROOT = {
			prestige = -200
			piety = -250
			decadence = 15
		}
		ROOT = {
			if = {
				limit = {
					trait = defective
				}
			}
			imprison = FROM
		}
		any_defender = {
			limit = {
				character = FROM
			}
			participation_scaled_prestige = 100
		}
		any_defender = {
			limit = {
				NOT = {
					character = FROM
				}
			}
			hidden_tooltip = {
				participation_scaled_prestige = 100
			}
		}
		hidden_tooltip = {
			any_attacker = {
				limit = {
					liege = {
						character = FROM
					}
				}
				prisoner = FROM
				disband_event_forces = faction_revolters
				add_character_modifier = {
					name = faction_misaligned_chief_ultimatum_timer
					hidden = yes
					duration = 3650
				}
			}
		}
		FROM = {
			decadence = -10
			hidden_tooltip = {
				disband_event_forces = faction_loyalists
			}
		}
	}
	attacker_ai_victory_worth = {
		factor = -1 # always accept
	}
	attacker_ai_defeat_worth = {
		factor = 100
	}
	defender_ai_victory_worth = {
		factor = -1 # always accept
	}
	defender_ai_defeat_worth = {
		factor = 100
	}
}

# Skinks can subjugate misaligned Skinks
skink_subjugation = {
	name = CB_NAME_SKINK_SUBJUGATION
	war_name = WAR_NAME_SKINK_SUBJUGATION
	sprite = 8
	truce_days = 3650
	hostile_against_others = no
	is_permanent = yes
	can_ask_to_join_war = no
	check_de_jure_tier = KING # this scans all de jure kingdoms for the counties which are held by or vassals(or below) of selected character. Only valid if is_permanent = yes
	can_use = {
		ROOT = {
			or = {
				trait = creature_skink
				and = {
					trait = creature_slann
					not = {
						trait = lizardman_sleepingslann
					}
				}
			}
			NOT = {
				same_realm = FROM
			}
			NOT = {
				is_liege_or_above = FROM
			}
			NOT = {
				trait = defective
			}
		}
		FROM = {
			trait = creature_skink
			OR = {
				trait = defective
				decadence = 75
			}
			NOT = {
				any_war = {
					defender = {
						character = FROM
					}
					using_cb = skink_subjugation
				}
			}
		}
	}
	can_use_title = {
		wh_cb_albion_check_trigger = yes
		nor = {
			region = world_underempire
			region = world_nehekhara
		}
		FROM = {
			any_realm_title = {
				de_jure_liege_or_above = PREVPREV
			}
		}
	}
	is_valid_title = {
		FROM = {
			any_realm_title = {
				de_jure_liege_or_above = PREVPREV
			}
		}
	}
	on_add = {
		if = {
			limit = {
				FROM = {
					NOR = {
						trait = defective
						decadence = 75
					}
				}
			}
			ROOT = {
				decadence = 15
			}
		}
	}
	on_success = {
		ROOT = {
			piety = 100
			decadence = -3
		}
		any_attacker = {
			limit = {
				character = ROOT
			}
			participation_scaled_piety = 100
		}
		any_attacker = {
			limit = {
				NOT = {
					character = ROOT
				}
			}
			hidden_tooltip = {
				participation_scaled_piety = 100
			}
			decadence = -5
		}
		FROM = {
			piety = -100
			prestige = -100
		}
	}
	on_success_title = {
		# Usurp the target kingdom itself, if the enemy holds it
		if = {
			limit = {
				holder_scope = {
					character = FROM
				}
				NOT = {
					ROOT = {
						tier = EMPEROR
					}
				}
			}
			ROOT = {
				usurp_title = {
					target = PREV
					type = invasion
				}
			}
		}
		if = {
			# Take the enemy's duchies within the target kingdom, if we are the same or lower tier
			limit = {
				ROOT = {
					NOT = {
						higher_tier_than = FROM
					}
				}
			}
			FROM = {
				any_demesne_title = {
					limit = {
						tier = DUKE
						OR = {
							title = PREVPREV
							de_jure_liege_or_above = PREVPREV
						}
					}
					ROOT = {
						usurp_title = {
							target = PREV
							type = invasion
						}
					}
				}
			}
		}
		# Have I become the vassal of the loser due to taking a duchy or kingdom?
		if = {
			limit = {
				ROOT = {
					is_liege_or_above = FROM
				}
			}
			ROOT = {
				set_defacto_liege = ROOT
			}
		}
		# Vassalize the rest
		custom_tooltip = {
			text = pagan_subjugation_tip
			hidden_tooltip = {
				ROOT = {
					subjugate_or_take_under_title = {
						# If the target only has territory within the kingdom, he is simply vassalized
						title = PREV
						enemy = FROM
					}
				}
			}
		}
	}
	on_fail = {
		FROM = {
			piety = 50
			decadence = -2
		}
		any_defender = {
			limit = {
				character = FROM
			}
			participation_scaled_prestige = 50
		}
		any_defender = {
			limit = {
				NOT = {
					character = FROM
				}
			}
			hidden_tooltip = {
				participation_scaled_prestige = 50
			}
			decadence = -4
		}
		ROOT = {
			piety = -100
			decadence = 2
		}
	}
	on_reverse_demand = {
		ROOT = {
			piety = -200
			decadence = 5
			transfer_scaled_wealth = {
				to = FROM
				value = 2.0
			}
		}
		FROM = {
			piety = 100
			decadence = -4
		}
		any_defender = {
			limit = {
				character = FROM
			}
			participation_scaled_prestige = 100
		}
		any_defender = {
			limit = {
				NOT = {
					character = FROM
				}
			}
			hidden_tooltip = {
				participation_scaled_prestige = 100
			}
			decadence = -6
		}
	}
	attacker_ai_victory_worth = {
		factor = 200
	}
	attacker_ai_defeat_worth = {
		factor = 100
	}
	defender_ai_victory_worth = {
		factor = -1 # always accept
	}
	defender_ai_defeat_worth = {
		factor = 100
	}
	ai_will_do = {
		factor = 1
		modifier = {
			factor = 1.5
			FROM = {
				decadence = 80
			}
		}
		modifier = {
			factor = 1.5
			FROM = {
				decadence = 85
			}
		}
		modifier = {
			factor = 1.5
			FROM = {
				decadence = 90
			}
		}
		modifier = {
			factor = 1.5
			FROM = {
				decadence = 95
			}
		}
		modifier = {
			factor = 2
			FROM = {
				decadence = 100
			}
		}
		modifier = {
			factor = 2
			FROM = {
				trait = defective
			}
		}
	}
}

flower_war_raid = {
	name = CB_NAME_FLOWER_WAR_RAID
	war_name = WAR_NAME_FLOWER_WAR_RAID
	sprite = 7
	truce_days = 3650
	hostile_against_others = yes
	is_permanent = yes
	can_ask_to_join_war = no
	check_de_jure_tier = DUKE # this scans all de jure kingdoms for the counties which are held by or vassals(or below) of selected character. Only valid if is_permanent = yes
	battle_warscore_mult = 0.75
	allow_distant = yes # AI parameter
	can_use = {
		ROOT = {
			religion_group = old_ones_group
			NOT = {
				has_character_modifier = favour_chotec
			}
			NOT = {
				has_character_modifier = favour_quetzl
			}
			NOT = {
				has_character_modifier = favour_xholankha
			}
			NOT = {
				has_character_modifier = favour_sotek
			}
		}
		FROM = {
			OR = {
				AND = {
					ROOT = {
						trait = creature_amazon
					}	# Amazons do not attack other Amazons, but they do attack men around them.
					FROM = {
						OR = {
							trait = creature_halfling
							trait = creature_human
						}
					}
				}
				NOT = {
					religion = ROOT
				}
			} # No Lizardmen on Lizardmen, but yes Lizardmen on Amazons and viceversa
		}
	}
	can_use_title = {
		wh_cb_albion_check_trigger = yes
		nor = {
			region = world_underempire
			region = world_nehekhara
		}
		# The attacker needs at least one county in the target kingdom, or a border, or be only two sea zones away from one of your counties
		any_direct_de_jure_vassal_title = {
			OR = {
				holder_scope = {
					OR = {
						character = ROOT
						is_liege_or_above = ROOT
					}
				}
				location = {
					any_neighbor_province = {
						OR = {
							AND = {
								has_owner = yes
								owner = {
									OR = {
										character = ROOT
										is_liege_or_above = ROOT
									}
								}
							}
							AND = {
								is_land = no
								any_neighbor_province = {
									OR = {
										AND = {
											has_owner = yes
											owner = {
												OR = {
													character = ROOT
													is_liege_or_above = ROOT
												}
											}
										}
										AND = {
											is_land = no
											any_neighbor_province = {
												owner = {
													OR = {
														character = ROOT
														is_liege_or_above = ROOT
													}
												}
											}
										}
									}
								}
							}
						}
					}
				}
			}
		}
	}
	is_valid = {
		wh_cb_root_not_same_realm_from_rigger = yes
	}
	on_add = {
		# hidden_tooltip = { ROOT = { set_variable = { which = "sacrifical_victims"		value = 0
		if = {
			limit = {
				FROM = {
					higher_tier_than = BARON
				}
			}
			ROOT = {
				set_variable = {
					which = "sacrifices_needed"
					value = "9"
				}
				set_variable = {
					which = "sacrifices_needed_sotek"
					value = "15"
				}
			}
		}
		if = {
			limit = {
				FROM = {
					higher_tier_than = COUNT
				}
			}
			ROOT = {
				set_variable = {
					which = "sacrifices_needed"
					value = "18"
				}
				set_variable = {
					which = "sacrifices_needed_sotek"
					value = "24"
				}
			}
		}
		if = {
			limit = {
				FROM = {
					higher_tier_than = DUKE
				}
			}
			ROOT = {
				set_variable = {
					which = "sacrifices_needed"
					value = "27"
				}
				set_variable = {
					which = "sacrifices_needed_sotek"
					value = "33"
				}
			}
		}
		if = {
			limit = {
				FROM = {
					higher_tier_than = KING
				}
			}
			ROOT = {
				set_variable = {
					which = "sacrifices_needed"
					value = "36"
				}
				set_variable = {
					which = "sacrifices_needed_sotek"
					value = "42"
				}
			}
		}

	}
	on_add_title = {
	}
	on_success = {
		ROOT = {
			piety = 150
			participation_scaled_piety = 150
			hidden_tooltip = {
				character_event = {
					id = slizardmen.17
				}
			}
		}
		any_attacker = {
			limit = {
				NOT = {
					character = ROOT
				}
			}
			hidden_tooltip = {
				participation_scaled_prestige = 100
				participation_scaled_piety = 100
				decadence = -3
			}
		}
		FROM = {
			piety = -300
		}

	}
	on_fail = {
		FROM = {
			piety = 100
		}
		any_defender = {
			limit = {
				character = FROM
			}
			participation_scaled_piety = 100
			participation_scaled_prestige = 50
			decadence = -3
		}
		any_defender = {
			limit = {
				NOT = {
					character = FROM
				}
			}
			hidden_tooltip = {
				participation_scaled_piety = 100
				participation_scaled_prestige = 50
				decadence = -3
			}
		}
		ROOT = {
			piety = -100
			decadence = 5
		}

	}
	on_reverse_demand = {
		ROOT = {
			piety = -200
			decadence = 7
			transfer_scaled_wealth = {
				to = FROM
				value = 2.0
			}
		}
		FROM = {
			piety = 150
		}
		any_defender = {
			limit = {
				character = FROM
			}
			participation_scaled_prestige = 100
			participation_scaled_piety = 100
			decadence = -3
		}
		any_defender = {
			limit = {
				NOT = {
					character = FROM
				}
			}
			hidden_tooltip = {
				participation_scaled_prestige = 100
				participation_scaled_piety = 100
				decadence = -3
			}
		}

	}
	attacker_ai_victory_worth = {
		factor = -1 # Always accept
	}
	attacker_ai_defeat_worth = {
		factor = 80
	}
	defender_ai_victory_worth = {
		factor = -1 # Always accept
	}
	defender_ai_defeat_worth = {
		factor = 80
	}
	ai_will_do = {
		factor = 1
		modifier = {
			factor = 0.0001
			NOT = {
				ROOT = {
					num_of_realm_counties = {
						value = 6
						title = PREV
					}
				}
			}
		}
		modifier = {
			factor = 0.1
			FROM = {
				trait = creature_skink
			}
		}
		modifier = {
			factor = 0.01
			FROM = {
				trait = creature_slann
			}
		}
		modifier = {
			factor = 3
			ROOT = {
				trait = zealous
			}
		}
		modifier = {
			factor = 3
			ROOT = {
				trait = creature_skink
				trait = diligent
			}
		}
		modifier = {
			factor = 3
			ROOT = {
				trait = creature_human
				trait = impaler
			}
		}

	}
}

tablet_search = {
	name = CB_NAME_TABLET_SEARCH
	war_name = WAR_NAME_TABLET_SEARCH
	sprite = 9
	truce_days = 36500
	is_permanent = yes
	is_holy_war = yes
	battle_warscore_mult = 0.375
	check_de_jure_tier = KING # this scans all de jure kingdoms for the counties which are held by or vassals(or below) of selected character. Only valid if is_permanent = yes
	apply_short_occ_mod = no
	# hostile_against_others = yes
	# can_ask_to_join_war = yes
	can_use_gui = {
		ROOT = {
			religion_authority = 0.05
			religion = old_ones
			OR = {
				trait = creature_slann
				has_character_flag = sanctioned_by_slann
			}
			custom_tooltip = {
				text = ctt_no_crusade_cooldown
				hidden_tooltip = {
					NOT = {
						has_character_modifier = crusade_cooldown
					}
				}
			}
			piety = 500
		}
	}
	can_use = {
		ROOT = {
			# can_call_crusade = yes
			ai = yes
			OR = {
				trait = creature_slann
				has_character_flag = sanctioned_by_slann
			}
		}
		FROM = {
			NOT = {
				religion_group = ROOT
			}
		}
	}
	can_use_title = {
		wh_cb_albion_check_trigger = yes
		NOT = {
			region = world_underempire
		}
		FROM = {
			any_realm_title = {
				de_jure_liege_or_above = PREVPREV
			}
			independent = yes # Don't declare Crusades on revolters - chances are high the war will invalidate
		}
	}
	is_valid = {
		# ROOT = {
		# 	can_call_crusade = yes
		# }
		FROM = {
			OR = {
				NOT = {
					religion_group = ROOT
				}
				is_heresy_of = ROOT
				is_parent_religion = ROOT
			}
		}
	}
	is_valid_title = {
		FROM = {
			any_realm_title = {
				de_jure_liege_or_above = PREVPREV
			}
		}
	}
	on_add = {
		ROOT = {
			custom_tooltip = {
				text = holy_war_cooldown_ctt
				hidden_tooltip = {
					add_character_modifier = {
						name = crusade_cooldown
						hidden = yes
						duration = 10950
					}
				}
			}
		}
	}
	on_success_title = {
		most_participating_attacker = {
			decadence = -25
			piety = 400
			random_list = {
				33 = {
					military_techpoints = 500
				}
				33 = {
					economy_techpoints = 500
				}
				33 = {
					culture_techpoints = 500
				}
			}
			hidden_tooltip = {
				if = {
					limit = {
						has_nickname = no
					}
					random_list = {
						10 = {
							give_nickname = nick_the_deliverer
						}
						10 = {
							give_nickname = nick_the_slithering
						}
						15 = {
							give_nickname = nick_the_glorious
						}
						10 = {
							give_nickname = nick_the_greatcoatl
						}
						15 = {
							give_nickname = nick_the_keeper
						}
						15 = {
							give_nickname = nick_the_herald
						}
						15 = {
							give_nickname = nick_the_prophet
						}
						15 = {
							give_nickname = nick_the_holy
						}
					}
				}
			}
		}
		any_attacker = {
			limit = {
				character = ROOT
			}
			participation_scaled_prestige = 500
			participation_scaled_piety = 1000
			clr_character_flag = sanctioned_by_slann
			disband_event_forces = liz_fleet
		}
		any_attacker = {
			limit = {
				NOT = {
					character = ROOT
				}
			}
			hidden_tooltip = {
				disband_event_forces = liz_fleet
				participation_scaled_prestige = 500
				participation_scaled_piety = 1000
				decadence = -15
				clr_character_flag = sanctioned_by_slann
				random_list = {
					33 = {
						military_techpoints = 100
					}
					33 = {
						economy_techpoints = 100
					}
					33 = {
						culture_techpoints = 100
					}
				}
			}
		}
		ROOT = {
			religion_authority = {
				modifier = won_crusade
				years = 20
			}
		}
		FROM = {
			piety = -100
			disband_event_forces = liz_fleet
			religion_authority = {
				modifier = lost_crusade
				years = 20
			}
		}
	}
	on_fail = {
		ROOT = {
			piety = -100
			decadence = 20
			clr_character_flag = sanctioned_by_slann
			disband_event_forces = liz_fleet
		}
		any_defender = {
			limit = {
				character = FROM
			}
			participation_scaled_piety = 200
			participation_scaled_prestige = 100
			disband_event_forces = liz_fleet
		}
		any_defender = {
			limit = {
				NOT = {
					character = FROM
				}
			}
			hidden_tooltip = {
				participation_scaled_piety = 200
				participation_scaled_prestige = 100
				disband_event_forces = liz_fleet
			}
		}
		FROM = {
			hidden_tooltip = {
				disband_event_forces = liz_fleet
				if = {
					limit = {
						has_nickname = no
					}
					random_list = {
						10 = {
							give_nickname = nick_the_holy
						}
						10 = {
							give_nickname = nick_the_glorious
						}
						10 = {
							give_nickname = nick_the_lionheart
						}
						10 = {
							give_nickname = nick_the_great
						}
						10 = {
							give_nickname = nick_the_hammer
						}
					}
				}
			}
		}
	}
	on_reverse_demand = {
		ROOT = {
			piety = -200
			decadence = 30
			clr_character_flag = sanctioned_by_slann
			disband_event_forces = liz_fleet
			religion_authority = {
				modifier = lost_crusade
				years = 20
			}
		}
		FROM = {
			piety = 100
			disband_event_forces = liz_fleet
			religion_authority = {
				modifier = won_crusade
				years = 20
			}
		}
		FROM = {
			hidden_tooltip = {
				if = {
					limit = {
						has_nickname = no
					}
					random_list = {
						10 = {
							give_nickname = nick_the_holy
						}
						10 = {
							give_nickname = nick_the_glorious
						}
						10 = {
							give_nickname = nick_the_lionheart
						}
						10 = {
							give_nickname = nick_the_great
						}
						10 = {
							give_nickname = nick_the_hammer
						}
					}
				}
			}
		}
		any_defender = {
			limit = {
				NOT = {
					character = FROM
				}
			}
			hidden_tooltip = {
				disband_event_forces = liz_fleet
				participation_scaled_piety = 300
				participation_scaled_prestige = 150
			}
		}
	}
	attacker_ai_victory_worth = {
		factor = -1 # always accept
	}
	attacker_ai_defeat_worth = {
		factor = 100
	}
	defender_ai_victory_worth = {
		factor = -1 # always accept
	}
	defender_ai_defeat_worth = {
		factor = 100
	}
}

# Sotek conquest
sotek_conquest_cb = {
	name = CB_NAME_SOTEK_PURIFICATION
	war_name = WAR_NAME_SOTEK_PURIFICATION
	sprite = 9
	truce_days = 3650
	is_permanent = yes
	is_holy_war = yes
	check_de_jure_tier = DUKE # this scans all dejure duchies for the counties which are held by or vassals(or below) of selected character. Only valid if is_permanent = yes
	can_use = {
		ROOT = {
			has_character_modifier = favour_sotek
			OR = {
				trait = creature_skink
				trait = creature_slann
			}
		}
		FROM = {
			NOR = {
				trait = creature_slann
				trait = creature_saurus
				trait = creature_skink
			}
		}
	}
	on_add = {
		ROOT = {
			decadence = 20
		}
	}
	can_use_title = {
		wh_cb_albion_check_trigger = yes
		nor = {
			region = world_underempire
			region = world_nehekhara
		}
		OR = {
			capital_scope = {
				region = world_new_world_lustria
			}
			capital_scope = {
				region = world_new_world_arnheim
			}
		}
		# The attacker needs at least one county in the target kingdom, or a border, or be only two sea zones away from one of your counties
		any_direct_de_jure_vassal_title = {
			OR = {
				holder_scope = {
					OR = {
						character = ROOT
						is_liege_or_above = ROOT
					}
				}
				location = {
					any_neighbor_province = {
						OR = {
							AND = {
								has_owner = yes
								owner = {
									OR = {
										character = ROOT
										is_liege_or_above = ROOT
									}
								}
							}
							AND = {
								is_land = no
								year = 1100
								any_neighbor_province = {
									OR = {
										AND = {
											has_owner = yes
											owner = {
												OR = {
													character = ROOT
													is_liege_or_above = ROOT
												}
											}
										}
										AND = {
											is_land = no
											any_neighbor_province = {
												owner = {
													OR = {
														character = ROOT
														is_liege_or_above = ROOT
													}
												}
											}
										}
									}
								}
							}
						}
					}
				}
			}
		}
	}
	is_valid = {
		wh_cb_root_not_same_realm_from_rigger = yes
	}
	on_success = {
		any_attacker = {
			limit = {
				character = ROOT
			}
			participation_scaled_piety = 100
			participation_scaled_prestige = 50
		}
		any_attacker = {
			limit = {
				NOT = {
					character = ROOT
				}
			}
			hidden_tooltip = {
				participation_scaled_piety = 100
				participation_scaled_prestige = 50
			}
		}
		FROM = {
			piety = -100
			prestige = -50
		}
	}
	on_success_title = {
		custom_tooltip = {
			text = religious_cb_succ_tip
			hidden_tooltip = {
				ROOT = {
					vassalize_or_take_under_title = {
						title = PREV
						enemy = FROM
						same_religion = yes # Only vassalize rulers of my religion
						is_religious = yes
						type = holy_war
					}
					# 				gain_settlements_under_title = {
					# 					title = PREV
					# 					enemy = FROM
					# 				}
				}
			}
		}
	}
	on_fail = {
		ROOT = {
			piety = -50
			prestige = -100
		}
	}
	on_reverse_demand = {
		ROOT = {
			transfer_scaled_wealth = {
				to = FROM
				value = 4.0
			}
			piety = -75
			prestige = -150
		}
		any_defender = {
			limit = {
				character = FROM
			}
			participation_scaled_piety = 200
			participation_scaled_prestige = 100
			if = {
				limit = {
					uses_decadence = yes
				}
				participation_scaled_decadence = -5
			}
		}
		any_defender = {
			limit = {
				NOT = {
					character = FROM
				}
			}
			hidden_tooltip = {
				participation_scaled_piety = 200
				participation_scaled_prestige = 100
				if = {
					limit = {
						uses_decadence = yes
					}
					participation_scaled_decadence = -5
				}
			}
		}
	}
	attacker_ai_victory_worth = {
		factor = -1 # always accept
	}
	attacker_ai_defeat_worth = {
		factor = 100
	}
	defender_ai_victory_worth = {
		factor = -1 # always accept
	}
	defender_ai_defeat_worth = {
		factor = 100
	}
	ai_will_do = {
		factor = 1
		modifier = {
			factor = 0
			ROOT = {
				NOR = {
					trait = defective
					trait = ambitious
					trait = greedy
					trait = proud
				}
			}
		}
		modifier = {
			factor = 10
			ROOT = {
				trait = defective
			}
		}
	}
}

# Slann are dead cb
crazy_skinks_cb = {
	name = CB_NAME_CRAZED_SKINKS
	war_name = WAR_NAME_CRAZED_SKINKS
	sprite = 9
	truce_days = 150
	is_permanent = yes
	is_holy_war = yes
	check_de_jure_tier = DUKE # this scans all dejure duchies for the counties which are held by or vassals(or below) of selected character. Only valid if is_permanent = yes
	can_use = {
		has_global_flag = all_slann_dead
		ROOT = {
			trait = creature_skink
		}
	}
	can_use_title = {
		wh_cb_albion_check_trigger = yes
		nor = {
			region = world_underempire
			region = world_nehekhara
		}
		# The attacker needs at least one county in the target kingdom, or a border, or be only two sea zones away from one of your counties
		any_direct_de_jure_vassal_title = {
			OR = {
				holder_scope = {
					OR = {
						character = ROOT
						is_liege_or_above = ROOT
					}
				}
				location = {
					any_neighbor_province = {
						OR = {
							AND = {
								has_owner = yes
								owner = {
									OR = {
										character = ROOT
										is_liege_or_above = ROOT
									}
								}
							}
							AND = {
								is_land = no
								year = 1100
								any_neighbor_province = {
									OR = {
										AND = {
											has_owner = yes
											owner = {
												OR = {
													character = ROOT
													is_liege_or_above = ROOT
												}
											}
										}
										AND = {
											is_land = no
											any_neighbor_province = {
												owner = {
													OR = {
														character = ROOT
														is_liege_or_above = ROOT
													}
												}
											}
										}
									}
								}
							}
						}
					}
				}
			}
		}
	}
	is_valid = {
		wh_cb_root_not_same_realm_from_rigger = yes
	}
	on_success = {
		any_attacker = {
			limit = {
				character = ROOT
			}
			participation_scaled_piety = 100
			participation_scaled_prestige = 50

		}
		any_attacker = {
			limit = {
				NOT = {
					character = ROOT
				}
			}
			hidden_tooltip = {
				participation_scaled_piety = 100
				participation_scaled_prestige = 50

			}
		}
		FROM = {
			piety = -100
		}
		FROM = {
			prestige = -50
		}
	}
	on_success_title = {
		custom_tooltip = {
			text = religious_cb_succ_tip
			hidden_tooltip = {
				ROOT = {
					vassalize_or_take_under_title = {
						title = PREV
						enemy = FROM
						same_religion = yes # Only vassalize rulers of my religion
						is_religious = yes
						type = holy_war
					}
					# 				gain_settlements_under_title = {
					# 					title = PREV
					# 					enemy = FROM
					# 				}
				}
			}
		}
	}
	on_fail = {
		ROOT = {
			piety = -50
			prestige = -100
		}
	}
	on_reverse_demand = {
		ROOT = {
			transfer_scaled_wealth = {
				to = FROM
				value = 4.0
			}
			piety = -75
			prestige = -150
		}
		any_defender = {
			limit = {
				character = FROM
			}
			participation_scaled_piety = 200
			participation_scaled_prestige = 100
			if = {
				limit = {
					uses_decadence = yes
				}
				participation_scaled_decadence = -5
			}
		}
		any_defender = {
			limit = {
				NOT = {
					character = FROM
				}
			}
			hidden_tooltip = {
				participation_scaled_piety = 200
				participation_scaled_prestige = 100
				if = {
					limit = {
						uses_decadence = yes
					}
					participation_scaled_decadence = -5
				}
			}
		}
	}
	attacker_ai_victory_worth = {
		factor = -1 # always accept
	}
	attacker_ai_defeat_worth = {
		factor = 100
	}
	defender_ai_victory_worth = {
		factor = -1 # always accept
	}
	defender_ai_defeat_worth = {
		factor = 100
	}
	ai_will_do = {
		factor = 1
		modifier = {
			factor = 100
		}
		modifier = {
			factor = 10
			ROOT = {
				trait = defective
			}
		}
	}
}

strengthen_amazonia_cb = {
	name = CB_NAME_STRENGTHEN_AMAZONIA
	war_name = WAR_NAME_STRENGTHEN_AMAZONIA
	sprite = 6
	truce_days = 3000
	attacker_can_call_allies = no
	can_ask_to_join_war = no
	major_revolt = yes
	can_use = {
		ROOT = {
			vassal_of = FROM
			trait = creature_amazon
		}
	}
	is_valid = {
		FROM = {
			trait = creature_amazon
			in_revolt = no
			liege_before_war = {
				in_revolt = no
				liege_before_war = {
					in_revolt = no
				}
			}
		}
		ROOT = {
			OR = {
				liege = {
					character = PREV # either independent
				}
				liege = {
					FROM = {
						is_liege_or_above = PREV # or have shared liege
					}
				}
			}
		}
	}
	is_valid_title = {
		NOT = {
			region = world_underempire
		}
		OR = {
			tier = emperor
			is_primary_holder_title = yes
		}
	}
	on_add = {
		ROOT = {
			if = {
				limit = {
					FROM = {
						NOT = {
							trait = complacent
						}
					}
				}
				decadence = 5
			}
		}
	}
	on_success = {
		FROM = {
			hidden_tooltip = {
				disband_event_forces = faction_loyalists
			}
			any_demesne_title = {
				# All titles
				limit = {
					OR = {
						tier = king
						tier = emperor
					}
					NOT = {
						has_law = tribal_organization_0
					}
				}
				if = {
					limit = {
						has_law = tribal_organization_1
					}
					add_law = tribal_organization_0
				}
				if = {
					limit = {
						has_law = tribal_organization_2
					}
					add_law = tribal_organization_1
				}
				if = {
					limit = {
						has_law = tribal_organization_3
					}
					add_law = tribal_organization_2
				}
				if = {
					limit = {
						has_law = tribal_organization_4
					}
					add_law = tribal_organization_3
				}
			}
			any_demesne_title = {
				limit = {
					higher_tier_than = COUNT
				}
				gain_title = {
					target = ROOT
					type = faction_demand
				}
			}
		}
		any_attacker = {
			limit = {
				character = ROOT
			}
			participation_scaled_prestige = 100
			hidden_tooltip = {
				disband_event_forces = faction_revolters
			}
		}
		any_attacker = {
			limit = {
				NOT = {
					character = ROOT
				}
			}
			hidden_tooltip = {
				participation_scaled_prestige = 100
				disband_event_forces = faction_revolters
			}
		}
	}
	on_success_title = {
	}
	on_fail = {
		ROOT = {
			prestige = -100
			piety = -100
			decadence = 10
		}
		any_defender = {
			limit = {
				character = FROM
			}
			participation_scaled_prestige = 50
		}
		any_defender = {
			limit = {
				NOT = {
					character = FROM
				}
			}
			hidden_tooltip = {
				participation_scaled_prestige = 50
			}
		}
		hidden_tooltip = {
			any_attacker = {
				disband_event_forces = faction_revolters
				add_character_modifier = {
					name = faction_misaligned_chief_ultimatum_timer
					hidden = yes
					duration = 3650
				}
			}
		}
		FROM = {
			decadence = -5
			hidden_tooltip = {
				disband_event_forces = faction_loyalists
			}
		}
	}
	on_reverse_demand = {
		ROOT = {
			prestige = -200
			piety = -250
			decadence = 15
		}
		ROOT = {
			if = {
				limit = {
					trait = complacent
				}
			}
			imprison = FROM
		}
		any_defender = {
			limit = {
				character = FROM
			}
			participation_scaled_prestige = 100
		}
		any_defender = {
			limit = {
				NOT = {
					character = FROM
				}
			}
			hidden_tooltip = {
				participation_scaled_prestige = 100
			}
		}
		hidden_tooltip = {
			any_attacker = {
				limit = {
					liege = {
						character = FROM
					}
				}
				prisoner = FROM
				disband_event_forces = faction_revolters
				add_character_modifier = {
					name = faction_misaligned_chief_ultimatum_timer
					hidden = yes
					duration = 3650
				}
			}
		}
		FROM = {
			decadence = -10
			hidden_tooltip = {
				disband_event_forces = faction_loyalists
			}
		}
	}
	attacker_ai_victory_worth = {
		factor = -1 # always accept
	}
	attacker_ai_defeat_worth = {
		factor = 100
	}
	defender_ai_victory_worth = {
		factor = -1 # always accept
	}
	defender_ai_defeat_worth = {
		factor = 100
	}
}

# Amazons can subjugate decadent Amazons of their own dynasty
amazon_subjugation = {
	name = CB_NAME_AMAZON_SUBJUGATION
	war_name = WAR_NAME_AMAZON_SUBJUGATION
	sprite = 8
	truce_days = 3650
	hostile_against_others = no
	is_permanent = yes
	can_ask_to_join_war = no
	check_de_jure_tier = KING # this scans all de jure kingdoms for the counties which are held by or vassals(or below) of selected character. Only valid if is_permanent = yes
	can_use = {
		ROOT = {
			trait = creature_amazon
			dynasty = FROM
			NOT = {
				same_realm = FROM
			}
			NOT = {
				is_liege_or_above = FROM
			}
			NOT = {
				trait = defective
			}
		}
		FROM = {
			trait = creature_amazon
			trait = complacent
			NOT = {
				any_war = {
					defender = {
						character = FROM
					}
					using_cb = amazon_subjugation
				}
			}
		}
	}
	can_use_title = {
		wh_cb_albion_check_trigger = yes
		nor = {
			region = world_underempire
			region = world_nehekhara
		}
		FROM = {
			any_realm_title = {
				de_jure_liege_or_above = PREVPREV
			}
		}
	}
	is_valid_title = {
		FROM = {
			any_realm_title = {
				de_jure_liege_or_above = PREVPREV
			}
		}
	}
	on_add_title = {
	}
	on_success = {
		ROOT = {
			piety = 100
			decadence = -7
		}
		any_attacker = {
			limit = {
				character = ROOT
			}
			participation_scaled_piety = 100
		}
		any_attacker = {
			limit = {
				NOT = {
					character = ROOT
				}
			}
			hidden_tooltip = {
				participation_scaled_piety = 100
			}
			decadence = -5
		}
		FROM = {
			piety = -100
			prestige = -100
			abdicate_to = ROOT
			imprison = ROOT
		}
	}
	on_success_title = {
		# Usurp the target kingdom itself, if the enemy holds it
		if = {
			limit = {
				holder_scope = {
					character = FROM
				}
				NOT = {
					ROOT = {
						tier = EMPEROR
					}
				}
			}
			ROOT = {
				usurp_title = {
					target = PREV
					type = invasion
				}
			}
		}
		if = {
			# Take the enemy's duchies within the target kingdom, if we are the same or lower tier
			limit = {
				ROOT = {
					NOT = {
						higher_tier_than = FROM
					}
				}
			}
			FROM = {
				any_demesne_title = {
					limit = {
						tier = DUKE
						OR = {
							title = PREVPREV
							de_jure_liege_or_above = PREVPREV
						}
					}
					ROOT = {
						usurp_title = {
							target = PREV
							type = invasion
						}
					}
				}
			}
		}
		# Have I become the vassal of the loser due to taking a duchy or kingdom?
		if = {
			limit = {
				ROOT = {
					is_liege_or_above = FROM
				}
			}
			ROOT = {
				set_defacto_liege = ROOT
			}
		}
		# Vassalize the rest
		custom_tooltip = {
			text = pagan_subjugation_tip
			hidden_tooltip = {
				ROOT = {
					subjugate_or_take_under_title = {
						# If the target only has territory within the kingdom, he is simply vassalized
						title = PREV
						enemy = FROM
					}
				}
			}
		}
	}
	on_fail = {
		FROM = {
			piety = 50
			decadence = -2
		}
		any_defender = {
			limit = {
				character = FROM
			}
			participation_scaled_prestige = 50
		}
		any_defender = {
			limit = {
				NOT = {
					character = FROM
				}
			}
			hidden_tooltip = {
				participation_scaled_prestige = 50
			}
			decadence = -4
		}
		ROOT = {
			piety = -100
			decadence = 2
		}
	}
	on_reverse_demand = {
		ROOT = {
			piety = -200
			decadence = 5
			transfer_scaled_wealth = {
				to = FROM
				value = 2.0
			}
		}
		FROM = {
			piety = 100
			decadence = -4
		}
		any_defender = {
			limit = {
				character = FROM
			}
			participation_scaled_prestige = 100
		}
		any_defender = {
			limit = {
				NOT = {
					character = FROM
				}
			}
			hidden_tooltip = {
				participation_scaled_prestige = 100
			}
			decadence = -6
		}
	}
	attacker_ai_victory_worth = {
		factor = 200
	}
	attacker_ai_defeat_worth = {
		factor = 100
	}
	defender_ai_victory_worth = {
		factor = -1 # always accept
	}
	defender_ai_defeat_worth = {
		factor = 100
	}
	ai_will_do = {
		factor = 1
		modifier = {
			factor = 1.5
			FROM = {
				decadence = 80
			}
		}
		modifier = {
			factor = 1.5
			FROM = {
				decadence = 85
			}
		}
		modifier = {
			factor = 1.5
			FROM = {
				decadence = 90
			}
		}
		modifier = {
			factor = 1.5
			FROM = {
				decadence = 95
			}
		}
		modifier = {
			factor = 2
			FROM = {
				decadence = 100
			}
		}
		modifier = {
			factor = 2
			FROM = {
				trait = complacent
			}
		}
	}
}

# greenskins
# Greenskin version of the Beastman Conquest CB
orc_county_conquest = {
	name = CB_NAME_ORC_COUNTY_CONQUEST
	war_name = WAR_NAME_ORC_COUNTY_CONQUEST
	sprite = 17
	truce_days = 549 # A year and a half
	hostile_against_others = yes
	is_holy_war = yes
	is_permanent = yes
	check_all_titles = yes
	press_claim = yes
	is_holy_war = yes
	can_ask_to_join_war = yes
	allow_whitepeace = no
	can_call_allies = yes
	can_use_gui = {
		ROOT = {
			prestige = 5
		}
	}
	on_add = {
		ROOT = {
			prestige = -5
		}
	}
	can_use = {
		ROOT = {
			NOT = {
				is_liege_or_above = FROM
			}
		}
	}
	on_attacker_leader_death = {
		end_war = invalid
	}
	can_use_title = {
		tier = count
		wh_cb_albion_check_trigger = yes
		nor = {
			region = world_underempire
			region = world_nehekhara
		}
		ROOT = {
			NOT = {
				has_opinion_modifier = {
					who = FROM
					modifier = opinion_scared_goblins
				}
			}
		}
		FROM = {
			NOT = {
				has_opinion_modifier = {
					who = ROOT
					modifier = opinion_scared_goblins
				}
			}
		}
		OR = {
			FROM = {
				has_landed_title = PREV
			}
			holder_scope = {
				is_liege_or_above = FROM
				NOT = {
					same_realm = ROOT
				}
			}
		}
		ROOT = {
			religion_group = greenskin_gods_group
			OR = {
				trait = creature_orc
				trait = creature_goblin
				trait = creature_snotling # Maybe???
			}
		}
		wh_cb_can_use_title_trigger = yes
		location = {
			any_neighbor_province = {
				owner = {
					OR = {
						character = ROOT
						is_liege_or_above = ROOT
					}
				}
			}
		}
	}
	is_valid_title = {
		wh_cb_is_valid_title_trigger = yes
	}
	on_success_title = {
		ROOT = {
			occupy_minors_of_occupied_settlements = FROM
			gain_all_occupied_titles = {
				who = FROM
				type = invasion
			}
		}
		usurp_title_plus_barony_if_unlanded = {
			target = ROOT
			type = invasion
		}
		any_de_jure_vassal_title = {
			# take all baronies under the one we're fighting for
			limit = {
				has_holder = yes
				NOT = {
					de_facto_liege = PREV
				}
				holder_scope = {
					OR = {
						character = FROM
						is_liege_or_above = FROM
					}
				}
			}
			usurp_title_plus_barony_if_unlanded = {
				target = ROOT
				type = invasion
			}
		}
		any_attacker = {
			limit = {
				character = ROOT
			}
			participation_scaled_prestige = 100
		}
		any_attacker = {
			limit = {
				NOT = {
					character = ROOT
				}
			}
			hidden_tooltip = {
				participation_scaled_prestige = 100
			}
		}
	}
	on_fail_title = {
		ROOT = {
			prestige = -100
		}
		any_defender = {
			limit = {
				character = FROM
			}
			participation_scaled_prestige = 50
		}
		any_defender = {
			limit = {
				NOT = {
					character = FROM
				}
			}
			hidden_tooltip = {
				participation_scaled_prestige = 50
			}
		}
	}
	on_reverse_demand = {
		ROOT = {
			prestige = -200
			transfer_scaled_wealth = {
				to = FROM
				value = 4.0
			}
		}
		any_defender = {
			limit = {
				character = FROM
			}
			participation_scaled_prestige = 100
		}
		any_defender = {
			limit = {
				NOT = {
					character = FROM
				}
			}
			hidden_tooltip = {
				participation_scaled_prestige = 100
			}
		}
	}
	attacker_ai_victory_worth = {
		factor = -1 # always accept
	}
	attacker_ai_defeat_worth = {
		factor = 100
	}
	defender_ai_victory_worth = {
		factor = -1 # always accept
	}
	defender_ai_defeat_worth = {
		factor = 100
	}
	ai_will_do = {
		factor = 1
		modifier = {
			factor = 10
			root = {
				trait = lunatic_3
			}
		}
		modifier = {
			factor = 0.01
			ROOT = {
				religion = spider_god
			}
			FROM = {
				religion = shadowmen
			}
		}
		modifier = {
			factor = 0
			ROOT = {
				religion = spider_god
			}
			FROM = {
				trait = vampire_mahtmasi_visible
			}
		}
	}
}

# For the "Declare WAAAGH!" targetted decision
waaagh_invasion = {
	name = CB_NAME_WAAAGH
	war_name = WAR_NAME_WAAAGH
	sprite = 8
	truce_days = 3650
	hostile_against_others = yes
	is_permanent = yes
	is_holy_war = yes
	can_ask_to_join_war = yes
	allow_whitepeace = no
	can_call_allies = yes
	battle_warscore_mult = 0.1
	# press_claim = yes
	check_de_jure_tier = KING # this scans all de jure kingdoms for the counties which are held by or vassals(or below) of selected character. Only valid if is_permanent = yes
	apply_short_occ_mod = no # Do not apply the 'recently_conquered'	modifier to Holdings
	can_use = {
		ROOT = {
			has_opinion_modifier = {
				who = FROM
				modifier = preparing_waaagh_invasion_opinion
			}
			religion_group = greenskin_gods_group
			NOT = {
				religion_group = FROM
			}	# Not against other Greenskins
		}
	}
	can_use_title = {
		wh_cb_albion_check_trigger = yes
		nor = {
			region = world_underempire
			region = world_nehekhara
		}
	}
	is_valid_title = {
		FROM = {
			any_realm_title = {
				de_jure_liege_or_above = PREVPREV
			}
		}
	}
	on_add = {
		ROOT = {
			remove_character_modifier = preparing_waaagh_invasion
			clr_character_flag = preparing_waaagh_invasion_flag
		}
	}
	on_success = {
		ROOT = {
			add_character_modifier = {
				modifier = attempted_waaagh
				duration = 3650
			}
			# occupy_minors_of_occupied_settlements = FROM
			# gain_all_occupied_titles = { who = FROM		type = invasion }
			prestige = 1000
			religion_authority = {
				modifier = won_viking_invasion
			}
		}
		any_attacker = {
			limit = {
				character = ROOT
			}
			participation_scaled_prestige = 500
		}
		any_attacker = {
			limit = {
				NOT = {
					character = ROOT
				}
			}
			hidden_tooltip = {
				participation_scaled_prestige = 500
			}
		}
		FROM = {
			prestige = -500
		}
	}
	on_success_title = {
		custom_tooltip = {
			text = waaagh_succ_tip
			hidden_tooltip = {
				FROM = {
					remove_opinion = {
						who = FROM
						modifier = preparing_waaagh_invasion_opinion_against_me
					}
				}
				# any_de_jure_vassal_title = {
				# limit = {
				# has_holder = yes
				# holder_scope = {
				# OR = {
				# character = FROM
				# is_liege_or_above = FROM
				# }
				# }
				# }
				# holder_scope = {
				# death = {
				# death_reason = death_execution
				# killer = ROOT
				# }
				# }
				# any_de_jure_vassal_title = {
				# holder_scope = {
				# death = {
				# death_reason = death_execution
				# killer = ROOT
				# }
				# }
				# }
				# }
				ROOT = {
					gain_settlements_under_title = {
						title = PREV
						enemy = FROM
						type = holy_war
					}
					any_realm_province = {
						limit = {
							de_jure_liege_or_above = PREVPREV
							OR = {
								NOT = {
									culture = ROOT
								}
								NOT = {
									religion = ROOT
								}
							}
						}
						culture = ROOT
						religion = ROOT
						any_province_holding = {
							limit = {
								is_capital = yes
							}
							convert_to = TRIBAL
							add_building = tb_greenskin_camp_1
							refill_holding_levy = yes
						}
						any_province_holding = {
							limit = {
								is_capital = no
							}
							destroy_settlement = THIS
						}
					}
					any_demesne_title = {
						limit = {
							tier = BARON
						}
						remove_holding_modifier = recently_conquered
						refill_holding_levy = yes
					}
					clr_character_flag = preparing_waaagh_invasion_flag
					remove_opinion = {
						who = FROM
						modifier = preparing_waaagh_invasion_opinion
					}
					# Settle the special invasion forces
					disband_event_forces = prepared_invasion
				}
			}
		}
	}
	on_fail = {
		FROM = {
			prestige = 200
			set_character_flag = imperial_hero
			remove_opinion = {
				who = FROM
				modifier = preparing_waaagh_invasion_opinion_against_me
			}
		}
		any_defender = {
			limit = {
				character = FROM
			}
			participation_scaled_prestige = 200
			set_character_flag = imperial_hero
		}
		any_defender = {
			limit = {
				NOT = {
					character = FROM
				}
			}
			hidden_tooltip = {
				participation_scaled_prestige = 200
			}
			set_character_flag = imperial_hero
		}
		ROOT = {
			add_character_modifier = {
				modifier = attempted_waaagh
				duration = 3650
			}
			clr_character_flag = preparing_waaagh_invasion_flag
			remove_opinion = {
				who = FROM
				modifier = preparing_waaagh_invasion_opinion
			}
			prestige = -500
			hidden_tooltip = {
				disband_event_forces = prepared_invasion
			}
			religion_authority = {
				modifier = lost_viking_invasion
			}
		}
	}
	# on_fail_title = {
	# 	ROOT = {
	# 		remove_claim = PREV
	# 	}
	# }
	on_reverse_demand = {
		ROOT = {
			add_character_modifier = {
				modifier = attempted_waaagh
				duration = 3650
			}
			clr_character_flag = preparing_waaagh_invasion_flag
			remove_opinion = {
				who = FROM
				modifier = preparing_waaagh_invasion_opinion
			}
			prestige = -1000
			transfer_scaled_wealth = {
				to = FROM
				value = 2.0
			}
			hidden_tooltip = {
				disband_event_forces = prepared_invasion
			}
			religion_authority = {
				modifier = lost_viking_invasion
			}
		}
		FROM = {
			prestige = 500
			set_character_flag = imperial_hero
			remove_opinion = {
				who = FROM
				modifier = preparing_waaagh_invasion_opinion_against_me
			}
		}
		any_defender = {
			limit = {
				character = FROM
			}
			set_character_flag = imperial_hero
			participation_scaled_prestige = 250
		}
		any_defender = {
			limit = {
				NOT = {
					character = FROM
				}
			}
			set_character_flag = imperial_hero
			hidden_tooltip = {
				participation_scaled_prestige = 250
			}
		}
	}
	# on_reverse_demand_title = { ROOT = { remove_claim = PREV } }
	on_attacker_leader_death = {
		end_war = invalid
	}
	attacker_ai_victory_worth = {
		factor = 200
	}
	attacker_ai_defeat_worth = {
		factor = 100
	}
	defender_ai_victory_worth = {
		factor = -1 # always accept
	}
	defender_ai_defeat_worth = {
		factor = 100
	}
	ai_will_do = {
		factor = 1
		modifier = {
			factor = 0
			NOT = {
				ROOT = {
					had_character_flag = {
						flag = preparing_waaagh_invasion_flag
						days = 200
					}
				}
			}
		}
		modifier = {
			factor = 100
			ROOT = {
				had_character_flag = {
					flag = preparing_waaagh_invasion_flag
					days = 200
				}
			}
		}
	}
}

greenskin_uprising = {
	name = CB_NAME_GREENSKIN_UPRISING
	war_name = WAR_NAME_GREENSKIN_UPRISING
	sprite = 16
	truce_days = 365
	hostile_against_others = yes
	is_permanent = yes
	check_all_titles = yes
	# press_claim = yes
	can_call_allies = no
	can_ask_to_join_war = no
	is_independence = yes
	can_use = {
		ROOT = {
			primary_title = {
				temporary = yes
			} # Revolter or adventurer trigger
			war = no
			NOT = {
				is_liege_or_above = FROM
			}
		}
	}
	can_use_title = {
		nor = {
			region = world_underempire
			region = world_nehekhara
		}
	}
	is_valid_title = {
		tier = count
		wh_cb_is_valid_title_trigger = yes
	}
	on_success_title = {
		#occupy_minors_of_occupied_settlements = FROM
		# gain_all_occupied_titles = {
		# 	who = FROM
		# 	type = invasion
		# }
		usurp_title_plus_barony_if_unlanded = {
			target = ROOT
			type = revolt
		}
		ROOT = {
			set_defacto_liege = ROOT
		}
		FROM = {
			prestige = -100
			piety = -100
		}
	}
	on_fail_title = {
		FROM = {
			prestige = 10
			hidden_tooltip = {
				opinion = {
					modifier = opinion_savage_invader
					who = ROOT
					months = 1200
				}
			}
		}
		ROOT = {
			death = {
				death_reason = death_execution
				killer = FROM
			}
		}
	}
	on_reverse_demand = {
		FROM = {
			prestige = 20
			hidden_tooltip = {
				opinion = {
					modifier = opinion_savage_invader
					who = ROOT
					months = 1200
				}
				add_character_modifier = {
					name = scattered_greenskins
					days = 1825
				}
			}
		}
		ROOT = {
			death = {
				death_reason = death_execution
				killer = FROM
			}
		}
	}
	attacker_ai_victory_worth = {
		factor = -1 # always accept
	}
	attacker_ai_defeat_worth = {
		factor = 100
	}
	defender_ai_victory_worth = {
		factor = -1 # always accept
	}
	defender_ai_defeat_worth = {
		factor = 100
	}
}

purge_greenskins = {
	name = CB_NAME_ORC_COUNTY_PURGE
	war_name = WAR_NAME_ORC_COUNTY_PURGE
	sprite = 17
	truce_days = 549 # A year and a half
	hostile_against_others = no
	is_holy_war = yes
	is_permanent = yes
	check_all_titles = yes
	press_claim = yes
	can_ask_to_join_war = yes
	allow_whitepeace = no
	can_call_allies = yes
	can_use_gui = {
		ROOT = {
			wealth = 20
		}
	}
	on_add = {
		ROOT = {
			wealth = -20
		}
	}
	can_use = {
		ROOT = {
			nor = {
				culture_group = lizardman_group
				religion_group = greenskin_gods_group
				trait = vampire_necrarch_visible
				trait = creature_nehekharan
				trait = creature_beastman
				trait = creature_dwarf
			}
		}
		FROM = {
			religion_group = greenskin_gods_group
		}
	}
	can_use_title = {
		tier = count
		wh_cb_albion_check_trigger = yes
		wh_cb_can_use_title_trigger = yes
		NOT = {
			region = world_underempire
		}
		location = {
			any_neighbor_province = {
				owner = {
					OR = {
						character = ROOT
						is_liege_or_above = ROOT
					}
				}
			}
		}
	}
	is_valid = {
		FROM = {
			religion_group = greenskin_gods_group
		}
	}
	is_valid_title = {
		wh_cb_is_valid_title_trigger = yes
	}
	on_success = {
		FROM = {
			any_realm_province = {
				limit = {
					controlled_by = ROOT
					religion_group = greenskin_gods_group
				}
				add_province_modifier = {
					name = greenskin_population_bad
					duration = -1
				}
			}
		}
	}
	on_success_title = {
		ROOT = {
			occupy_minors_of_occupied_settlements = FROM
			gain_all_occupied_titles = {
				who = FROM
				type = invasion
			}
		}
		usurp_title_plus_barony_if_unlanded = {
			target = ROOT
			type = invasion
		}
		any_de_jure_vassal_title = {
			# take all baronies under the one we're fighting for
			limit = {
				has_holder = yes
				NOT = {
					de_facto_liege = PREV
				}
				holder_scope = {
					OR = {
						character = FROM
						is_liege_or_above = FROM
					}
				}
			}
			usurp_title_plus_barony_if_unlanded = {
				target = ROOT
				type = invasion
			}
		}
		any_attacker = {
			limit = {
				character = ROOT
			}
			participation_scaled_prestige = 100
		}
		any_attacker = {
			limit = {
				NOT = {
					character = ROOT
				}
			}
			hidden_tooltip = {
				participation_scaled_prestige = 100
			}
		}
	}
	on_fail_title = {
		ROOT = {
			prestige = -100
		}
		any_defender = {
			limit = {
				character = FROM
			}
			participation_scaled_prestige = 50
		}
		any_defender = {
			limit = {
				NOT = {
					character = FROM
				}
			}
			hidden_tooltip = {
				participation_scaled_prestige = 50
			}
		}
	}
	on_reverse_demand = {
		ROOT = {
			prestige = -200
			transfer_scaled_wealth = {
				to = FROM
				value = 4.0
			}
		}
		any_defender = {
			limit = {
				character = FROM
			}
			participation_scaled_prestige = 100
		}
		any_defender = {
			limit = {
				NOT = {
					character = FROM
				}
			}
			hidden_tooltip = {
				participation_scaled_prestige = 100
			}
		}
	}
	attacker_ai_victory_worth = {
		factor = -1 # always accept
	}
	attacker_ai_defeat_worth = {
		factor = 100
	}
	defender_ai_victory_worth = {
		factor = -1 # always accept
	}
	defender_ai_defeat_worth = {
		factor = 100
	}
	ai_will_do = {
		factor = 1
		modifier = {
			factor = 0	# Have dwarves focus on the mountains
			NOT = {
				FROM = {
					de_jure_liege = e_karak_ankor
				}
			}
			ROOT = {
				trait = creature_dwarf
			}
		}
		modifier = {
			factor = 0	# Have dwarves focus on the mountains
			NOT = {
				FROM = {
					top_liege = {
						de_jure_liege = e_karak_ankor
					}
				}
			}
			ROOT = {
				trait = creature_dwarf
			}
		}
		modifier = {
			factor = 0.01
			FROM = {
				religion = spider_god
			}
			ROOT = {
				religion = shadowmen
			}
		}
		modifier = {
			factor = 0
			FROM = {
				religion = spider_god
			}
			ROOT = {
				trait = vampire_mahtmasi_visible
			}
		}
	}
}

# For elves
change_political_stance = {
	name = CB_NAME_POLITICAL_STANCE
	war_name = WAR_NAME_POLITICAL_STANCE
	sprite = 6
	truce_days = 9000	# elves
	attacker_can_call_allies = no
	can_ask_to_join_war = no
	major_revolt = yes
	can_use = {
		ROOT = {
			vassal_of = FROM
			OR = {
				trait = isolationist_elf
				trait = interventionist_elf
			}
		}
	}
	is_valid = {
		FROM = {
			OR = {
				trait = isolationist_elf
				trait = interventionist_elf
			}
			in_revolt = no
			liege_before_war = {
				in_revolt = no
				liege_before_war = {
					in_revolt = no
				}
			}
		}
		ROOT = {
			OR = {
				liege = {
					character = PREV # either independent
				}
				liege = {
					FROM = {
						is_liege_or_above = PREV # or have shared liege
					}
				}
			}
		}
	}
	is_valid_title = {
		OR = {
			tier = emperor
			is_primary_holder_title = yes
		}
	}
	on_success = {
		FROM = {
			if= {
				limit = {
					trait = interventionist_elf
				}
				character_event = {
					id = asur.19 days = 1
				}
			}
				if= {
					limit = {
						trait = isolationist_elf
					}
					character_event = {
						id = asur.20 days = 1
					}
				}		# to cover both with one cb
				hidden_tooltip = {
				disband_event_forces = faction_loyalists
			}
				any_demesne_title = {
				# All titles
				limit = {
					OR = {
						tier = king
						tier = emperor
					}
					NOT = {
						has_law = crown_authority_0
					}
				}
				if = {
					limit = {
						has_law = crown_authority_1
					}
					add_law = crown_authority_0
				}
				if = {
					limit = {
						has_law = crown_authority_2
					}
					add_law = crown_authority_1
				}
				if = {
					limit = {
						has_law = crown_authority_3
					}
					add_law = crown_authority_2
				}
				if = {
					limit = {
						has_law = crown_authority_4
					}
					add_law = crown_authority_3
				}
			}
		}
		any_attacker = {
			limit = {
				character = ROOT
			}
			participation_scaled_prestige = 100
			hidden_tooltip = {
				disband_event_forces = faction_revolters
			}
		}
		any_attacker = {
			limit = {
				NOT = {
					character = ROOT
				}
			}
			hidden_tooltip = {
				participation_scaled_prestige = 100
				disband_event_forces = faction_revolters
			}
		}
	}
	on_success_title = {
	}
	on_fail = {
		ROOT = {
			prestige = -100
		}
		any_defender = {
			limit = {
				character = FROM
			}
			participation_scaled_prestige = 50
		}
		any_defender = {
			limit = {
				NOT = {
					character = FROM
				}
			}
			hidden_tooltip = {
				participation_scaled_prestige = 50
			}
		}
		hidden_tooltip = {
			any_attacker = {
				disband_event_forces = faction_revolters
				add_character_modifier = {
					name = faction_isolationist_elves_ultimatum_timer
					hidden = yes
					duration = 3650
				}
			}
		}
		FROM = {
			hidden_tooltip = {
				disband_event_forces = faction_loyalists
			}
		}
	}
	on_reverse_demand = {
		ROOT = {
			prestige = -200
			prisoner = FROM
		}
		any_defender = {
			limit = {
				character = FROM
			}
			participation_scaled_prestige = 100
		}
		any_defender = {
			limit = {
				NOT = {
					character = FROM
				}
			}
			hidden_tooltip = {
				participation_scaled_prestige = 100
			}
		}
		hidden_tooltip = {
			any_attacker = {
				limit = {
					liege = {
						character = FROM
					}
				}
				prisoner = FROM
				disband_event_forces = faction_revolters
				add_character_modifier = {
					name = faction_succ_seniority_ultimatum_timer
					hidden = yes
					duration = 3650
				}
			}
		}
		FROM = {
			hidden_tooltip = {
				disband_event_forces = faction_loyalists
			}
		}
	}
	attacker_ai_victory_worth = {
		factor = -1 # always accept
	}
	attacker_ai_defeat_worth = {
		factor = 100
	}
	defender_ai_victory_worth = {
		factor = -1 # always accept
	}
	defender_ai_defeat_worth = {
		factor = 100
	}
}

# Used by Ulthuan (and its vassals) to colonize continental coasts (only works against coastal provinces)
coastal_elf_colonization = {
	name = CB_NAME_ELF_COLONIZATION
	war_name = WAR_NAME_ELF_COLONIZATION
	sprite = 16
	truce_days = 2500
	hostile_against_others = yes
	is_permanent = yes
	check_all_titles = yes
	press_claim = yes
	can_ask_to_join_war = yes
	can_call_allies = yes
	allow_distant = yes
	can_use = {
		e_ulthuan = {
			holder_scope = {
				trait = interventionist_elf
			}
		}	# If the King is against meddling, the Princes cannot go
		ROOT = {
			NOT = {
				religion = asrai_cadai
			}
			trait = interventionist_elf
			religion_group = cadai_group
			OR = {
				has_landed_title = e_ulthuan
				top_liege = {
					has_landed_title = e_ulthuan
				}
			}	# The colonization can only start from Ulthuan
			NOT = {
				same_realm = FROM
			}
		}
		FROM = {
			NOT = {
				trait = creature_elf
			} # any non-elf ruler is a good target
		}
	}
	can_use_title = {
		tier = count
		wh_cb_albion_check_trigger = yes
		nor = {
			region = world_underempire
			region = world_nehekhara
		}
		OR = {
			FROM = {
				has_landed_title = PREV
			}
			holder_scope = {
				is_liege_or_above = FROM
				NOT = {
					same_realm = ROOT
				}
			}
		}
		wh_cb_can_use_title_trigger = yes
		location = {
			port = yes
		}
	}
	is_valid_title = {
		e_ulthuan = {
			holder_scope = {
				trait = interventionist_elf
			}
		}	# If the King is against meddling, the Princes cannot go
		ROOT = {
			religion_group = cadai_group
			trait = interventionist_elf
			OR = {
				has_landed_title = e_ulthuan
				top_liege = {
					has_landed_title = e_ulthuan
				}
			}	# The colonization can only start from Ulthuan
			NOT = {
				same_realm = FROM
			}
		}
		FROM = {
			NOT = {
				trait = creature_elf
			}
		}
		wh_cb_is_valid_title_trigger = yes
	}
	on_success = {
		ROOT = {
			character_event = {
				id = asur.26 days = 1
			}
		} # create character, assign by flag
	}
	on_success_title = {
		set_title_flag = elven_colony_flag
		usurp_title_plus_barony_if_unlanded = {
			target = ROOT
			type = invasion
		}
		any_de_jure_vassal_title = {
			# take all baronies too
			limit = {
				has_holder = yes
				holder_scope = {
					OR = {
						character = FROM
						is_liege_or_above = FROM
						AND = {
							is_liege_or_above = ROOT
							NOT = {
								culture = ROOT
							}
							NOT = {
								religion = ROOT
							}
						}
					}
				}
			}
			usurp_title = ROOT
		}
		any_attacker = {
			limit = {
				character = ROOT
			}
			participation_scaled_prestige = 100
			participation_scaled_piety = 50
		}
		any_attacker = {
			limit = {
				NOT = {
					character = ROOT
				}
			}
			hidden_tooltip = {
				participation_scaled_prestige = 100
				participation_scaled_piety = 50
			}
		}
		ROOT = {
			religion_authority = {
				modifier = won_county_conquest
			}
		}
	}
	on_fail_title = {
		ROOT = {
			prestige = -100
			religion_authority = {
				modifier = lost_county_conquest
			}
		}
		any_defender = {
			limit = {
				character = FROM
			}
			participation_scaled_prestige = 50
		}
		any_defender = {
			limit = {
				NOT = {
					character = FROM
				}
			}
			hidden_tooltip = {
				participation_scaled_prestige = 50
			}
		}
	}
	on_reverse_demand = {
		ROOT = {
			prestige = -200
			transfer_scaled_wealth = {
				to = FROM
				value = 4.0
			}
			religion_authority = {
				modifier = lost_county_conquest
			}
		}
		any_defender = {
			limit = {
				character = FROM
			}
			participation_scaled_prestige = 100
			participation_scaled_piety = 50
		}
		any_defender = {
			limit = {
				NOT = {
					character = FROM
				}
			}
			hidden_tooltip = {
				participation_scaled_prestige = 100
				participation_scaled_piety = 50
			}
		}
	}
	attacker_ai_victory_worth = {
		factor = -1 # always accept
	}
	attacker_ai_defeat_worth = {
		factor = 100
	}
	defender_ai_victory_worth = {
		factor = -1 # always accept
	}
	defender_ai_defeat_worth = {
		factor = 100
	}
	ai_will_do = {
		factor = 1
		modifier = {
			factor = 0.25
			holder_scope = {
				trait = phoenix_king	# To prevent excessive imperialism, leave something to the poor Princes!
			}
		}
		modifier = {
			factor = 0
			holder_scope = {
				trait = everqueen # Spiritual guide
			}
		}
	}
}

# used by asur outside Ulthuan to expand their territories (only works for neighbors)
inland_elf_colonization = {
	name = CB_NAME_ELF_COLONIZATION_2
	war_name = WAR_NAME_ELF_COLONIZATION_2
	sprite = 16
	truce_days = 3650
	is_permanent = yes
	is_holy_war = yes
	can_ask_to_join_war = yes
	can_call_allies = yes
	check_de_jure_tier = DUKE # this scans all dejure duchies for the counties which are held by or vassals(or below) of selected character. Only valid if is_permanent = yes
	can_use = {
		ROOT = {
			NOT = {
				religion = asrai_cadai
			}
			religion_group = cadai_group
			trait = creature_elf
			NOT = {
				capital_scope = {
					empire = {
						title = e_ulthuan
					}
				}
			}	# only if you are a colony
			top_liege = {
				NOT = {
					has_landed_title = e_ulthuan
				}
			}
			NOT = {
				same_realm = FROM
			}
		}
		FROM = {
			NOT = {
				religion_group = cadai_group
				trait = creature_elf
				top_liege = {
					has_landed_title = e_ulthuan
				}
			}
		}	# never against other asur
	}
	can_use_title = {
		wh_cb_albion_check_trigger = yes
		nor = {
			region = world_underempire
			region = world_nehekhara
		}
		# The attacker needs at least one county in the target kingdom, or a border, or be only two sea zones away from one of your counties
		any_direct_de_jure_vassal_title = {
			OR = {
				holder_scope = {
					OR = {
						character = ROOT
						is_liege_or_above = ROOT
					}
				}
				location = {
					any_neighbor_province = {
						OR = {
							AND = {
								has_owner = yes
								owner = {
									OR = {
										character = ROOT
										is_liege_or_above = ROOT
									}
								}
							}
							AND = {
								is_land = no
								any_neighbor_province = {
									OR = {
										AND = {
											has_owner = yes
											owner = {
												OR = {
													character = ROOT
													is_liege_or_above = ROOT
												}
											}
										}
										AND = {
											is_land = no
											any_neighbor_province = {
												owner = {
													OR = {
														character = ROOT
														is_liege_or_above = ROOT
													}
												}
											}
										}
									}
								}
							}
						}
					}
				}
			}
		}
	}
	is_valid = {
		ROOT = {
			religion_group = cadai_group
			trait = creature_elf
			NOT = {
				capital_scope = {
					empire = {
						title = e_ulthuan
					}
				}
			}
			top_liege = {
				NOT = {
					has_landed_title = e_ulthuan
				}
			}
			NOT = {
				same_realm = FROM
			}
		}
		FROM = {
			NOT = {
				religion_group = cadai_group
				trait = creature_elf
				top_liege = {
					has_landed_title = e_ulthuan
				}
			}
		}	# never against other asur
	}
	on_success = {
		e_ulthuan = {
			holder_scope = {
				character_event = {
					id = asur.33
				}
			}
		} # give share to Ulthuan
		any_attacker = {
			limit = {
				character = ROOT
			}
			participation_scaled_piety = 100
			participation_scaled_prestige = 50
		}
		any_attacker = {
			limit = {
				NOT = {
					character = ROOT
				}
			}
			hidden_tooltip = {
				participation_scaled_piety = 100
				participation_scaled_prestige = 50
			}
		}
		ROOT = {
			religion_authority = {
				modifier = won_holy_war
				years = 20
			}
		}
		FROM = {
			religion_authority = {
				modifier = lost_holy_war
				years = 20
			}
		}
		FROM = {
			piety = -100
		}
		FROM = {
			prestige = -50
		}
	}
	on_success_title = {
		custom_tooltip = {
			text = religious_cb_succ_tip
			hidden_tooltip = {
				ROOT = {
					vassalize_or_take_under_title = {
						title = PREV
						enemy = FROM
						same_religion = yes # Only vassalize rulers of my religion
						is_religious = yes
						type = invasion
					}
				}
			}
		}
	}
	on_fail = {
		ROOT = {
			piety = -50
			prestige = -100
		}
	}
	on_reverse_demand = {
		ROOT = {
			transfer_scaled_wealth = {
				to = FROM
				value = 4.0
			}
			piety = -75
			prestige = -150
		}
		any_defender = {
			limit = {
				character = FROM
			}
			participation_scaled_piety = 200
			participation_scaled_prestige = 100
		}
		any_defender = {
			limit = {
				NOT = {
					character = FROM
				}
			}
			hidden_tooltip = {
				participation_scaled_piety = 200
				participation_scaled_prestige = 100
			}
		}
		ROOT = {
			religion_authority = {
				modifier = lost_holy_war
				years = 20
			}
		}
		FROM = {
			religion_authority = {
				modifier = won_holy_war
				years = 20
			}
		}
	}
	attacker_ai_victory_worth = {
		factor = -1 # always accept
	}
	attacker_ai_defeat_worth = {
		factor = 100
	}
	defender_ai_victory_worth = {
		factor = -1 # always accept
	}
	defender_ai_defeat_worth = {
		factor = 100
	}
	ai_will_do = {
		factor = 1
		modifier = {
			factor = 0.25			# less likely without backing of homeland
			e_ulthuan = {
				holder_scope = {
					trait = isolationist_elf
				}
			}
		}
	}
}

# Druchii can subjugate other druchii
druchii_subjugation = {
	name = CB_NAME_DRUCHII_SUBJUGATION
	war_name = WAR_NAME_DRUCHII_SUBJUGATION
	sprite = 8
	truce_days = 3650
	hostile_against_others = yes
	is_permanent = yes
	can_ask_to_join_war = yes
	can_call_allies = yes
	check_de_jure_tier = KING # this scans all de jure kingdoms for the counties which are held by or vassals(or below) of selected character. Only valid if is_permanent = yes
	can_use = {
		ROOT = {
			religion_group = cytharai_group
			trait = creature_elf
			NOT = {
				same_realm = FROM
			}
			NOT = {
				is_liege_or_above = FROM
			}
		}
		FROM = {
			religion_group = cytharai_group
			trait = creature_elf
			NOT = {
				any_war = {
					defender = {
						character = FROM
					}
					using_cb = druchii_subjugation
				}
			}
		}
	}
	can_use_title = {
		wh_cb_albion_check_trigger = yes
		nor = {
			region = world_underempire
			region = world_nehekhara
		}
		FROM = {
			any_realm_title = {
				de_jure_liege_or_above = PREVPREV
			}
		}
	}
	is_valid_title = {
		FROM = {
			any_realm_title = {
				de_jure_liege_or_above = PREVPREV
			}
		}
	}
	on_add_title = {
	}
	on_success = {
		ROOT = {
			piety = 100
		}
		any_attacker = {
			limit = {
				character = ROOT
			}
			participation_scaled_prestige = 100
		}
		any_attacker = {
			limit = {
				NOT = {
					character = ROOT
				}
			}
			hidden_tooltip = {
				participation_scaled_prestige = 100
			}
		}
		FROM = {
			piety = -100
			prestige = -100
		}
	}
	on_success_title = {
		# Usurp the target kingdom itself, if the enemy holds it
		if = {
			limit = {
				holder_scope = {
					character = FROM
				}
				NOT = {
					ROOT = {
						tier = EMPEROR
					}
				}
			}
			ROOT = {
				usurp_title = {
					target = PREV
					type = invasion
				}
			}
		}
		if = {
			# Take the enemy's duchies within the target kingdom, if we are the same or lower tier
			limit = {
				ROOT = {
					NOT = {
						higher_tier_than = FROM
					}
				}
			}
			FROM = {
				any_demesne_title = {
					limit = {
						tier = DUKE
						OR = {
							title = PREVPREV
							de_jure_liege_or_above = PREVPREV
						}
					}
					ROOT = {
						usurp_title = {
							target = PREV
							type = invasion
						}
					}
				}
			}
		}
		# Have I become the vassal of the loser due to taking a duchy or kingdom?
		if = {
			limit = {
				ROOT = {
					is_liege_or_above = FROM
				}
			}
			ROOT = {
				set_defacto_liege = ROOT
			}
		}
		# Vassalize the rest
		custom_tooltip = {
			text = pagan_subjugation_tip
			hidden_tooltip = {
				ROOT = {
					subjugate_or_take_under_title = {
						# If the target only has territory within the kingdom, he is simply vassalized
						title = PREV
						enemy = FROM
					}
				}
			}
		}
	}
	on_fail = {
		FROM = {
			piety = 50
		}
		any_defender = {
			limit = {
				character = FROM
			}
			participation_scaled_prestige = 50
		}
		any_defender = {
			limit = {
				NOT = {
					character = FROM
				}
			}
			hidden_tooltip = {
				participation_scaled_prestige = 50
			}
		}
		ROOT = {
			piety = -100
		}
	}
	on_reverse_demand = {
		ROOT = {
			piety = -200
			transfer_scaled_wealth = {
				to = FROM
				value = 2.0
			}
		}
		FROM = {
			piety = 100
		}
		any_defender = {
			limit = {
				character = FROM
			}
			participation_scaled_prestige = 100
		}
		any_defender = {
			limit = {
				NOT = {
					character = FROM
				}
			}
			hidden_tooltip = {
				participation_scaled_prestige = 100
			}
		}
	}
	attacker_ai_victory_worth = {
		factor = 200
	}
	attacker_ai_defeat_worth = {
		factor = 100
	}
	defender_ai_victory_worth = {
		factor = -1 # always accept
	}
	defender_ai_defeat_worth = {
		factor = 100
	}
	ai_will_do = {
		factor = 1
		# Try to guide Malekith south
		modifier = {
			factor = 0.25
			ROOT = {
				trait = malekith
				primary_title = {
					title = e_naggaroth
				}
			}
			NOT = {
				empire = {
					title = e_naggaroth
				}
			}
		}
		modifier = {
			factor = 1.5
			kingdom = {
				title = k_ruathim
			}
		}
		modifier = {
			factor = 0
			ROOT = {
				has_character_flag = preparing_druchii_invasion
			}
		}
	}
}

# The Prepared Invasion CB to Conquer/Re-conquer Ulthuan (avaiable for both Druchii and Asur)
ulthuan_invasion = {
	name = CB_NAME_ULTHUAN_INVASION
	war_name = WAR_NAME_ULTHUAN_INVASION
	sprite = 8
	truce_days = 3650
	hostile_against_others = yes
	is_permanent = yes
	is_holy_war = yes
	can_ask_to_join_war = yes
	can_call_allies = yes
	battle_warscore_mult = 0.1
	# press_claim = yes
	# check_de_jure_tier = KING # this scans all de jure kingdoms for the counties which are held by or vassals(or below) of selected character. Only valid if is_permanent = yes
	# apply_short_occ_mod = no # Do not apply the 'recently_conquered'	modifier to Holdings
	can_use = {
		ROOT = {
			has_opinion_modifier = {
				who = FROM
				modifier = preparing_to_invade_elf
			}
			OR = {
				religion_group = cadai_group
				religion_group = cytharai_group
			}
			NOT = {
				religion_group = FROM
			}	# only between Asur and Druchii
		}
	}
	can_use_title = {
		wh_cb_albion_check_trigger = yes
		# 	empire = { title = e_ulthuan }
	}
	is_valid_title = {
		ROOT = {
			has_claim = PREV
		}
	}
	on_add = {
		ROOT = {
			remove_character_modifier = preparing_ulthuan_invasion
			clr_character_flag = preparing_druchii_invasion
		}
	}
	on_success = {
		ROOT = {
			add_character_modifier = {
				modifier = attempted_ulthuan_invasion
				duration = 3650
			}
			occupy_minors_of_occupied_settlements = FROM
			gain_all_occupied_titles = {
				who = FROM
				type = invasion
			}
			prestige = 500
			piety = 250
			religion_authority = {
				modifier = won_viking_invasion
			}
			hidden_tooltip = {
				if = {
					limit = {
						trait = malekith
					}
					k_nagarythe = {
						gain_title = ROOT
					}
				}
				if = {
					limit = {
						has_nickname = no
						religion = cadai
					}
					random_list = {
						50 = {
							give_nickname = nick_the_defender
						}
						50 = {
						}
					}
				}
			}
		}
		any_attacker = {
			limit = {
				character = ROOT
			}
			participation_scaled_prestige = 300
		}
		any_attacker = {
			limit = {
				NOT = {
					character = ROOT
				}
			}
			hidden_tooltip = {
				participation_scaled_prestige = 300
			}
		}
		FROM = {
			prestige = -500
		}
	}
	on_success_title = {
		usurp_title_plus_barony_if_unlanded = {
			target = ROOT
			type = claim
		}
		custom_tooltip = {
			text = tribal_invasion_succ_tip
			hidden_tooltip = {
				FROM = {
					random_realm_province = {
						limit = {
							de_jure_liege_or_above = PREVPREV
							OR = {
								NOT = {
									culture = ROOT
								}
								NOT = {
									religion = ROOT
								}
							}
						}
						culture = ROOT
						religion = ROOT
					}
				}
				ROOT = {
					clr_character_flag = preparing_druchii_invasion
					remove_opinion = {
						who = FROM
						modifier = preparing_to_invade_elf
					}
					occupy_minors_of_occupied_settlements = FROM
					gain_all_occupied_titles = {
						who = FROM
						type = invasion
					}
					vassalize_or_take_under_title_destroy_duchies = {
						title = PREV
						enemy = FROM
						type = invasion
					}
					# Settle the special invasion forces
					disband_event_forces = prepared_invasion
					any_demesne_title = {
						limit = {
							tier = BARON
						}
						remove_holding_modifier = recently_conquered
						refill_holding_levy = yes
					}
				}
				if = {
					limit = {
						FROM = {
							is_liege_or_above = ROOT
						}
					}
					FROM = {
						imprison = ROOT
					}
				}
			}
		}
	}
	on_fail = {
		FROM = {
			prestige = 200
		}
		any_defender = {
			limit = {
				character = FROM
			}
			participation_scaled_prestige = 200
		}
		any_defender = {
			limit = {
				NOT = {
					character = FROM
				}
			}
			hidden_tooltip = {
				participation_scaled_prestige = 200
			}
		}
		ROOT = {
			add_character_modifier = {
				modifier = attempted_ulthuan_invasion
				duration = 3650
			}
			clr_character_flag = preparing_druchii_invasion
			remove_opinion = {
				who = FROM
				modifier = preparing_to_invade
			}
			prestige = -300
			piety = -100
			hidden_tooltip = {
				disband_event_forces = prepared_invasion
			}
			religion_authority = {
				modifier = lost_viking_invasion
			}
		}
	}
	# on_fail_title = {
	# 	ROOT = {
	# 		remove_claim = PREV
	# 	}
	# }
	on_reverse_demand = {
		ROOT = {
			add_character_modifier = {
				modifier = attempted_ulthuan_invasion
				duration = 3650
			}
			clr_character_flag = preparing_druchii_invasion
			remove_opinion = {
				who = FROM
				modifier = preparing_to_invade
			}
			prestige = -500
			piety = -250
			transfer_scaled_wealth = {
				to = FROM
				value = 2.0
			}
			hidden_tooltip = {
				disband_event_forces = prepared_invasion
			}
			religion_authority = {
				modifier = lost_viking_invasion
			}
		}
		FROM = {
			prestige = 300
		}
		any_defender = {
			limit = {
				character = FROM
			}
			participation_scaled_prestige = 250
		}
		any_defender = {
			limit = {
				NOT = {
					character = FROM
				}
			}
			hidden_tooltip = {
				participation_scaled_prestige = 250
			}
		}
	}
	# on_reverse_demand_title = {
	# 	ROOT = {
	# 		remove_claim = PREV
	# 	}
	# }
	on_attacker_leader_death = {
		end_war = invalid
	}
	attacker_ai_victory_worth = {
		factor = 200
	}
	attacker_ai_defeat_worth = {
		factor = 100
	}
	defender_ai_victory_worth = {
		factor = -1 # always accept
	}
	defender_ai_defeat_worth = {
		factor = 100
	}
	ai_will_do = {
		factor = 0	# The AI doesn't pick it anyway, it's too scared
		# Try to guide Malekith
		modifier = {
			factor = 0
			NOT = {
				ROOT = {
					had_character_flag = {
						flag = preparing_druchii_invasion
						days = 400
					}
				}
			}				# Timer for the AI
		}
		modifier = {
			factor = 100
			ROOT = {
				had_character_flag = {
					flag = preparing_druchii_invasion
					days = 400
				}
			}				# Timer for the AI
		}
		modifier = {
			factor = 1.5
			ROOT = {
				trait = malekith
			}
		}
	}
}

# Main Asrai cb
great_wild_hunt = {
	name = CB_NAME_GREAT_WILD_HUNT
	war_name = WAR_NAME_GREAT_WILD_HUNT
	sprite = 8
	truce_days = 1825
	hostile_against_others = yes
	is_permanent = yes
	can_ask_to_join_war = yes
	can_call_allies = yes
	check_de_jure_tier = DUKE # this scans all de jure kingdoms for the counties which are held by or vassals(or below) of selected character. Only valid if is_permanent = yes
	battle_warscore_mult = 1.25
	can_use_gui = {
		month = 1
		NOT = {
			month = 8
		}
		ROOT = {
			prestige = 200
		}
	}
	on_add = {
		ROOT = {
			prestige = -200
		}
	}
	can_use = {
		ROOT = {
			NOT = {
				trait = resting
			}
			religion = asrai_cadai
			OR = {
				trait = creature_elf
				trait = creature_treekin
			}
			NOT = {
				same_realm = FROM
			}
			NOT = {
				is_liege_or_above = FROM
			}
			capital_scope = {
				empire = {
					title = e_athel_loren
				}
			}
		}
		FROM = {
			NOT = {
				religion = asrai_cadai
			}
		}
	}
	can_use_title = {
		wh_cb_albion_check_trigger = yes
		NOT = {
			region = world_underempire
		}
		# The attacker needs at least one county in the target kingdom, or a border, or be only two sea zones away from one of your counties
		any_direct_de_jure_vassal_title = {
			OR = {
				holder_scope = {
					OR = {
						character = ROOT
						is_liege_or_above = ROOT
					}
				}
				location = {
					any_neighbor_province = {
						OR = {
							AND = {
								has_owner = yes
								owner = {
									OR = {
										character = ROOT
										is_liege_or_above = ROOT
									}
								}
							}
							AND = {
								is_land = no
								any_neighbor_province = {
									OR = {
										AND = {
											has_owner = yes
											owner = {
												OR = {
													character = ROOT
													is_liege_or_above = ROOT
												}
											}
										}
										AND = {
											is_land = no
											any_neighbor_province = {
												owner = {
													OR = {
														character = ROOT
														is_liege_or_above = ROOT
													}
												}
											}
										}
									}
								}
							}
						}
					}
				}
			}
		}
	}
	is_valid = {
		ROOT = {
			NOT = {
				same_realm = FROM
			}
			OR = {
				NOT = {
					religion = FROM
				}
				is_heresy_of = FROM
				is_parent_religion = FROM
			}
			top_liege = {
				NOT = {
					religion = FROM
				}
			}
		}
	}
	on_add_title = {
	}
	on_success = {
		ROOT = {
			piety = 100
			participation_scaled_piety = 100
		}
		any_attacker = {
			limit = {
				character = ROOT
			}
			participation_scaled_prestige = 100
		}
		any_attacker = {
			limit = {
				NOT = {
					character = ROOT
				}
			}
			hidden_tooltip = {
				participation_scaled_prestige = 100
				participation_scaled_piety = 100
			}
		}
		FROM = {
			piety = -200
			prestige = -300
		}
	}
	on_fail = {
		FROM = {
			piety = 100
		}
		any_defender = {
			limit = {
				character = FROM
			}
			participation_scaled_piety = 100
			participation_scaled_prestige = 50
		}
		any_defender = {
			limit = {
				NOT = {
					character = FROM
				}
			}
			hidden_tooltip = {
				participation_scaled_piety = 100
				participation_scaled_prestige = 50
			}
		}
		ROOT = {
			piety = -150
		}
	}
	on_reverse_demand = {
		ROOT = {
			piety = -300
			transfer_scaled_wealth = {
				to = FROM
				value = 2.0
			}
		}
		FROM = {
			piety = 150
		}
		any_defender = {
			limit = {
				character = FROM
			}
			participation_scaled_prestige = 100
			participation_scaled_piety = 100
		}
		any_defender = {
			limit = {
				NOT = {
					character = FROM
				}
			}
			hidden_tooltip = {
				participation_scaled_prestige = 100
				participation_scaled_piety = 100
			}
		}
	}
	attacker_ai_victory_worth = {
		factor = 200
	}
	attacker_ai_defeat_worth = {
		factor = 100
	}
	defender_ai_victory_worth = {
		factor = -1 # always accept
	}
	defender_ai_defeat_worth = {
		factor = 100
	}
	ai_will_do = {
		factor = 1
		modifier = {
			factor = 0.5
			NOT = {
				empire = {
					title = e_bretonnia
				}
			}
		}
		modifier = {
			factor = 0
			NOT = {
				avatar_kurnous = {
					is_alive = yes
				}
			}
		}
		modifier = {
			factor = 10
			avatar_kurnous = {
				trait = lunatic_3
			}
		}
		modifier = {
			factor = 5
			ROOT = {
				trait = lunatic_3
			}
		}
	}
}

# Athel Loren reconquest
athel_loren_reconquest = {
	name = CB_NAME_ATHELLOREN_RECONQUEST
	war_name = WAR_NAME_ATHELLOREN_RECONQUEST
	sprite = 9
	truce_days = 1250
	is_permanent = yes
	is_holy_war = yes
	can_ask_to_join_war = yes
	allow_whitepeace = no
	can_call_allies = yes
	check_de_jure_tier = DUKE # this scans all dejure duchies for the counties which are held by or vassals(or below) of selected character. Only valid if is_permanent = yes
	can_use_gui = {
		ROOT = {
			piety = 5
		}
	}
	on_add = {
		ROOT = {
			piety = -5
		}
	}
	can_use = {
		FROM = {
			NOT = {
				religion = asrai_cadai
			}
		}
		ROOT = {
			NOT = {
				trait = resting
			}
			religion = asrai_cadai
			NOT = {
				same_realm = FROM
			}
			top_liege = {
				religion_group = ROOT
				NOT = {
					religion = FROM
				}
				OR = {
					religion = ROOT
					AND = {
						is_heretic = no
						ROOT = {
							is_heretic = no
						}
					}
				}
			}
		}
	}
	can_use_title = {
		wh_cb_albion_check_trigger = yes
		empire = {
			title = e_athel_loren
		}
	}
	is_valid = {
		ROOT = {
			religion = asrai_cadai
			NOT = {
				same_realm = FROM
			}
			OR = {
				trait = creature_elf
				trait = creature_treekin
			}
			top_liege = {
				NOT = {
					religion = FROM
				}
			}
		}
	}
	on_success = {
		any_attacker = {
			limit = {
				character = ROOT
			}
			participation_scaled_piety = 100
			participation_scaled_prestige = 50
		}
		any_attacker = {
			limit = {
				NOT = {
					character = ROOT
				}
			}
			hidden_tooltip = {
				participation_scaled_piety = 100
				participation_scaled_prestige = 50
			}
		}
		ROOT = {
			religion_authority = {
				modifier = won_holy_war
				years = 20
			}
		}
		FROM = {
			religion_authority = {
				modifier = lost_holy_war
				years = 20
			}
		}
		FROM = {
			piety = -100
		}
		FROM = {
			prestige = -50
		}
	}
	on_success_title = {
		custom_tooltip = {
			text = religious_cb_succ_tip
			hidden_tooltip = {
				ROOT = {
					vassalize_or_take_under_title = {
						title = PREV
						enemy = FROM
						same_religion = yes # Only vassalize rulers of my religion
						is_religious = yes
						type = holy_war
					}
				}
			}
		}
	}
	on_fail = {
		ROOT = {
			piety = -50
			prestige = -100
		}
	}
	on_reverse_demand = {
		ROOT = {
			transfer_scaled_wealth = {
				to = FROM
				value = 4.0
			}
			piety = -75
			prestige = -150
		}
		any_defender = {
			limit = {
				character = FROM
			}
			participation_scaled_piety = 200
			participation_scaled_prestige = 100
		}
		any_defender = {
			limit = {
				NOT = {
					character = FROM
				}
			}
			hidden_tooltip = {
				participation_scaled_piety = 200
				participation_scaled_prestige = 100
			}
		}
		ROOT = {
			religion_authority = {
				modifier = lost_holy_war
				years = 20
			}
		}
		FROM = {
			religion_authority = {
				modifier = won_holy_war
				years = 20
			}
		}
	}
	attacker_ai_victory_worth = {
		factor = -1 # always accept
	}
	attacker_ai_defeat_worth = {
		factor = 100
	}
	defender_ai_victory_worth = {
		factor = -1 # always accept
	}
	defender_ai_defeat_worth = {
		factor = 100
	}
	ai_will_do = {
		factor = 1
		modifier = {
			factor = 10
			ROOT = {
				trait = lunatic_3
			}
		}
		modifier = {
			factor = 10
			ROOT = {
				trait = creature_treekin
			}
		}
		modifier = {
			factor = 10
			avatar_kurnous = {
				trait = lunatic_3
			}
		}
	}
}

# Bretonnian Lords on the southern border can just declare war to take pieces of Athel Loren
bretonnian_forest_claim = {
	name = CB_NAME_FOREST_CLAIM
	war_name = WAR_NAME_FOREST_CLAIM
	sprite = 1
	truce_days = 3650
	hostile_against_others = yes
	is_permanent = yes
	check_all_titles = yes
	press_claim = yes
	can_ask_to_join_war = yes
	can_call_allies = yes
	battle_warscore_mult = 0.5	# Asrai never give up
	allow_distant = yes
	can_use = {
		ROOT = {
			religion = grail
			NOT = {
				same_realm = FROM
			}
		}
		FROM = {
			religion = asrai_cadai
		}
	}
	can_use_title = {
		tier = count
		wh_cb_albion_check_trigger = yes
		empire = {
			title = e_athel_loren
		}
		OR = {
			FROM = {
				has_landed_title = PREV
			}
			holder_scope = {
				is_liege_or_above = FROM
				NOT = {
					same_realm = ROOT
				}
			}
		}
		wh_cb_can_use_title_trigger = yes
		location = {
			any_neighbor_province = {
				owner = {
					OR = {
						character = ROOT
						is_liege_or_above = ROOT
					}
				}
			}
		}
	}
	is_valid_title = {
		ROOT = {
			religion = grail
			NOT = {
				same_realm = FROM
			}
		}
		FROM = {
			religion = asrai_cadai
		}
		wh_cb_is_valid_title_trigger = yes
	}
	on_success_title = {
		usurp_title_plus_barony_if_unlanded = {
			target = ROOT
			type = invasion
		}
		any_de_jure_vassal_title = {
			# take all baronies too
			limit = {
				has_holder = yes
				holder_scope = {
					OR = {
						character = FROM
						is_liege_or_above = FROM
						AND = {
							is_liege_or_above = ROOT
							NOT = {
								culture = ROOT
							}
							NOT = {
								religion = ROOT
							}
						}
					}
				}
			}
			usurp_title = ROOT
		}
		any_attacker = {
			limit = {
				character = ROOT
			}
			participation_scaled_prestige = 100
			participation_scaled_piety = 50
		}
		any_attacker = {
			limit = {
				NOT = {
					character = ROOT
				}
			}
			hidden_tooltip = {
				participation_scaled_prestige = 100
				participation_scaled_piety = 50
			}
		}
		ROOT = {
			religion_authority = {
				modifier = won_county_conquest
			}
		}
	}
	on_fail_title = {
		ROOT = {
			prestige = -100
			religion_authority = {
				modifier = lost_county_conquest
			}
		}
		any_defender = {
			limit = {
				character = FROM
			}
			participation_scaled_prestige = 50
		}
		any_defender = {
			limit = {
				NOT = {
					character = FROM
				}
			}
			hidden_tooltip = {
				participation_scaled_prestige = 50
			}
		}
	}
	on_reverse_demand = {
		ROOT = {
			prestige = -200
			transfer_scaled_wealth = {
				to = FROM
				value = 4.0
			}
			religion_authority = {
				modifier = lost_county_conquest
			}
		}
		any_defender = {
			limit = {
				character = FROM
			}
			participation_scaled_prestige = 100
			participation_scaled_piety = 50
		}
		any_defender = {
			limit = {
				NOT = {
					character = FROM
				}
			}
			hidden_tooltip = {
				participation_scaled_prestige = 100
				participation_scaled_piety = 50
			}
		}
	}
	attacker_ai_victory_worth = {
		factor = -1 # always accept
	}
	attacker_ai_defeat_worth = {
		factor = 100
	}
	defender_ai_victory_worth = {
		factor = -1 # always accept
	}
	defender_ai_defeat_worth = {
		factor = 100
	}
}

# Dwarf Reconquest
dwarven_reconquest = {
	name = CB_NAME_DWARF_COUNTY_RECONQUEST
	war_name = WAR_NAME_DWARF_COUNTY_RECONQUEST
	sprite = 16
	truce_days = 1825
	hostile_against_others = yes
	is_permanent = yes
	check_all_titles = yes
	press_claim = yes
	can_ask_to_join_war = yes
	allow_whitepeace = no
	can_call_allies = yes
	can_use_gui = {
		ROOT = {
			piety = 50
		}
	}
	on_add = {
		ROOT = {
			piety = -50
		}
	}
	can_use = {
		ROOT = {
			NOT = {
				is_liege_or_above = FROM
			}
			religion_group = dwarf_gods_group
		}
		FROM = {
			not = {
				religion_group = dwarf_gods_group
			}
		}
	}
	can_use_title = {
		tier = count
		wh_cb_albion_check_trigger = yes
		NOT = {
			region = world_underempire
		}
		OR = {
			FROM = {
				has_landed_title = PREV
			}
			holder_scope = {
				is_liege_or_above = FROM
				NOT = {
					same_realm = ROOT
				}
			}
		}
		wh_cb_can_use_title_trigger = yes
		location = {
			or = {
				terrain = mountain
				#terrain = mountain_pass
				region = world_karaz_ankor
			}
			or = {
				root = {
					tier = emperor
				}
				any_neighbor_province = {
					owner = {
						OR = {
							character = ROOT
							is_liege_or_above = ROOT
						}
					}
				}
			}
		}
	}
	is_valid_title = {
		wh_cb_is_valid_title_trigger = yes
	}
	on_success = {
		FROM = {
			if = {
				limit = {
					religion_group = greenskin_gods_group
				}
				any_realm_province = {
					limit = {
						controlled_by = ROOT
						religion_group = greenskin_gods_group
					}
					add_province_modifier = {
						name = greenskin_population_bad
						duration = -1
					}
				}
			}
		}
	}
	on_success_title = {
		usurp_title_plus_barony_if_unlanded = {
			target = ROOT
			type = invasion
		}
		any_de_jure_vassal_title = {
			limit = {
				has_holder = yes
			}
			if = {
				limit = {
					holder_scope = {
						not = {
							religion_group = dwarf_gods_group
						}
					}
				}
				usurp_title_plus_barony_if_unlanded = {
					target = ROOT
					type = invasion
				}
				# need else
			}
		}
		any_attacker = {
			limit = {
				character = ROOT
			}
			participation_scaled_prestige = 100
		}
		any_attacker = {
			limit = {
				NOT = {
					character = ROOT
				}
			}
			hidden_tooltip = {
				participation_scaled_prestige = 100
			}
		}
	}
	on_fail_title = {
		ROOT = {
			prestige = -100
		}
		any_defender = {
			limit = {
				character = FROM
			}
			participation_scaled_prestige = 50
		}
		any_defender = {
			limit = {
				NOT = {
					character = FROM
				}
			}
			hidden_tooltip = {
				participation_scaled_prestige = 50
			}
		}
	}
	on_reverse_demand = {
		ROOT = {
			prestige = -200
			transfer_scaled_wealth = {
				to = FROM
				value = 4.0
			}
		}
		any_defender = {
			limit = {
				character = FROM
			}
			participation_scaled_prestige = 100
		}
		any_defender = {
			limit = {
				NOT = {
					character = FROM
				}
			}
			hidden_tooltip = {
				participation_scaled_prestige = 100
			}
		}
	}
	attacker_ai_victory_worth = {
		factor = -1 # always accept
	}
	attacker_ai_defeat_worth = {
		factor = 100
	}
	defender_ai_victory_worth = {
		factor = -1 # always accept
	}
	defender_ai_defeat_worth = {
		factor = 100
	}
}

# Grudge settling
settle_grudge = {
	name = CB_NAME_GRUDGE_WAR
	war_name = WAR_NAME_GRUDGE_WAR # $ORDER$$FIRST$ grudge war against $SECOND$
	sprite = 12
	truce_days = 1825
	is_permanent = yes
	allowed_to_target_tributaries = no
	allowed_to_target_suzerains = no
	allow_distant = yes # AI parameter
	infamy_modifier = 0
	can_ask_to_join_war = yes
	allow_whitepeace = no
	can_call_allies = yes
	can_use = {
		# Can be used if ROOT has any grudge against FROM or FROM is an orc, a goblin, a skaven or an elf
		ROOT = {
			religion_group = dwarf_gods_group
			trait = creature_dwarf
		}
		NOT = {
			FROM = {
				has_opinion_modifier = {
					who = ROOT
					modifier = opinion_grudge_war_oooldown
				}
			}
		}
		OR = {
			FROM = {
				reverse_has_opinion_modifier = {
					who = ROOT
					modifier = opinion_dwarf_grudge
				}
			}
			FROM = {
				any_vassal = {
					reverse_has_opinion_modifier = {
						who = ROOT
						modifier = opinion_dwarf_grudge
					}
				}
			}
			FROM = {
				# If FROM is orc, goblin, skaven or chaos dwarf, ROOT needs a direct land border or be 2 water provinces away
				OR = {
					trait = creature_orc
					trait = creature_goblin
					trait = creature_skaven
					trait = creature_chaos_dwarf
				}
				any_realm_province = {
					any_neighbor_province = {
						OR = {
							AND = {
								has_owner = yes
								owner = {
									OR = {
										character = ROOT
										is_liege_or_above = ROOT
									}
								}
							}
							AND = {
								is_land = no
								any_neighbor_province = {
									OR = {
										AND = {
											has_owner = yes
											owner = {
												OR = {
													character = ROOT
													is_liege_or_above = ROOT
												}
											}
										}
										AND = {
											is_land = no
											any_neighbor_province = {
												owner = {
													OR = {
														character = ROOT
														is_liege_or_above = ROOT
													}
												}
											}
										}
									}
								}
							}
						}
					}
				}
			}
		}
		FROM = {
			prisoner = no
		}
	}
	is_valid = {
		OR = {
			FROM = {
				reverse_has_opinion_modifier = {
					who = ROOT
					modifier = opinion_dwarf_grudge
				}
			}
			FROM = {
				any_vassal = {
					reverse_has_opinion_modifier = {
						who = ROOT
						modifier = opinion_dwarf_grudge
					}
				}
			}
			FROM = {
				trait = creature_orc
			}
			FROM = {
				trait = creature_goblin
			}
			FROM = {
				trait = creature_skaven
			}
			FROM = {
				trait = creature_chaos_dwarf
			}
		}
	}
	# on_add = {
	# hidden_tooltip = {
	# }
	# }
	on_success = {
		custom_tooltip = {
			text = TOOLTIPGRUDGEWARVICTORY
		}
		ROOT = {
			# Frist take any claims and de-jure claims
			any_claim = {
				limit = {
					holder_scope = {
						OR = {
							character = FROM
							is_liege_or_above = FROM
						}
					}
					ROOT = {
						has_claim = PREV
					}
				}
				usurp_title_plus_barony_if_unlanded = {
					target = ROOT
					type = claim
				}
				if = {
					limit = {
						higher_tier_than = BARON
						NOT = {
							culture = ROOT
						}
					}
					hidden_tooltip = {
						conquest_culture = ROOT
					}
				}
			}
			FROM = {
				any_demesne_title = {
					limit = {
						dejure_liege_title = {
							holder = ROOT
						}
					}
					usurp_title_plus_barony_if_unlanded = {
						target = ROOT
						type = claim
					}
				}
				any_realm_lord = {
					any_demesne_title = {
						limit = {
							dejure_liege_title = {
								holder = ROOT
							}
						}
						usurp_title_plus_barony_if_unlanded = {
							target = ROOT
							type = claim
						}
					}
				}
			}
		}
		FROM = {
			# Set cooldown
			if = {
				limit = {
					NOT = {
						reverse_has_opinion_modifier = {
							who = ROOT
							modifier = opinion_dwarf_grudge
						}
					}
					OR = {
						trait = creature_orc
						trait = creature_goblin
						trait = creature_skaven
						trait = creature_chaos_dwarf
					}
				}
				current_heir = {
					opinion = {
						modifier = opinion_grudge_war_oooldown
						who = ROOT
						years = 5
					}
				}
			}
		}
		FROM = {
			if = {
				# If Grudge against FROM demand compensation from loser
				limit = {
					reverse_has_opinion_modifier = {
						who = ROOT
						modifier = opinion_dwarf_grudge
					}
				}
				# imprison = ROOT
				ROOT = {
					character_event = {
						id = DR_dwarfs.6
					}
				}
				# REMEMBER TO CALL EVENT FROM HERE
			}
			if = {
				# If Grudge against vassal demand compensation from the vassal
				limit = {
					any_vassal = {
						reverse_has_opinion_modifier = {
							who = ROOT
							modifier = opinion_dwarf_grudge
						}
					}
				}
				# imprison = ROOT
				any_vassal = {
					limit = {
						reverse_has_opinion_modifier = {
							who = ROOT
							modifier = opinion_dwarf_grudge
						}
					}
					character_event = {
						id = DR_dwarfs.58
					}
				}
				# REMEMBER TO CALL EVENT FROM HERE
			}
			if = {
				# If Orc, Goblin, Skaven or Chaos Dwarf, execute and piety boost
				limit = {
					NOT = {
						reverse_has_opinion_modifier = {
							who = ROOT
							modifier = opinion_dwarf_grudge
						}
					}
					OR = {
						trait = creature_orc
						trait = creature_goblin
						trait = creature_skaven
						trait = creature_chaos_dwarf
					}
				}
				death = {
					death_reason = death_execution
					killer = ROOT
				}
				piety = 150
			}
		}
		any_attacker = {
			limit = {
				character = ROOT
			}
			participation_scaled_prestige = 100
		}
		any_attacker = {
			limit = {
				NOT = {
					character = ROOT
				}
			}
			hidden_tooltip = {
				participation_scaled_prestige = 100
			}
		}
		hidden_tooltip = {
			ROOT = {
				remove_opinion = {
					who = FROM
					modifier = looting_vengeance_war
				}
			}
		}
	}
	on_fail = {
		ROOT = {
			piety = -200
		}
		any_defender = {
			limit = {
				character = FROM
			}
			participation_scaled_prestige = 50
		}
		any_defender = {
			limit = {
				NOT = {
					character = FROM
				}
			}
			hidden_tooltip = {
				participation_scaled_prestige = 50
			}
		}
	}
	on_reverse_demand = {
		ROOT = {
			imprison = FROM
			transfer_scaled_wealth = {
				to = FROM
				value = 4.0
			}
			any_claim = {
				limit = {
					holder_scope = {
						OR = {
							character = FROM
							is_liege_or_above = FROM
						}
					}
				}
				remove_claim = ROOT
			}
			ROOT = {
				piety = -300
			}
		}
		any_defender = {
			limit = {
				character = FROM
			}
			participation_scaled_prestige = 100
		}
		any_defender = {
			limit = {
				NOT = {
					character = FROM
				}
			}
			hidden_tooltip = {
				participation_scaled_prestige = 100
			}
		}
	}
	attacker_ai_victory_worth = {
		factor = -1 # always accept
	}
	attacker_ai_defeat_worth = {
		factor = 100
	}
	defender_ai_victory_worth = {
		factor = -1 # always accept
	}
	defender_ai_defeat_worth = {
		factor = 100
	}
	#
	ai_will_do = {
		factor = 1
	}
}

# Overthrow Oathbreaker
oathbreaker_ruler = {
	name = CB_NAME_DWARF_OATHBREAKER_RULER
	war_name = WAR_NAME_OATHBREAKER_RULER
	sprite = 11
	truce_days = 3650
	is_permanent = yes
	can_ask_to_join_war = no
	allowed_to_target_tributaries = no
	allowed_to_target_suzerains = no
	can_use = {
		FROM = {
			religion_group = dwarf_gods_group
			trait = creature_dwarf
			trait = dwarf_oathbreaker
			in_revolt = no
			NOT = {
				any_current_enemy = {
					NOT = {
						religion_group = ROOT
					}
				}
			}
		}
		ROOT = {
			mercenary = no
			religion_group = dwarf_gods_group
			trait = creature_dwarf
		}
	}
	is_valid = {
		FROM = {
			trait = dwarf_oathbreaker
		}
	}
	on_success = {
		ROOT = {
			if = {
				limit = {
					FROM = {
						primary_title = {
							tier = BARON
						}
					}
				}
				ROOT = {
					piety = 50
					prestige = 10
				}
			}
			if = {
				limit = {
					FROM = {
						primary_title = {
							tier = COUNT
						}
					}
				}
				ROOT = {
					piety = 100
					prestige = 20
				}
			}
			if = {
				limit = {
					FROM = {
						primary_title = {
							tier = DUKE
						}
					}
				}
				ROOT = {
					piety = 150
					prestige = 30
				}
			}
			if = {
				limit = {
					FROM = {
						primary_title = {
							tier = KING
						}
					}
				}
				ROOT = {
					piety = 200
					prestige = 50
				}
			}
			if = {
				limit = {
					FROM = {
						primary_title = {
							tier = EMPEROR
						}
					}
				}
				ROOT = {
					piety = 400
					prestige = 70
				}
			}
		}
		FROM = {
			prestige = -200
			abdicate = yes
			imprison = ROOT
		}
	}
	on_fail = {
		ROOT = {
			piety = -50
			prestige = -100
		}
	}
	on_reverse_demand = {
		ROOT = {
			piety = -100
			prestige = -200
			transfer_scaled_wealth = {
				to = FROM
				value = 4.0
			}
		}
		FROM = {
			prestige = 200
			piety = 100
		}
	}
	attacker_ai_victory_worth = {
		factor = -1 # always accept
	}
	attacker_ai_defeat_worth = {
		factor = 100
	}
	defender_ai_victory_worth = {
		factor = -1 # always accept
	}
	defender_ai_defeat_worth = {
		factor = 100
	}
}

crusade = {
	name = CB_NAME_CRUSADE
	war_name = WAR_NAME_CRUSADE
	sprite = 9
	truce_days = 3650
	is_permanent = yes
	is_holy_war = yes
	battle_warscore_mult = 0.5
	check_de_jure_tier = KING # this scans all de jure kingdoms for the counties which are held by or vassals(or below) of selected character. Only valid if is_permanent = yes
	allowed_to_target_tributaries = no
	allowed_to_target_suzerains = no
	can_ask_to_join_war = yes
	allow_whitepeace = no
	can_call_allies = yes
	can_use_gui = {
		ROOT = {
			has_called_crusade = no
			religion_authority = 0.05
			religion = grail
			custom_tooltip = {
				text = CTT_PAGAN_GHWS_UNLOCKED
				has_global_flag = grail_crusades_unlocked
			}
			mercenary = no
		}
	}
	can_use = {
		ROOT = {
			can_call_crusade = yes
		}
		FROM = {
			OR = {
				NOT = {
					religion_group = ROOT
				}
				is_heresy_of = ROOT
				is_parent_religion = ROOT
			}
		}
	}
	can_use_title = {
		wh_cb_albion_check_trigger = yes
		NOT = {
			region = world_underempire
		}
		FROM = {
			any_realm_title = {
				de_jure_liege_or_above = PREVPREV
			}
			independent = yes # Don't declare Crusades on revolters - chances are high the war will invalidate
			num_of_realm_counties = {
				value = 6
				title = PREV
			}
		}
	}
	is_valid = {
		ROOT = {
			can_call_crusade = yes
		}
		FROM = {
			OR = {
				NOT = {
					religion_group = ROOT
				}
				is_heresy_of = ROOT
				is_parent_religion = ROOT
			}
		}
	}
	is_valid_title = {
		FROM = {
			any_realm_title = {
				de_jure_liege_or_above = PREVPREV
			}
		}
	}
	on_success_title = {
		# Should we give the seized land to its current king?
		if = {
			limit = {
				has_holder = yes
				holder_scope = {
					religion = ROOT
				}
			}
			holder_scope = {
				gain_settlements_under_title = {
					title = PREV
					enemy = FROM
					is_crusade = yes # Even if the title holder is not participating in the war, gain holdings occupied by all Crusade participants
					type = holy_war
				}
			}
		}
		# Should we give the seized land to a claimant of our faith?
		if = {
			limit = {
				OR = {
					has_holder = no
					holder_scope = {
						NOT = {
							religion = ROOT
						}
					}
				}
				best_crusade_claimant = {
					always = yes # There is a "best" claimant
				}
			}
			# Claimants must be of ROOT's religion, and are ranked by strength of claim and actual contribution to the war
			best_crusade_claimant = {
				gain_settlements_under_title = {
					title = PREV
					enemy = FROM
					is_crusade = yes # Even if the title holder is not participating in the war, gain holdings occupied by all Crusade participants
					type = holy_war
				}
				if = {
					limit = {
						top_liege = {
							character = FROM
						}
					}
					set_defacto_liege = THIS
				}
				if = {
					limit = {
						PREV = {
							OR = {
								has_holder = no
								holder_scope = {
									top_liege = {
										character = FROM
									}
								}
							}
						}
						OR = {
							independent = yes
							is_ruler = no
							liege = {
								tier = EMPEROR
							}
						}
					}
					usurp_title = {
						target = PREV
						type = holy_war
					}
				}
			}
		}
		# Give the seized land to the main contributor of the Crusade
		if = {
			limit = {
				OR = {
					has_holder = no
					NOT = {
						holder_scope = {
							religion = ROOT
						}
					}
				}
				NOT = {
					best_crusade_claimant = {
						always = yes
					}
				}
			}
			most_participating_crusader = {
				gain_settlements_under_title = {
					title = PREV
					enemy = FROM
					type = holy_war
				}
				if = {
					limit = {
						primary_title = {
							is_primary_type_title = no
						} # Mercs, the Pope, Holy Orders, etc
						PREV = {
							OR = {
								has_holder = no
								holder_scope = {
									top_liege = {
										character = FROM
									}
								}
							}
						}
						NOT = {
							character = ROOT
						}
						OR = {
							independent = yes
							liege = {
								tier = EMPEROR
							}
						}
					}
					usurp_title_only = {
						target = PREV
						type = holy_war
					}
					if = {
						limit = {
							NOT = {
								culture = PREV
							}
						}
						hidden_tooltip = {
							save_event_target_as = winning_crusader
							PREV = {
								conquest_culture = event_target:winning_crusader
							}
						}
					}
				}
				hidden_tooltip = {
					if = {
						limit = {
							has_nickname = no
						}
						random_list = {
							10 = {
								give_nickname = nick_the_crusader
							}
							10 = {
								give_nickname = nick_the_holy
							}
							10 = {
								give_nickname = nick_the_glorious
							}
							10 = {
								give_nickname = nick_the_lionheart
							}
							10 = {
								give_nickname = nick_the_great
							}
							10 = {
								give_nickname = nick_the_hammer
							}
							10 = {
								give_nickname = nick_the_pilgrim
							}
							40 = {
								modifier = {
									factor = 0
									religion = grail
								}
								give_nickname = nick_the_sword_of_god
							}
						}
					}
				}
			}
		}
		any_attacker = {
			limit = {
				character = ROOT
			}
			participation_scaled_prestige = 500
			participation_scaled_piety = 1000
			if = {
				limit = {
					uses_decadence = yes
				}
				participation_scaled_decadence = -100
			}
		}
		any_attacker = {
			limit = {
				NOT = {
					character = ROOT
				}
			}
			hidden_tooltip = {
				participation_scaled_prestige = 500
				participation_scaled_piety = 1000
				if = {
					limit = {
						uses_decadence = yes
					}
					participation_scaled_decadence = -100
				}
			}
		}
		any_attacker = {
			limit = {
				ai = no
				NOT = {
					has_character_flag = achievement_crusader
				}
			}
			set_character_flag = achievement_crusader
		}
		ROOT = {
			religion_authority = {
				modifier = won_crusade
				years = 20
			}
		}
		FROM = {
			piety = -100
			religion_authority = {
				modifier = lost_crusade
				years = 20
			}
		}
	}
	on_fail = {
		ROOT = {
			piety = -100
		}
		any_defender = {
			limit = {
				character = FROM
			}
			participation_scaled_piety = 200
			participation_scaled_prestige = 100
			if = {
				limit = {
					uses_decadence = yes
				}
				participation_scaled_decadence = -50
			}
		}
		any_defender = {
			limit = {
				NOT = {
					character = FROM
				}
			}
			hidden_tooltip = {
				participation_scaled_piety = 200
				participation_scaled_prestige = 100
				if = {
					limit = {
						uses_decadence = yes
					}
					participation_scaled_decadence = -50
				}
			}
		}
		FROM = {
			# if = {
			# limit = {
			# has_dlc = "Legacy of Rome"
			# OR = {
			# has_landed_title = e_byzantium
			# has_landed_title = e_roman_empire
			# }
			# religion_group = christian
			# }
			# hidden_tooltip = { character_event = { id = LoR.30 days = 12 } }
			# }
			hidden_tooltip = {
				if = {
					limit = {
						has_nickname = no
					}
					random_list = {
						10 = {
							give_nickname = nick_the_holy
						}
						10 = {
							give_nickname = nick_the_glorious
						}
						10 = {
							give_nickname = nick_the_lionheart
						}
						10 = {
							give_nickname = nick_the_great
						}
						10 = {
							give_nickname = nick_the_hammer
						}
						20 = {
							give_nickname = nick_the_sword_of_god
						}
					}
				}
			}
		}
	}
	on_reverse_demand = {
		ROOT = {
			piety = -200
			religion_authority = {
				modifier = lost_crusade
				years = 20
			}
		}
		FROM = {
			piety = 100
			religion_authority = {
				modifier = won_crusade
				years = 20
			}
		}
		any_defender = {
			limit = {
				character = FROM
			}
			participation_scaled_piety = 300
			participation_scaled_prestige = 150
			if = {
				limit = {
					uses_decadence = yes
				}
				participation_scaled_decadence = -100
			}
		}
		FROM = {
			hidden_tooltip = {
				if = {
					limit = {
						has_nickname = no
					}
					random_list = {
						10 = {
							give_nickname = nick_the_holy
						}
						10 = {
							give_nickname = nick_the_glorious
						}
						10 = {
							give_nickname = nick_the_lionheart
						}
						10 = {
							give_nickname = nick_the_great
						}
						10 = {
							give_nickname = nick_the_hammer
						}
						20 = {
							give_nickname = nick_the_sword_of_god
						}
					}
				}
			}
		}
		any_defender = {
			limit = {
				NOT = {
					character = FROM
				}
			}
			hidden_tooltip = {
				participation_scaled_piety = 300
				participation_scaled_prestige = 150
				if = {
					limit = {
						uses_decadence = yes
					}
					participation_scaled_decadence = -100
				}
			}
		}
	}
	attacker_ai_victory_worth = {
		factor = -1 # always accept
	}
	attacker_ai_defeat_worth = {
		factor = 100
	}
	defender_ai_victory_worth = {
		factor = -1 # always accept
	}
	defender_ai_defeat_worth = {
		factor = 100
	}
}

# Chaos
chaos_subjugation = {
	name = CB_NAME_CHAOS_SUBJUGATION
	war_name = WAR_NAME_CHAOS_SUBJUGATION
	sprite = 30
	truce_days = 180 # was 365
	hostile_against_others = yes
	is_permanent = yes
	can_ask_to_join_war = yes
	allow_whitepeace = no
	can_call_allies = yes
	check_de_jure_tier = KING # this scans all de jure kingdoms for the counties which are held by or vassals(or below) of selected character. Only valid if is_permanent = yes
	can_use = {
		# DOOM_COUNTER is too big time for a invasion
		NOT = {
			has_global_flag = doom_very_high
		}
		# regular conditions
		ROOT = {
			is_within_diplo_range = FROM
			religion_group = chaos_gods_group
			nor = {
				religion = hashut
				trait = creature_beastman
				same_realm = FROM
				is_liege_or_above = FROM
			}
		}
		FROM = {
			religion_group = chaos_gods_group
			nor = {
				religion = hashut
				any_war = {
					defender = {
						character = FROM
					}
					using_cb = chaos_subjugation
				}
			}
		}
	}
	can_use_title = {
		wh_cb_albion_check_trigger = yes
		# our victim should be a chaos lord
		NOT = {
			region = world_underempire
		}
		FROM = {
			any_realm_title = {
				de_jure_liege_or_above = PREVPREV
			}
		}
	}
	is_valid_title = {
		FROM = {
			any_realm_title = {
				de_jure_liege_or_above = PREVPREV
			}
		}
	}
	on_success = {
		ROOT = {
			piety = 100
			if = {
				limit = {
					religion = tzeentch
				}
				change_variable = {
					which = "tzeentch_favor"
					value = 1
				}
			}
			if = {
				limit = {
					religion = slaanesh
				}
				change_variable = {
					which = "slaanesh_favor"
					value = 1
				}
			}
			if = {
				limit = {
					religion = khorne
				}
				change_variable = {
					which = "khorne_favor"
					value = 1
				}
			}
			if = {
				limit = {
					religion = nurgle
				}
				change_variable = {
					which = "nurgle_favor"
					value = 1
				}
			}
			hidden_tooltip = {
				any_courtier = {
	 				piety = 100
					if = {
						limit = {
							religion = tzeentch
						}
						change_variable = {
							which = "tzeentch_favor"
							value = 1
						}
					}
					if = {
						limit = {
							religion = slaanesh
						}
						change_variable = {
							which = "slaanesh_favor"
							value = 1
						}
					}
					if = {
						limit = {
							religion = khorne
						}
						change_variable = {
							which = "khorne_favor"
							value = 1
						}
					}
					if = {
						limit = {
							religion = nurgle
						}
						change_variable = {
							which = "nurgle_favor"
							value = 1
						}
					}
				}
			}
		}
		any_attacker = {
			limit = {
				character = ROOT
			}
			participation_scaled_prestige = 100
		}
		any_attacker = {
			limit = {
				NOT = {
					character = ROOT
				}
			}
			hidden_tooltip = {
				participation_scaled_prestige = 100
			}
		}
		FROM = {
			piety = -100
			prestige = -100
			hidden_tooltip = {
				if = {
					limit = {
						religion = tzeentch
					}
					change_variable = {
						which = "tzeentch_favor"
						value = -2
					}
				}
				if = {
					limit = {
						religion = slaanesh
					}
					change_variable = {
						which = "slaanesh_favor"
						value = -2
					}
				}
				if = {
					limit = {
						religion = khorne
					}
					change_variable = {
						which = "khorne_favor"
						value = -2
					}
				}
				if = {
					limit = {
						religion = nurgle
					}
					change_variable = {
						which = "nurgle_favor"
						value = -2
					}
				}
			}
		}
		# DOOM_COUNTER - raise
	}
	on_success_title = {
		# Usurp the target kingdom itself, if the enemy holds it
		if = {
			limit = {
				holder_scope = {
					character = FROM
				}
				NOT = {
					ROOT = {
						tier = EMPEROR
					}
				}
			}
			ROOT = {
				usurp_title = PREV
			}
		}
		if = {
			# Take the enemy's duchies within the target kingdom, if we are the same or lower tier
			limit = {
				ROOT = {
					NOT = {
						higher_tier_than = FROM
					}
				}
			}
			FROM = {
				any_demesne_title = {
					limit = {
						tier = DUKE
						OR = {
							title = PREVPREV
							de_jure_liege_or_above = PREVPREV
						}
					}
					ROOT = {
						usurp_title = PREV
					}
				}
			}
		}
		# Have I become the vassal of the loser due to taking a duchy or kingdom?
		if = {
			limit = {
				ROOT = {
					is_liege_or_above = FROM
				}
			}
			ROOT = {
				set_defacto_liege = ROOT
			}
		}
		# Vassalize the rest
		custom_tooltip = {
			text = pagan_subjugation_tip
			hidden_tooltip = {
				ROOT = {
					subjugate_or_take_under_title = {
						# If the target only has territory within the kingdom, he is simply vassalized
						title = PREV
						enemy = FROM
					}
				}
			}
		}
	}
	on_fail = {
		FROM = {
			piety = 50
			if = {
				limit = {
					religion = tzeentch
				}
				change_variable = {
					which = "tzeentch_favor"
					value = 1
				}
			}
			if = {
				limit = {
					religion = slaanesh
				}
				change_variable = {
					which = "slaanesh_favor"
					value = 1
				}
			}
			if = {
				limit = {
					religion = khorne
				}
				change_variable = {
					which = "khorne_favor"
					value = 1
				}
			}
			if = {
				limit = {
					religion = nurgle
				}
				change_variable = {
					which = "nurgle_favor"
					value = 1
				}
			}
			hidden_tooltip = {
				any_courtier = {
	 				piety = 100
					if = {
						limit = {
							religion = tzeentch
						}
						change_variable = {
							which = "tzeentch_favor"
							value = 1
						}
					}
					if = {
						limit = {
							religion = slaanesh
						}
						change_variable = {
							which = "slaanesh_favor"
							value = 1
						}
					}
					if = {
						limit = {
							religion = khorne
						}
						change_variable = {
							which = "khorne_favor"
							value = 1
						}
					}
					if = {
						limit = {
							religion = nurgle
						}
						change_variable = {
							which = "nurgle_favor"
							value = 1
						}
					}
				}
			}
		}
		any_defender = {
			limit = {
				character = FROM
			}
			participation_scaled_prestige = 50
		}
		any_defender = {
			limit = {
				NOT = {
					character = FROM
				}
			}
			hidden_tooltip = {
				participation_scaled_prestige = 50
			}
		}
		ROOT = {
			piety = -100
			hidden_tooltip = {
				if = {
					limit = {
						religion = tzeentch
					}
					change_variable = {
						which = "tzeentch_favor"
						value = -2
					}
				}
				if = {
					limit = {
						religion = slaanesh
					}
					change_variable = {
						which = "slaanesh_favor"
						value = -2
					}
				}
				if = {
					limit = {
						religion = khorne
					}
					change_variable = {
						which = "khorne_favor"
						value = -2
					}
				}
				if = {
					limit = {
						religion = nurgle
					}
					change_variable = {
						which = "nurgle_favor"
						value = -2
					}
				}
			}
		}
	}
	on_reverse_demand = {
		ROOT = {
			piety = -200
			if = {
				limit = {
					religion = tzeentch
				}
				change_variable = {
					which = "tzeentch_favor"
					value = -2
				}
			}
			if = {
				limit = {
					religion = slaanesh
				}
				change_variable = {
					which = "slaanesh_favor"
					value = -2
				}
			}
			if = {
				limit = {
					religion = khorne
				}
				change_variable = {
					which = "khorne_favor"
					value = -2
				}
			}
			if = {
				limit = {
					religion = nurgle
				}
				change_variable = {
					which = "nurgle_favor"
					value = -2
				}
			}
			transfer_scaled_wealth = {
				to = FROM
				value = 2.0
			}
		}
		FROM = {
			piety = 100
			if = {
				limit = {
					religion = tzeentch
				}
				change_variable = {
					which = "tzeentch_favor"
					value = 1
				}
			}
			if = {
				limit = {
					religion = slaanesh
				}
				change_variable = {
					which = "slaanesh_favor"
					value = 1
				}
			}
			if = {
				limit = {
					religion = khorne
				}
				change_variable = {
					which = "khorne_favor"
					value = 1
				}
			}
			if = {
				limit = {
					religion = nurgle
				}
				change_variable = {
					which = "nurgle_favor"
					value = 1
				}
			}
			hidden_tooltip = {
				any_courtier = {
	 				piety = 100
					if = {
						limit = {
							religion = tzeentch
						}
						change_variable = {
							which = "tzeentch_favor"
							value = 1
						}
					}
					if = {
						limit = {
							religion = slaanesh
						}
						change_variable = {
							which = "slaanesh_favor"
							value = 1
						}
					}
					if = {
						limit = {
							religion = khorne
						}
						change_variable = {
							which = "khorne_favor"
							value = 1
						}
					}
					if = {
						limit = {
							religion = nurgle
						}
						change_variable = {
							which = "nurgle_favor"
							value = 1
						}
					}
				}
			}
		}
		any_defender = {
			limit = {
				character = FROM
			}
			participation_scaled_prestige = 100
		}
		any_defender = {
			limit = {
				NOT = {
					character = FROM
				}
			}
			hidden_tooltip = {
				participation_scaled_prestige = 100
			}
		}
	}
	attacker_ai_victory_worth = {
		factor = 200
	}
	attacker_ai_defeat_worth = {
		factor = 100
	}
	defender_ai_victory_worth = {
		factor = -1 # always accept
	}
	defender_ai_defeat_worth = {
		factor = 100
	}
	ai_will_do = {
		factor = 1
		modifier = {
			factor = 1.5
			holder_scope = {
				# OR = {
				# has_landed_title = e_host_nurgle
				# has_landed_title = e_host_khorne
				# has_landed_title = e_host_slaanesh
				# has_landed_title = e_host_tzeentch
				has_landed_title = e_host_chaos
				# }
			}
		}
		modifier = {
			factor = 0.3
			has_global_flag = doom_high
		}
	}
}

# Subjugate anything on your path.
daemonic_subjugation = {
	name = CB_NAME_PRINCE_SUBJUGATION
	war_name = WAR_NAME_PRINCE_SUBJUGATION
	sprite = 30
	truce_days = 120 # was 365
	hostile_against_others = yes
	is_permanent = yes
	can_ask_to_join_war = yes
	allow_whitepeace = no
	can_call_allies = yes
	check_de_jure_tier = KING # this scans all de jure kingdoms for the counties which are held by or vassals(or below) of selected character. Only valid if is_permanent = yes
	can_use = {
		# regular conditions
		ROOT = {
			is_within_diplo_range = FROM
			religion_group = chaos_gods_group
			OR = {
				trait = prince_khorne
				trait = prince_nurgle
				trait = prince_slaanesh
				trait = prince_tzeentch
			}
			NOT = {
				same_realm = FROM
			}
			NOT = {
				is_liege_or_above = FROM
			}
		}
	}
	can_use_title = {
		wh_cb_albion_check_trigger = yes
		NOT = {
			region = world_underempire
		}
		FROM = {
			any_realm_title = {
				de_jure_liege_or_above = PREVPREV
			}
		}
	}
	is_valid_title = {
		FROM = {
			any_realm_title = {
				de_jure_liege_or_above = PREVPREV
			}
		}
	}
	on_success = {
		ROOT = {
			piety = 100
			if = {
				limit = {
					religion = tzeentch
				}
				change_variable = {
					which = "tzeentch_favor"
					value = 1
				}
			}
			if = {
				limit = {
					religion = slaanesh
				}
				change_variable = {
					which = "slaanesh_favor"
					value = 1
				}
			}
			if = {
				limit = {
					religion = khorne
				}
				change_variable = {
					which = "khorne_favor"
					value = 1
				}
			}
			if = {
				limit = {
					religion = nurgle
				}
				change_variable = {
					which = "nurgle_favor"
					value = 1
				}
			}
			hidden_tooltip = {
				any_courtier = {
	 				piety = 100
					if = {
						limit = {
							religion = tzeentch
						}
						change_variable = {
							which = "tzeentch_favor"
							value = 1
						}
					}
					if = {
						limit = {
							religion = slaanesh
						}
						change_variable = {
							which = "slaanesh_favor"
							value = 1
						}
					}
					if = {
						limit = {
							religion = khorne
						}
						change_variable = {
							which = "khorne_favor"
							value = 1
						}
					}
					if = {
						limit = {
							religion = nurgle
						}
						change_variable = {
							which = "nurgle_favor"
							value = 1
						}
					}
				}
			}
		}
		any_attacker = {
			limit = {
				character = ROOT
			}
			participation_scaled_prestige = 100
		}
		any_attacker = {
			limit = {
				NOT = {
					character = ROOT
				}
			}
			hidden_tooltip = {
				participation_scaled_prestige = 100
			}
		}
		FROM = {
			piety = -100
			prestige = -100
			if = {
				limit = {
					religion = tzeentch
				}
				change_variable = {
					which = "tzeentch_favor"
					value = -2
				}
			}
			if = {
				limit = {
					religion = slaanesh
				}
				change_variable = {
					which = "slaanesh_favor"
					value = -2
				}
			}
			if = {
				limit = {
					religion = khorne
				}
				change_variable = {
					which = "khorne_favor"
					value = -2
				}
			}
			if = {
				limit = {
					religion = nurgle
				}
				change_variable = {
					which = "nurgle_favor"
					value = -2
				}
			}
		}
		# DOOM_COUNTER - raise
		1 = {
			change_variable = {
				which = "doom_counter"
				value = 2
			}
		}
	}
	on_success_title = {
		# Usurp the target kingdom itself, if the enemy holds it
		if = {
			limit = {
				holder_scope = {
					character = FROM
				}
				NOT = {
					ROOT = {
						tier = EMPEROR
					}
				}
			}
			ROOT = {
				usurp_title = PREV
			}
		}
		if = {
			# Take the enemy's duchies within the target kingdom, if we are the same or lower tier
			limit = {
				ROOT = {
					NOT = {
						higher_tier_than = FROM
					}
				}
			}
			FROM = {
				any_demesne_title = {
					limit = {
						tier = DUKE
						OR = {
							title = PREVPREV
							de_jure_liege_or_above = PREVPREV
						}
					}
					ROOT = {
						usurp_title = PREV
					}
				}
			}
		}
		# Have I become the vassal of the loser due to taking a duchy or kingdom?
		if = {
			limit = {
				ROOT = {
					is_liege_or_above = FROM
				}
			}
			ROOT = {
				set_defacto_liege = ROOT
			}
		}
		# Vassalize the rest
		custom_tooltip = {
			text = pagan_subjugation_tip
			hidden_tooltip = {
				ROOT = {
					subjugate_or_take_under_title = {
						# If the target only has territory within the kingdom, he is simply vassalized
						title = PREV
						enemy = FROM
					}
				}
			}
		}
	}
	on_fail = {
		1 = {
			change_variable = {
				which = "doom_counter"
				value = -2
			}
		}
		FROM = {
			piety = 50
			if = {
				limit = {
					religion = tzeentch
				}
				change_variable = {
					which = "tzeentch_favor"
					value = 1
				}
			}
			if = {
				limit = {
					religion = slaanesh
				}
				change_variable = {
					which = "slaanesh_favor"
					value = 1
				}
			}
			if = {
				limit = {
					religion = khorne
				}
				change_variable = {
					which = "khorne_favor"
					value = 1
				}
			}
			if = {
				limit = {
					religion = nurgle
				}
				change_variable = {
					which = "nurgle_favor"
					value = 1
				}
			}
			hidden_tooltip = {
				any_courtier = {
	 				piety = 100
					if = {
						limit = {
							religion = tzeentch
						}
						change_variable = {
							which = "tzeentch_favor"
							value = 1
						}
					}
					if = {
						limit = {
							religion = slaanesh
						}
						change_variable = {
							which = "slaanesh_favor"
							value = 1
						}
					}
					if = {
						limit = {
							religion = khorne
						}
						change_variable = {
							which = "khorne_favor"
							value = 1
						}
					}
					if = {
						limit = {
							religion = nurgle
						}
						change_variable = {
							which = "nurgle_favor"
							value = 1
						}
					}
				}
			}
		}
		any_defender = {
			limit = {
				character = FROM
			}
			participation_scaled_prestige = 50
			set_character_flag = imperial_hero
		}
		any_defender = {
			limit = {
				NOT = {
					character = FROM
				}
			}
			hidden_tooltip = {
				participation_scaled_prestige = 50
			}
			set_character_flag = imperial_hero
		}
		ROOT = {
			piety = -100
			if = {
				limit = {
					religion = tzeentch
				}
				change_variable = {
					which = "tzeentch_favor"
					value = -2
				}
			}
			if = {
				limit = {
					religion = slaanesh
				}
				change_variable = {
					which = "slaanesh_favor"
					value = -2
				}
			}
			if = {
				limit = {
					religion = khorne
				}
				change_variable = {
					which = "khorne_favor"
					value = -2
				}
			}
			if = {
				limit = {
					religion = nurgle
				}
				change_variable = {
					which = "nurgle_favor"
					value = -2
				}
			}
		}
	}
	on_reverse_demand = {
		1 = {
			change_variable = {
				which = "doom_counter"
				value = -2
			}
		}
		ROOT = {
			piety = -200
			if = {
				limit = {
					religion = tzeentch
				}
				change_variable = {
					which = "tzeentch_favor"
					value = -2
				}
			}
			if = {
				limit = {
					religion = slaanesh
				}
				change_variable = {
					which = "slaanesh_favor"
					value = -2
				}
			}
			if = {
				limit = {
					religion = khorne
				}
				change_variable = {
					which = "khorne_favor"
					value = -2
				}
			}
			if = {
				limit = {
					religion = nurgle
				}
				change_variable = {
					which = "nurgle_favor"
					value = -2
				}
			}
			transfer_scaled_wealth = {
				to = FROM
				value = 2.0
			}
		}
		FROM = {
			piety = 100
			if = {
				limit = {
					religion = tzeentch
				}
				change_variable = {
					which = "tzeentch_favor"
					value = 1
				}
			}
			if = {
				limit = {
					religion = slaanesh
				}
				change_variable = {
					which = "slaanesh_favor"
					value = 1
				}
			}
			if = {
				limit = {
					religion = khorne
				}
				change_variable = {
					which = "khorne_favor"
					value = 1
				}
			}
			if = {
				limit = {
					religion = nurgle
				}
				change_variable = {
					which = "nurgle_favor"
					value = 1
				}
			}
			hidden_tooltip = {
				any_courtier = {
	 				piety = 100
					if = {
						limit = {
							religion = tzeentch
						}
						change_variable = {
							which = "tzeentch_favor"
							value = 1
						}
					}
					if = {
						limit = {
							religion = slaanesh
						}
						change_variable = {
							which = "slaanesh_favor"
							value = 1
						}
					}
					if = {
						limit = {
							religion = khorne
						}
						change_variable = {
							which = "khorne_favor"
							value = 1
						}
					}
					if = {
						limit = {
							religion = nurgle
						}
						change_variable = {
							which = "nurgle_favor"
							value = 1
						}
					}
				}
			}
		}
		any_defender = {
			limit = {
				character = FROM
			}
			participation_scaled_prestige = 100
			set_character_flag = imperial_hero
		}
		any_defender = {
			limit = {
				NOT = {
					character = FROM
				}
			}
			hidden_tooltip = {
				participation_scaled_prestige = 100
			}
			set_character_flag = imperial_hero
		}
	}
	attacker_ai_victory_worth = {
		factor = 200
	}
	attacker_ai_defeat_worth = {
		factor = 100
	}
	defender_ai_victory_worth = {
		factor = -1 # always accept
	}
	defender_ai_defeat_worth = {
		factor = 100
	}
	ai_will_do = {
		factor = 1
		modifier = {
			factor = 5
		}
		# modifier = {
		# 	factor = 0.001
		# 	ROOT = {
		# 		distance = {
		# 			where = FROM
		# 			value = 80
		# 		}
		# 	}
		# }
		modifier = {
			factor = 5
			ROOT = {
				trait = prince_khorne
			}
		}
		modifier = {
			factor = 5
			has_global_flag = doom_high
		}
	}
}

# Chaos CB for glory and loot against non-Chaos
unholy_raid = {
	name = CB_NAME_UNHOLY_RAID
	war_name = WAR_NAME_UNHOLY_RAID
	sprite = 8
	truce_days = 1825
	hostile_against_others = yes
	is_holy_war = yes
	is_permanent = yes
	can_ask_to_join_war = yes
	allow_whitepeace = no
	can_call_allies = yes
	check_de_jure_tier = DUKE # this scans all de jure kingdoms for the counties which are held by or vassals(or below) of selected character. Only valid if is_permanent = yes
	battle_warscore_mult = 1.35
	can_use_gui = {
		ROOT = {
			prestige = 50
		}
	}
	on_add = {
		ROOT = {
			prestige = -50
		}
	}
	can_use = {
		ROOT = {
			is_within_diplo_range = FROM
			OR = {
				is_tribal = yes
				is_nomadic = yes
			}
			religion_group = chaos_gods_group
			NOT = {
				same_realm = FROM
				is_liege_or_above = FROM
				trait = creature_beastman
			}
		}
		FROM = {
			NOT = {
				religion_group = chaos_gods_group
			}
		}
	}
	can_use_title = {
		wh_cb_albion_check_trigger = yes
		NOT = {
			region = world_underempire
		}
		# The attacker needs at least one county in the target kingdom, or a border, or be only two sea zones away from one of your counties
		any_direct_de_jure_vassal_title = {
			OR = {
				holder_scope = {
					OR = {
						character = ROOT
						is_liege_or_above = ROOT
					}
				}
				location = {
					any_neighbor_province = {
						OR = {
							AND = {
								has_owner = yes
								owner = {
									OR = {
										character = ROOT
										is_liege_or_above = ROOT
									}
								}
							}
							AND = {
								is_land = no
								any_neighbor_province = {
									OR = {
										AND = {
											has_owner = yes
											owner = {
												OR = {
													character = ROOT
													is_liege_or_above = ROOT
												}
											}
										}
										AND = {
											is_land = no
											any_neighbor_province = {
												owner = {
													OR = {
														character = ROOT
														is_liege_or_above = ROOT
													}
												}
											}
										}
									}
								}
							}
						}
					}
				}
			}
		}
	}
	is_valid = {
		ROOT = {
			NOT = {
				same_realm = FROM
			}
			OR = {
				NOT = {
					religion = FROM
				}
				is_heresy_of = FROM
				is_parent_religion = FROM
			}
			top_liege = {
				NOT = {
					religion = FROM
				}
			}
		}
	}
	on_add_title = {
	}
	on_success = {
		1 = {
			change_variable = {
				which = "doom_counter"
				value = 1
			}
		}
		ROOT = {
			if = {
				limit = {
					religion = tzeentch
				}
				change_variable = {
					which = "tzeentch_favor"
					value = 1
				}
			}
			if = {
				limit = {
					religion = slaanesh
				}
				change_variable = {
					which = "slaanesh_favor"
					value = 1
				}
			}
			if = {
				limit = {
					religion = khorne
				}
				change_variable = {
					which = "khorne_favor"
					value = 1
				}
			}
			if = {
				limit = {
					religion = nurgle
				}
				change_variable = {
					which = "nurgle_favor"
					value = 1
				}
			}
			piety = 200
			participation_scaled_piety = 100
			hidden_tooltip = {
				any_courtier = {
					piety = 200
					if = {
						limit = {
							religion = tzeentch
						}
						change_variable = {
							which = "tzeentch_favor"
							value = 1
						}
					}
					if = {
						limit = {
							religion = slaanesh
						}
						change_variable = {
							which = "slaanesh_favor"
							value = 1
						}
					}
					if = {
						limit = {
							religion = khorne
						}
						change_variable = {
							which = "khorne_favor"
							value = 1
						}
					}
					if = {
						limit = {
							religion = nurgle
						}
						change_variable = {
							which = "nurgle_favor"
							value = 1
						}
					}
					participation_scaled_piety = 100
				}
			}
		}
		any_attacker = {
			limit = {
				character = ROOT
			}
			participation_scaled_prestige = 100
		}
		any_attacker = {
			limit = {
				NOT = {
					character = ROOT
				}
			}
			hidden_tooltip = {
				participation_scaled_prestige = 100
				participation_scaled_piety = 100
				any_courtier = {
					piety = 100
					participation_scaled_piety = 100
				}
			}
		}
		FROM = {
			piety = -200
			prestige = -300
			transfer_scaled_wealth = {
				to = ROOT
				value = 25.0
			}
		}
	}
	on_fail = {
		1 = {
			change_variable = {
				which = "doom_counter"
				value = -1
			}
		}
		FROM = {
			piety = 100
		}
		any_defender = {
			limit = {
				character = FROM
			}
			participation_scaled_piety = 100
			participation_scaled_prestige = 50
		}
		any_defender = {
			limit = {
				NOT = {
					character = FROM
				}
			}
			hidden_tooltip = {
				participation_scaled_piety = 100
				participation_scaled_prestige = 50
			}
		}
		ROOT = {
			piety = -150
		}
	}
	on_reverse_demand = {
		1 = {
			change_variable = {
				which = "doom_counter"
				value = -2
			}
		}
		ROOT = {
			piety = -300
			transfer_scaled_wealth = {
				to = FROM
				value = 2.0
			}
		}
		FROM = {
			piety = 150
		}
		any_defender = {
			limit = {
				character = FROM
			}
			participation_scaled_prestige = 100
			participation_scaled_piety = 100
		}
		any_defender = {
			limit = {
				NOT = {
					character = FROM
				}
			}
			hidden_tooltip = {
				participation_scaled_prestige = 100
				participation_scaled_piety = 100
			}
		}
	}
	attacker_ai_victory_worth = {
		factor = 200
	}
	attacker_ai_defeat_worth = {
		factor = 100
	}
	defender_ai_victory_worth = {
		factor = -1 # always accept
	}
	defender_ai_defeat_worth = {
		factor = 100
	}
	ai_will_do = {
		factor = 1
		modifier = {
			factor = 5
			ROOT = {
				culture_group = kurgan_group
			}
		}
		modifier = {
			factor = 5
			ROOT = {
				religion = khorne
			}
		}
		modifier = {
			factor = 5
			ROOT = {
				trait = lunatic_3
			}
		}
	}
}

everchosen_invasion = {
	name = CB_NAME_INVASION
	war_name = WAR_NAME_INVASION
	sprite = 8
	truce_days = 0
	hostile_against_others = yes
	is_permanent = yes
	check_de_jure_tier = KING # this scans all de jure kingdoms for the counties which are held by or vassals(or below) of selected character. Only valid if is_permanent = yes
	can_ask_to_join_war = yes
	is_holy_war = yes
	allow_whitepeace = no
	can_call_allies = yes
	allowed_to_target_tributaries = no
	allowed_to_target_suzerains = no
	can_use_gui = {
		ROOT = {
			trait = everchosen
		}
	}
	on_add = {
		FROM = {
			# If follower of Chaos or Norscan, consider to surrender and convert
			if = {
				limit = {
					NOT = {
						ROOT = {
							has_character_flag = first_everchosen_war
						}
					}
					OR = {
						religion_group = chaos_gods_group
						religion = norscan_gods
					}
				}
				character_event = {
					id = DR_chaosundivided.50 days = 1
				}
			}
		}
	}
	can_use = {
		ROOT = {
			NOT = {
				trait = vampire_necrarch_visible
			}
			NOT = {
				trait = creature_beastman
			}
			NOT = {
				trait = creature_orc
			}
			NOT = {
				trait = creature_goblin
			}
			trait = everchosen
			is_nomadic = yes
		}
		wh_cb_root_not_same_realm_from_rigger = yes
	}
	is_valid_title = {
		FROM = {
			any_realm_title = {
				de_jure_liege_or_above = PREVPREV
			}
		}
	}
	on_success = {
		any_attacker = {
			limit = {
				NOT = {
					character = ROOT
				}
			}
			hidden_tooltip = {
				participation_scaled_prestige = 200
			}
		}
		FROM = {
			prestige = -200
		}
		hidden_tooltip = {
			ROOT = {
				wealth = 900
				piety = 500
				prestige = 500
				occupy_minors_of_occupied_settlements = FROM
				gain_all_occupied_titles = {
					who = FROM
					type = invasion
				}
				if = {
					limit = {
						has_character_flag = first_everchosen_war
					}
					character_event = {
						id = DR_chaosundivided.75 days = 2
					}
					clr_character_flag = first_everchosen_war
				}
				if = {
					limit = {
						has_nickname = no
					}
					random_list = {
						10 = {
							give_nickname = nick_the_despoiler
						}
						10 = {
							give_nickname = nick_the_conqueror
						}
						10 = {
							give_nickname = nick_the_terrible
						}
						10 = {
							give_nickname = nick_the_victorious
						}
						10 = {
							give_nickname = nick_the_brazen
						}
						10 = {
							give_nickname = nick_the_eviscerator
						}
						10 = {
							give_nickname = nick_the_betrayer
						}
						10 = {
							give_nickname = nick_the_reviled
						}
						10 = {
							give_nickname = nick_the_neverborn
						}
						10 = {
							give_nickname = nick_the_soulless
						}
						10 = {
							give_nickname = nick_the_golden
						}
						10 = {
							give_nickname = nick_the_faithless
						}
						10 = {
							give_nickname = nick_the_eternal
						}
						10 = {
							give_nickname = nick_the_thousandeyed
						}
						10 = {
							give_nickname = nick_the_warpbound
						}
						10 = {
							give_nickname = nick_the_wyrd
						}
						10 = {
							give_nickname = nick_the_anointed
						}
						10 = {
							give_nickname = nick_the_gloried
						}
					}
				}
			}
		}
	}
	on_success_title = {
		custom_tooltip = {
			text = tribal_invasion_succ_tip
			hidden_tooltip = {
				ROOT = {
					gain_settlements_under_title = {
						title = PREV
						enemy = FROM
						type = holy_war
					}
				}
			}
		}
	}
	on_fail = {
		FROM = {
			prestige = 100
			hidden_tooltip = {
				if = {
					limit = {
						has_nickname = no
					}
					random_list = {
						10 = {
							give_nickname = nick_the_great
						}
						10 = {
							give_nickname = nick_the_hammer
						}
						10 = {
							give_nickname = nick_the_avenger
						}
						10 = {
							give_nickname = nick_the_lion
						}
						10 = {
							give_nickname = nick_the_bold
						}
					}
				}
			}
		}
		any_defender = {
			limit = {
				character = FROM
			}
			participation_scaled_prestige = 100
		}
		any_defender = {
			limit = {
				NOT = {
					character = FROM
				}
			}
			hidden_tooltip = {
				participation_scaled_prestige = 100
			}
		}
		ROOT = {
			prestige = -200
		}
	}
	on_reverse_demand = {
		ROOT = {
			prestige = -200
			transfer_scaled_wealth = {
				to = FROM
				value = 4.0
			}
		}
		FROM = {
			prestige = 200
			hidden_tooltip = {
				if = {
					limit = {
						has_nickname = no
					}
					random_list = {
						10 = {
							give_nickname = nick_the_great
						}
						10 = {
							give_nickname = nick_the_hammer
						}
						10 = {
							give_nickname = nick_the_avenger
						}
						10 = {
							give_nickname = nick_the_lion
						}
						10 = {
							give_nickname = nick_the_bold
						}
					}
				}
			}
		}
		any_defender = {
			limit = {
				character = FROM
			}
			participation_scaled_prestige = 200
		}
		any_defender = {
			limit = {
				NOT = {
					character = FROM
				}
			}
			hidden_tooltip = {
				participation_scaled_prestige = 200
			}
		}
	}
	attacker_ai_victory_worth = {
		factor = 200
	}
	attacker_ai_defeat_worth = {
		factor = 100
	}
	defender_ai_victory_worth = {
		factor = -1 # always accept
	}
	defender_ai_defeat_worth = {
		factor = 100
	}
	ai_will_do = {
		factor = 8
		modifier = {
			factor = 0.1
			# Try to steer the Everchosen to the right places
			ROOT = {
				primary_title = {
					title = e_host_chaos
				}
			}
			OR = {
				empire = {
					OR = {
						title = e_darklands
						title = e_naggaroth
						title = e_ogre_kingdoms
					}
				}
				kingdom = {
					OR = {
						title = k_kura
						title = k_zud
						title = k_ruan
						title = k_khangai
						title = k_zuungar
						title = k_ejsgard
						title = k_nordanvankor
						title = k_fimbul
						title = k_soerligslette
						title = k_dagorath
					}
				}
			}
		}
	}
}

beastmen_uprising = {
	name = CB_NAME_BEASTMEN_UPRISING
	war_name = WAR_NAME_BEASTMEN_UPRISING
	sprite = 16
	truce_days = 365
	hostile_against_others = yes
	is_permanent = yes
	check_all_titles = yes
	press_claim = yes
	attacker_can_call_allies = yes
	defender_can_call_allies = no
	can_ask_to_join_war = no
	is_independence = yes
	can_use = {
		ROOT = {
			is_landed = no
			culture_group = beastman_group
			# primary_title = { temporary = yes } # Revolter or adventurer trigger
			war = no
			NOT = {
				is_liege_or_above = FROM
			}
		}
	}
	on_attacker_leader_death = {
		end_war = invalid
	}
	can_use_title = {
		tier = count
	}
	is_valid_title = {
		wh_cb_is_valid_title_trigger = yes
	}
	on_success_title = {
		usurp_title_plus_barony_if_unlanded = {
			target = ROOT
			type = revolt
		}
		ROOT = {
			primary_title = {
				set_title_nomad = {
					title = THIS status = no
				}
			}
			set_government_type = feudal_government
		}
		ROOT = {
			set_government_type = beastman_government
			set_defacto_liege = THIS
			capital_scope = {
				any_province_holding = {
					limit = {
						NOT = {
							holding_type = nomad
						}
					}
					destroy_settlement = THIS
				}
			}
		}
		FROM = {
			prestige = -100
			piety = -100
		}
	}
	on_fail_title = {
		FROM = {
			prestige = 10
			hidden_tooltip = {
				opinion = {
					modifier = opinion_savage_invader
					who = ROOT
					months = 1200
				}
			}
		}
		ROOT = {
			death = {
				death_reason = death_battle
				killer = FROM
			}
		}
	}
	on_reverse_demand = {
		FROM = {
			prestige = 20
			hidden_tooltip = {
				opinion = {
					modifier = opinion_savage_invader
					who = ROOT
					months = 1200
				}
				add_character_modifier = {
					name = scattered_beastmen
					days = 3650
				}
			}
		}
		ROOT = {
			death = {
				death_reason = death_battle
				killer = FROM
			}
		}
	}
	attacker_ai_victory_worth = {
		factor = -1 # always accept
	}
	attacker_ai_defeat_worth = {
		factor = 100
	}
	defender_ai_victory_worth = {
		factor = -1 # always accept
	}
	defender_ai_defeat_worth = {
		factor = 100
	}
}

# Migrating
beastman_migration = {
	name = CB_NAME_BEASTMAN_MIGRATION
	war_name = WAR_NAME_BEASTMAN_MIGRATION
	sprite = 30
	truce_days = 2050
	is_permanent = yes
	is_holy_war = yes
	can_ask_to_join_war = yes
	can_call_allies = yes
	check_de_jure_tier = DUKE # this scans all dejure duchies for the counties which are held by or vassals(or below) of selected character. Only valid if is_permanent = yes
	can_use = {
		ROOT = {
			trait = creature_beastman
			independent = yes
			lower_tier_than = KING
		}
	}
	on_attacker_leader_death = {
		end_war = invalid
	}
	can_use_title = {
		wh_cb_albion_check_trigger = yes
		nor = {
			region = world_nehekhara
			region = world_underempire
		}
		any_direct_de_jure_vassal_title = {
			OR = {
				holder_scope = {
					OR = {
						character = ROOT
						is_liege_or_above = ROOT
					}
				}
				location = {
					any_neighbor_province = {
						owner = {
							OR = {
								character = ROOT
								is_liege_or_above = ROOT
							}
						}
					}
				}
			}
		}
	}
	is_valid = {
		ROOT = {
			trait = creature_beastman
			independent = yes
			is_playable = yes
		}
	}
	on_success = {
		any_attacker = {
			participation_scaled_piety = 50
			participation_scaled_prestige = 25
		}
		ROOT = {
			any_demesne_title = {
				set_title_flag = migrating_away
			}
			any_vassal = {
				limit = {
					higher_tier_than = BARON
				}
				set_character_flag = migrating_away_vassal
			}
			occupy_minors_of_occupied_settlements = FROM
			gain_all_occupied_titles = {
				who = FROM
				type = invasion
			}
		}
		FROM = {
			piety = -50
			prestige = -150
		}
	}
	on_success_title = {
		hidden_tooltip = {
			ROOT = {
				vassalize_or_take_under_title_destroy_duchies  = {
					title = PREV
					enemy = FROM
					same_religion = yes # Only vassalize rulers of my religion
					is_religious = yes
					type = holy_war
				}
				character_event = {
					id = wh_chaos_beastmen.10
					days = 1
				}
			}
		}
	}
	on_fail = {
		ROOT = {
			piety = -50
			prestige = -100
		}
	}
	on_reverse_demand = {
		ROOT = {
			transfer_scaled_wealth = {
				to = FROM
				value = 4.0
			}
			piety = -75
			prestige = -150
		}
		any_defender = {
			participation_scaled_piety = 200
			participation_scaled_prestige = 100
		}
	}
	attacker_ai_victory_worth = {
		factor = -1 # always accept
	}
	attacker_ai_defeat_worth = {
		factor = 100
	}
	defender_ai_victory_worth = {
		factor = -1 # always accept
	}
	defender_ai_defeat_worth = {
		factor = 100
	}
	ai_will_do = {
		factor = 1
		modifier = {
			factor = 10
			capital_scope = {
				has_province_modifier = province_scourged
			}
		}
		modifier = {
			factor = 0.25
			FROM = {
				trait = creature_beastman
			}
		}
	}
}

# Migrating (for King-tiers)
king_beastman_migration = {
	name = CB_NAME_BEASTMAN_MIGRATION
	war_name = WAR_NAME_BEASTMAN_MIGRATION
	sprite = 30
	truce_days = 2050
	is_permanent = yes
	is_holy_war = yes
	can_ask_to_join_war = yes
	can_call_allies = yes
	check_de_jure_tier = KING # this scans all dejure duchies for the counties which are held by or vassals(or below) of selected character. Only valid if is_permanent = yes
	can_use_gui = {
		ROOT = {
			prestige = 50
			population_factor = 0.15
			is_within_diplo_range = FROM
		}
	}
	on_add = {
		ROOT = {
			prestige = -50
		}
	}
	can_use = {
		ROOT = {
			prestige = 50
			trait = creature_beastman
			independent = yes
			wh_cb_pays_tribute_to_from_trigger = no
		}
		wh_cb_root_not_same_realm_from_rigger = yes
	}
	can_use_title = {
		wh_cb_albion_check_trigger = yes
		NOT = {
			capital_scope = {
				distance = {
					who = ROOT
					distance = 300
				}
			}
		}
		nor = {
			region = world_underempire
			region = world_nehekhara
		}
	}
	is_valid_title = {
		FROM = {
			any_realm_title = {
				de_jure_liege_or_above = PREVPREV
			}
		}
	}
	on_attacker_leader_death = {
		end_war = invalid
	}
	on_success = {
		any_attacker = {
			participation_scaled_piety = 150
			participation_scaled_prestige = 250
		}
		ROOT = {
			any_demesne_title = {
				limit = {
					nor = {
						is_primary_type_title = yes
						higher_tier_than = DUKE
					}
				}
				set_title_flag = migrating_away
			}
			any_vassal = {
				set_character_flag = migrating_away_vassal
			}
			capital_holding = {
				add_holding_modifier = {
					modifier = nomad_population_boom
					years = 8
					stacking = yes
				}
			}
			population = 1000
		}
		FROM = {
			piety = -50
			prestige = -150
		}
	}
	on_success_title = {
		hidden_tooltip = {
			root = {
				vassalize_or_take_under_title_destroy_duchies  = {
					title = PREV
					enemy = FROM
					same_religion = yes # Only vassalize rulers of my religion
					is_religious = yes
					type = holy_war
				}
				character_event = {
					id = wh_chaos_beastmen.10
					days = 1
				}
			}
		}
	}
	on_fail = {
		ROOT = {
			piety = -150
			prestige = -200
		}
	}
	on_reverse_demand = {
		ROOT = {
			transfer_scaled_wealth = {
				to = FROM
				value = 4.0
			}
			piety = -175
			prestige = -250
		}
		any_defender = {
			participation_scaled_piety = 300
			participation_scaled_prestige = 200
		}
	}
	attacker_ai_victory_worth = {
		factor = -1 # always accept
	}
	attacker_ai_defeat_worth = {
		factor = 100
	}
	defender_ai_victory_worth = {
		factor = -1 # always accept
	}
	defender_ai_defeat_worth = {
		factor = 100
	}
	ai_will_do = {
		factor = 1
		modifier = {
			factor = 10
			capital_scope = {
				has_province_modifier = province_scourged
			}
		}
		modifier = {
			factor = 0.25
			FROM = {
				trait = creature_beastman
			}
		}
	}
}

chaos_dwarf_slaver_raid = {
	name = CB_NAME_CHAOS_DWARF_SLAVER_RAID
	war_name = WAR_NAME_CHAOS_DWARF_SLAVER_RAID
	sprite = 7
	truce_days = 3650
	hostile_against_others = yes
	is_permanent = yes
	can_ask_to_join_war = yes
	can_call_allies = yes
	check_de_jure_tier = DUKE # this scans all de jure kingdoms for the counties which are held by or vassals(or below) of selected character. Only valid if is_permanent = yes
	battle_warscore_mult = 1.25
	allow_distant = yes # AI parameter
	can_use_gui = {
		ROOT = {
			prestige = 50
		}
	}
	on_add = {
		ROOT = {
			prestige = -50
		}
	}
	can_use = {
		ROOT = {
			culture_group = dwarf_chaos_group
		}
		FROM = {
			NOT = {
				culture_group = dwarf_chaos_group
			}
		}
	}
	can_use_title = {
		wh_cb_albion_check_trigger = yes
		nor = {
			region = world_underempire
			region = world_nehekhara
		}
		# The attacker needs at least one county in the target kingdom, or a border, or be only two sea zones away from one of your counties
		any_direct_de_jure_vassal_title = {
			OR = {
				holder_scope = {
					OR = {
						character = ROOT
						is_liege_or_above = ROOT
					}
				}
				location = {
					any_neighbor_province = {
						OR = {
							AND = {
								has_owner = yes
								owner = {
									OR = {
										character = ROOT
										is_liege_or_above = ROOT
									}
								}
							}
							AND = {
								is_land = no
								any_neighbor_province = {
									OR = {
										AND = {
											has_owner = yes
											owner = {
												OR = {
													character = ROOT
													is_liege_or_above = ROOT
												}
											}
										}
										AND = {
											is_land = no
											any_neighbor_province = {
												owner = {
													OR = {
														character = ROOT
														is_liege_or_above = ROOT
													}
												}
											}
										}
									}
								}
							}
						}
					}
				}
			}
		}
	}
	is_valid = {
		wh_cb_root_not_same_realm_from_rigger = yes
		FROM = {
			NOT = {
				religion = hashut
			}
			NOT = {
				culture_group = dwarf_chaos_group
			}
		}
	}
	on_add_title = {
	}
	on_invalidation = {
		ROOT = {
			IF = {
				limit = {
					has_character_flag = chaos_dwarf_raided_a_province
				}
				clr_character_flag = chaos_dwarf_raided_a_province
			}
		}
	}
	on_success = {
		ROOT = {
			prestige = 100
			participation_scaled_prestige = 100
			IF = {
				limit = {
					has_character_flag = chaos_dwarf_raided_a_province
				}
				clr_character_flag = chaos_dwarf_raided_a_province
			}
		}
		any_attacker = {
			limit = {
				NOT = {
					character = ROOT
				}
			}
			hidden_tooltip = {
				participation_scaled_prestige = 100
				participation_scaled_piety = 100
			}
		}
		FROM = {
			prestige = -300
		}
	}
	on_fail = {
		FROM = {
			prestige = 100
		}
		any_defender = {
			limit = {
				character = FROM
			}
			participation_scaled_piety = 100
			participation_scaled_prestige = 50
		}
		any_defender = {
			limit = {
				NOT = {
					character = FROM
				}
			}
			hidden_tooltip = {
				participation_scaled_piety = 100
				participation_scaled_prestige = 50
			}
		}
		ROOT = {
			prestige = -300
			IF = {
				limit = {
					has_character_flag = chaos_dwarf_raided_a_province
				}
				clr_character_flag = chaos_dwarf_raided_a_province
			}
		}
	}
	on_reverse_demand = {
		ROOT = {
			prestige = -300
			transfer_scaled_wealth = {
				to = FROM
				value = 2.0
			}
			IF = {
				limit = {
					has_character_flag = chaos_dwarf_raided_a_province
				}
				clr_character_flag = chaos_dwarf_raided_a_province
			}
		}
		FROM = {
			prestige = 150
		}
		any_defender = {
			participation_scaled_prestige = 100
			participation_scaled_piety = 100
		}
	}
	attacker_ai_victory_worth = {
		factor = -1 # Always accept
	}
	attacker_ai_defeat_worth = {
		factor = 100
	}
	defender_ai_victory_worth = {
		factor = -1 # Always accept
	}
	defender_ai_defeat_worth = {
		factor = 100
	}
	ai_will_do = {
		factor = 1
		modifier = {
			factor = 3
			ROOT = {
				trait = greedy
			}
		}
		modifier = {
			factor = 5
			ROOT = {
				capital_holding = {
					NOT = {
						OR = {
							has_building = ca_chaos_dwarf_factory_1
							has_building = ca_chaos_dwarf_slave_levy_1
							has_building = ct_chaos_dwarf_factory_1
							has_building = ct_chaos_dwarf_slave_levy_1
							has_building = fp_chaos_dwarf_factory_1
							has_building = fp_chaos_dwarf_slave_levy_1
							has_building = tp_chaos_dwarf_factory_1
							has_building = tp_chaos_dwarf_slave_levy_1
						}
					}
				}
			}
		}
	}
}

cultist_bid_for_independence = {
	# WIP
	name = CB_NAME_INDEPENDENCE
	war_name = WAR_NAME_FACTION_INDEPENDENCE
	sprite = 12
	truce_days = 3650
	major_revolt = yes
	attacker_can_call_allies = no
	can_ask_to_join_war = no
	is_independence = yes
	can_use = {
		ROOT = {
			vassal_of = FROM
		}
	}
	is_valid = {
		ROOT = {
			OR = {
				liege = {
					character = PREV # either independent
				}
				liege = {
					FROM = {
						is_liege_or_above = PREV # or have shared liege
					}
				}
			}
		}
		FROM = {
			any_demesne_title = {
				NOT = {
					lower_tier_than = ROOT
				}
				temporary = no
			}
			independent = yes
			in_revolt = no
			liege_before_war = {
				in_revolt = no
				liege_before_war = {
					in_revolt = no
				}
			}
		}
	}
	on_success = {
		FROM = {
			any_vassal = {
				limit = {
					has_character_flag = independent_joining_flag
				}
				set_defacto_liege = THIS
				clr_character_flag = independent_joining_flag
			}
		}
		if = {
			limit = {
				FROM = {
					independent = no
				}
			}
			FROM = {
				if = {
					limit = {
						in_revolt = yes
					}
					liege_before_war = {
						# ROOT = {
						# 	set_defacto_liege = PREV
						# }
						any_attacker = {
							set_defacto_liege = PREV
						}
					}
				}
				if = {
					limit = {
						in_revolt = no
					}
					liege = {
						# ROOT = {
						# 	set_defacto_liege = PREV
						# }
						any_attacker = {
							set_defacto_liege = PREV
						}
					}
				}
			}
		}
		if = {
			limit = {
				FROM = {
					independent = yes
				}
			}
			# ROOT = {
			# 	set_defacto_liege = ROOT
			# }
			any_attacker = {
				set_defacto_liege = ROOT
			}
		}
		hidden_tooltip = {
			ROOT = {
				prestige = 100
				any_demesne_title = {
					add_pressed_claim = FROM
				}
			}
		}
		any_attacker = {
			limit = {
				character = ROOT
			}
			participation_scaled_prestige = 100
		}
		any_attacker = {
			limit = {
				NOT = {
					character = ROOT
				}
			}
			hidden_tooltip = {
				participation_scaled_prestige = 100
			}
		}
		FROM = {
			any_demesne_title = {
				# All titles
				limit = {
					OR = {
						tier = king
						tier = emperor
					}
					# 					is_titular = no
					NOT = {
						OR = {
							has_law = crown_authority_0
							has_law = imperial_crown_authority_0
						}
					}
				}
				if = {
					limit = {
						has_law = crown_authority_1
					}
					add_law = crown_authority_0
				}
				if = {
					limit = {
						has_law = crown_authority_2
					}
					add_law = crown_authority_1
				}
				if = {
					limit = {
						has_law = crown_authority_3
					}
					add_law = crown_authority_2
				}
				if = {
					limit = {
						has_law = crown_authority_4
					}
					add_law = crown_authority_3
				}
				if = {
					limit = {
						has_law = imperial_crown_authority_1
					}
					add_law = imperial_crown_authority_0
				}
				if = {
					limit = {
						has_law = imperial_crown_authority_2
					}
					add_law = imperial_crown_authority_1
				}
				if = {
					limit = {
						has_law = imperial_crown_authority_3
					}
					add_law = imperial_crown_authority_2
				}
				if = {
					limit = {
						has_law = imperial_crown_authority_4
					}
					add_law = imperial_crown_authority_3
				}
			}
		}
	}
	on_fail = {
		if = {
			limit = {
				FROM = {
					independent = no
				}
			}
			FROM = {
				if = {
					limit = {
						in_revolt = yes
					}
					liege_before_war = {
						ROOT = {
							set_defacto_liege = PREV
						}
					}
				}
				if = {
					limit = {
						in_revolt = no
					}
					liege = {
						ROOT = {
							set_defacto_liege = PREV
						}
						any_vassal = {
							limit = {
								has_character_flag = independent_joining_flag
							}
							set_defacto_liege = PREV
							clr_character_flag = independent_joining_flag
						}
					}
				}
			}
		}
		if = {
			limit = {
				FROM = {
					independent = yes
				}
			}
			ROOT = {
				set_defacto_liege = ROOT
			}
			any_vassal = {
				limit = {
					has_character_flag = independent_joining_flag
				}
				set_defacto_liege = PREV
				clr_character_flag = independent_joining_flag
			}
		}
		hidden_tooltip = {
			ROOT = {
				prestige = 100
				any_demesne_title = {
					add_pressed_claim = FROM
				}
			}
		}
	}
	on_reverse_demand = {
		ROOT = {
			prestige = -100
			prisoner = FROM
			if = {
				# abdicate to heir if not a chaos cultist
				limit = {
					ROOT = {
						current_heir = {
							NOT = {
								religion = chaos
								religion = tzeentch
								religion = nurgle
								religion = slaanesh
								religion = khorne
							}
						}
					}
				}
				abdicate = yes
				break = yes
			}
			if = {
				# abdicate to sibling w/claim
				limit = {
					ROOT = {
						any_sibling = {
							NOT = {
								religion = chaos
								religion = tzeentch
								religion = nurgle
								religion = slaanesh
								religion = khorne
							}
							ROOT = {
								primary_title = {
									PREVPREV = {
										has_claim = PREV
									}
								}
							}
							# has_claim = {
							# primary_title = {
							# ROOT
							# }
							# }
						}
					}
				}
				ROOT = {
					random_sibling = {
						limit = {
							NOT = {
								religion = chaos
								religion = tzeentch
								religion = nurgle
								religion = slaanesh
								religion = khorne
							}
							ROOT = {
								primary_title = {
									PREVPREV = {
										has_claim = PREV
									}
								}
							}
							# has_claim = {
							# primary_title = {
							# ROOT
							# }
							# }
						}
						ROOT = {
							abdicate_to = PREV
						}
					}
				}
				break = yes
			}
			if = {
				# abdicate to dynasty member w/claim
				limit = {
					ROOT = {
						any_dynasty_member = {
							NOT = {
								religion = chaos
								religion = tzeentch
								religion = nurgle
								religion = slaanesh
								religion = khorne
							}
							PREV = {
								primary_title = {
									PREVPREV = {
										has_claim = PREV
									}
								}
								# has_claim = {
								# primary_title = {
								# ROOT
								# }
								# }
							}
						}
					}
				}
				ROOT = {
					random_dynasty_member = {
						limit = {
							NOT = {
								religion = chaos
								religion = tzeentch
								religion = nurgle
								religion = slaanesh
								religion = khorne
							}
							PREV = {
								primary_title = {
									PREVPREV = {
										has_claim = PREV
									}
								}
							}
							# has_claim = {
							# primary_title = {
							# ROOT
							# }
							# }
						}
						ROOT = {
							abdicate_to = PREV
						}
					}
				}
				break = yes
			}
			if = {
				# abdicate to sibling w/out claim
				limit = {
					ROOT = {
						any_sibling = {
							NOT = {
								religion = chaos
								religion = tzeentch
								religion = nurgle
								religion = slaanesh
								religion = khorne
							}
						}
					}
				}
				ROOT = {
					random_sibling = {
						limit = {
							NOT = {
								religion = chaos
								religion = tzeentch
								religion = nurgle
								religion = slaanesh
								religion = khorne
							}
						}
						ROOT = {
							abdicate_to = PREV
						}
					}
				}
				break = yes
			}
			if = {
				# abdicate to dynasty member w/out claim
				limit = {
					ROOT = {
						any_dynasty_member = {
							NOT = {
								religion = chaos
								religion = tzeentch
								religion = nurgle
								religion = slaanesh
								religion = khorne
							}
						}
					}
				}
				ROOT = {
					random_dynasty_member = {
						limit = {
							NOT = {
								religion = chaos
								religion = tzeentch
								religion = nurgle
								religion = slaanesh
								religion = khorne
							}
						}
						ROOT = {
							abdicate_to = PREV
						}
					}
				}
				break = yes
			}
			# abidicate to liege if no one left
			abdicate_to = FROM
		}
		any_attacker = {
			limit = {
				character = ROOT
			}
			participation_scaled_prestige = -100
		}
		any_attacker = {
			limit = {
				NOT = {
					character = ROOT
				}
			}
			hidden_tooltip = {
				participation_scaled_prestige = -100
			}
		}
		FROM = {
			prestige = 50
		}
	}
	on_attacker_leader_death = {
		hidden_tooltip = {
			any_defender = {
				letter_event = {
					id = 251
				}
			}
		}
		end_war = invalid
	}
	attacker_ai_victory_worth = {
		factor = -1 # always accept
	}
	attacker_ai_defeat_worth = {
		factor = 150
	}
	defender_ai_victory_worth = {
		factor = -1 # always accept
	}
	defender_ai_defeat_worth = {
		factor = 100
	}
}

# Empire
imperial_reconquest = {
	name = CB_NAME_IMPERIAL
	war_name = WAR_NAME_IMPERIAL
	sprite = 17
	truce_days = 3650
	is_permanent = yes
	can_ask_to_join_war = yes
	can_call_allies = yes
	check_de_jure_tier = DUKE # this scans all dejure duchies for the counties which are held by or vassals(or below) of selected character. Only valid if is_permanent = yes
	can_use = {
		ROOT = {
			NOT = {
				trait = vampire_necrarch_visible
			}
			FROM = {
				NOT = {
					trait = vampire_necrarch_visible
				}
			}
			has_landed_title = e_the_empire
			independent = yes
			religion_group = old_world_group
			NOT = {
				same_realm = FROM
			}
		}
	}
	can_use_title = {
		wh_cb_albion_check_trigger = yes
		NOT = {
			region = world_underempire
		}
		location = {
			region = world_old_world_empire
		}
	}
	is_valid = {
		ROOT = {
			independent = yes
			religion_group = old_world_group
			NOT = {
				same_realm = FROM
			}
		}
	}
	on_success = {
		any_attacker = {
			limit = {
				character = ROOT
			}
			participation_scaled_prestige = 100
		}
		any_attacker = {
			limit = {
				NOT = {
					character = ROOT
				}
			}
			hidden_tooltip = {
				participation_scaled_prestige = 100
			}
		}
		FROM = {
			prestige = -100
		}
	}
	on_success_title = {
		custom_tooltip = {
			text = tribal_invasion_succ_tip
			hidden_tooltip = {
				ROOT = {
					vassalize_or_take_under_title = {
						title = PREV
						enemy = FROM
					}
				}
			}
		}
		if = {
			limit = {
				holder_scope = {
					character = FROM
				}
			}
			usurp_title_only = ROOT
		}
	}
	on_fail = {
		ROOT = {
			prestige = -150
		}
	}
	on_reverse_demand = {
		ROOT = {
			transfer_scaled_wealth = {
				to = FROM
				value = 4.0
			}
			ROOT = {
				prestige = -200
			}
		}
		any_defender = {
			participation_scaled_piety = 100
			participation_scaled_prestige = 200
		}
	}
	attacker_ai_victory_worth = {
		factor = -1 # always accept
	}
	attacker_ai_defeat_worth = {
		factor = 100
	}
	defender_ai_victory_worth = {
		factor = -1 # always accept
	}
	defender_ai_defeat_worth = {
		factor = 100
	}
	ai_will_do = {
		factor = 1
		modifier = {
			factor = 0
			FROM = {
				has_landed_title = k_witch_hunters_order
			}
			ROOT = {
				religion = sigmarite
			}
		}
	}
}

witch_hunter_forceinvestigation_cb = {
	name = CB_NAME_HUNTERINVESTIGATION
	war_name = WAR_NAME_HUNTERINVESTIGATION
	sprite = 7
	truce_days = 3650
	is_permanent = yes
	can_ask_to_join_war = no
	can_use = {
		ROOT = {
			trait = witch_hunter
			has_landed_title = k_witch_hunters_order
			wh_cb_pays_tribute_to_from_trigger = no
		}
		FROM = {
			independent = yes
			has_character_modifier = expelled_k_witch_hunters_order
		}
	}
	is_valid = {
		FROM = {
			has_character_modifier = expelled_k_witch_hunters_order
		}
	}
	on_success = {
		any_attacker = {
			limit = {
				character = ROOT
			}
			participation_scaled_prestige = 250
		}
		any_attacker = {
			limit = {
				NOT = {
					character = ROOT
				}
			}
			hidden_tooltip = {
				participation_scaled_prestige = 250
			}
		}
		any_defender = {
			imprison = ROOT
		}
		FROM = {
			remove_character_modifier = expelled_k_witch_hunters_order
		}
	}
	on_fail = {
		ROOT = {
			prestige = -125
		}
		FROM = {
			prestige = 50
		}
	}
	on_reverse_demand = {
		any_defender = {
			limit = {
				character = FROM
			}
			participation_scaled_prestige = 250
		}
		any_defender = {
			limit = {
				NOT = {
					character = FROM
				}
			}
			hidden_tooltip = {
				participation_scaled_prestige = 250
			}
		}
		ROOT = {
			prestige = -250
			imprison = FROM
		}
	}
	attacker_ai_victory_worth = {
		factor = -1 # always accept
	}
	attacker_ai_defeat_worth = {
		factor = 100
	}
	defender_ai_victory_worth = {
		factor = -1 # always accept
	}
	defender_ai_defeat_worth = {
		factor = 100
	}
	ai_will_do = {
		factor = 1
		modifier = {
			factor = 3
			ROOT = {
				trait = zealous
			}
		}
	}
}

# Vapire
vlad_subjugation = {
	name = CB_NAME_PAGAN_SUBJUGATION
	war_name = WAR_NAME_PAGAN_SUBJUGATION
	sprite = 8
	truce_days = 3650
	hostile_against_others = yes
	is_permanent = yes
	can_ask_to_join_war = yes
	allow_whitepeace = no
	can_call_allies = yes
	check_de_jure_tier = KING # this scans all de jure kingdoms for the counties which are held by or vassals(or below) of selected character. Only valid if is_permanent = yes
	# battle_warscore_mult = 0.1
	can_use = {
		ROOT = {
			has_artifact = carstein_ring
			NOT = {
				same_realm = FROM
			}
			NOT = {
				trait = vampire_necrarch_visible
			}
			NOT = {
				is_liege_or_above = FROM
			}
			primary_title = {
				higher_tier_than = KING
			}
			# has_horde_culture = no # This is chaos cb
		}
		FROM = {
			# vlad can subjugate people of the old world religions only
			religion_group = old_world_group
			NOT = {
				any_war = {
					defender = {
						character = FROM
					}
					using_cb = pagan_subjugation
				}
			}
		}
	}
	can_use_title = {
		wh_cb_albion_check_trigger = yes
		NOT = {
			region = world_underempire
		}
		ROOT = {
			has_artifact = carstein_ring
		}
	}
	is_valid = {
		ROOT = {
			primary_title = {
				higher_tier_than = KING
			}
		}
	}
	is_valid_title = {
		FROM = {
			any_realm_title = {
				de_jure_liege_or_above = PREVPREV
			}
		}
	}
	on_add = {
		FROM = {
			letter_event = {
				id = vladsub.1
			}
		}
	}
	on_add_title = {
		ROOT = {
		}
	}
	on_success = {
		ROOT = {
			piety = 100
		}
		any_attacker = {
			limit = {
				character = ROOT
			}
			participation_scaled_prestige = 100
		}
		any_attacker = {
			limit = {
				NOT = {
					character = ROOT
				}
			}
			hidden_tooltip = {
				participation_scaled_prestige = 100
			}
		}
		FROM = {
			piety = -100
			prestige = -100
			any_vassal = {
				if = {
					limit = {
						primary_title = {
							higher_tier_than = DUKE
						}
						controls_religion = no
					}
					set_defacto_liege = ROOT
					hidden_tooltip = {
						opinion = {
							modifier = opinion_subjugated_vlad
							who = ROOT
							months = 120
						}
					}
				}
			}
			primary_title = {
				if = {
					limit = {
						higher_tier_than = KING
					}
					destroy_landed_title = THIS
				}
			}
			set_defacto_liege = ROOT
			hidden_tooltip = {
				opinion = {
					modifier = opinion_subjugated_vlad
					who = ROOT
					months = 120
				}
			}
			# we don't have reformed religions
			# if = {
			# 	limit = {
			# 		is_reformed_religion = ROOT
			# 		controls_religion = no
			# 	}
			# 	religion = ROOT # Reformed pagans are forced to convert back
			# }
		}
	}
	on_fail = {
		FROM = {
			piety = 50
		}
		any_defender = {
			limit = {
				character = FROM
			}
			participation_scaled_prestige = 50
		}
		any_defender = {
			limit = {
				NOT = {
					character = FROM
				}
			}
			hidden_tooltip = {
				participation_scaled_prestige = 50
			}
		}
		ROOT = {
			piety = -100
		}
	}
	on_reverse_demand = {
		ROOT = {
			piety = -200
			transfer_scaled_wealth = {
				to = FROM
				value = 2.0
			}
		}
		FROM = {
			piety = 100
		}
		any_defender = {
			limit = {
				character = FROM
			}
			participation_scaled_prestige = 100
		}
		any_defender = {
			limit = {
				NOT = {
					character = FROM
				}
			}
			hidden_tooltip = {
				participation_scaled_prestige = 100
			}
		}
		any_defender = {
			set_character_flag = imperial_hero
		}
	}
	attacker_ai_victory_worth = {
		factor = 200
	}
	attacker_ai_defeat_worth = {
		factor = 100
	}
	defender_ai_victory_worth = {
		factor = -1 # always accept
	}
	defender_ai_defeat_worth = {
		factor = 100
	}
}

# The Prepared Invasion CB of Strigoi and Strigany
strigoi_invasion = {
	name = CB_NAME_STRIGOI_INVASION
	war_name = WAR_NAME_STRIGOI_INVASION
	sprite = 8
	truce_days = 3650
	hostile_against_others = yes
	is_permanent = yes
	is_holy_war = yes
	can_ask_to_join_war = yes
	can_call_allies = yes
	check_de_jure_tier = KING # this scans all de jure kingdoms for the counties which are held by or vassals(or below) of selected character. Only valid if is_permanent = yes
	apply_short_occ_mod = no # Do not apply the 'recently_conquered'	modifier to Holdings
	can_use = {
		FROM = {
			NOT = {
				culture_group = strigany_group
			}
		}
		ROOT = {
			has_character_flag = preparing_strygos_invasion
			NOT = {
				is_liege_or_above = FROM
			}
		}
	}
	on_add = {
		ROOT = {
			remove_character_modifier = preparing_strygos_invasion
			add_character_modifier = {
				modifier = attempted_strygos_invasion
				duration = 3651
			}
		}
	}
	can_use_title = {
		wh_cb_albion_check_trigger = yes
		NOT = {
			region = world_underempire
		}
		capital_scope = {
			region = world_badlands_strygos
		}
	}
	is_valid_title = {
		FROM = {
			any_realm_title = {
				de_jure_liege_or_above = PREVPREV
			}
		}
	}
	on_success = {
		ROOT = {
			prestige = 500
			piety = 250
			clr_character_flag = preparing_strygos_invasion
		}
		any_attacker = {
			limit = {
				character = ROOT
			}
			participation_scaled_prestige = 300
		}
		any_attacker = {
			limit = {
				NOT = {
					character = ROOT
				}
			}
			hidden_tooltip = {
				participation_scaled_prestige = 300
			}
		}
		FROM = {
			prestige = -500
		}
	}
	on_success_title = {
		custom_tooltip = {
			text = tribal_invasion_succ_tip
			hidden_tooltip = {
				FROM = {
					random_realm_province = {
						limit = {
							de_jure_liege_or_above = PREVPREV
							OR = {
								NOT = {
									culture = ROOT
								}
								NOT = {
									religion = ROOT
								}
							}
						}
						culture = ROOT
						religion = ROOT
					}
				}
				ROOT = {
					occupy_minors_of_occupied_settlements = FROM
					gain_all_occupied_titles = {
						who = FROM
						type = invasion
					}
					vassalize_or_take_under_title_destroy_duchies = {
						title = PREV
						enemy = FROM
						type = invasion
					}
					# Settle the special invasion forces
					disband_event_forces = prepared_invasion
					any_demesne_title = {
						limit = {
							tier = BARON
						}
						remove_holding_modifier = recently_conquered
						refill_holding_levy = yes
					}
				}
				if = {
					limit = {
						FROM = {
							is_liege_or_above = ROOT
						}
					}
					FROM = {
						imprison = ROOT
					}
				}
			}
		}
	}
	on_fail = {
		FROM = {
			prestige = 200
		}
		any_defender = {
			limit = {
				character = FROM
			}
			participation_scaled_prestige = 200
		}
		any_defender = {
			limit = {
				NOT = {
					character = FROM
				}
			}
			hidden_tooltip = {
				participation_scaled_prestige = 200
			}
		}
		ROOT = {
			prestige = -300
			piety = -100
			clr_character_flag = preparing_strygos_invasion
			hidden_tooltip = {
				disband_event_forces = prepared_invasion
			}
		}
	}
	on_reverse_demand = {
		ROOT = {
			prestige = -500
			piety = -250
			transfer_scaled_wealth = {
				to = FROM
				value = 2.0
			}
			clr_character_flag = preparing_strygos_invasion
			hidden_tooltip = {
				disband_event_forces = prepared_invasion
			}
			religion_authority = {
				modifier = lost_viking_invasion
			}
		}
		FROM = {
			prestige = 300
		}
		any_defender = {
			limit = {
				character = FROM
			}
			participation_scaled_prestige = 250
		}
		any_defender = {
			limit = {
				NOT = {
					character = FROM
				}
			}
			hidden_tooltip = {
				participation_scaled_prestige = 250
			}
		}
	}
	attacker_ai_victory_worth = {
		factor = 200
	}
	attacker_ai_defeat_worth = {
		factor = 100
	}
	defender_ai_victory_worth = {
		factor = -1 # always accept
	}
	defender_ai_defeat_worth = {
		factor = 100
	}
}

strygan_reconquest = {
	name = CB_NAME_STRYGAN_REC
	war_name = WAR_NAME_STRYGAN_REC
	sprite = 17
	truce_days = 3650
	is_permanent = yes
	can_ask_to_join_war = yes
	can_call_allies = yes
	check_de_jure_tier = DUKE # this scans all dejure duchies for the counties which are held by or vassals(or below) of selected character. Only valid if is_permanent = yes
	can_use = {
		ROOT = {
			OR = {
				has_landed_title = e_strygos
				has_landed_title = e_strygos_2
			}
			independent = yes
			religion_group = necromantic_group
			NOT = {
				same_realm = FROM
			}
		}
	}
	can_use_title = {
		wh_cb_albion_check_trigger = yes
		NOT = {
			region = world_underempire
		}
		capital_scope = {
			region = world_badlands_strygos
		}
	}
	is_valid = {
		ROOT = {
			independent = yes
			NOT = {
				same_realm = FROM
			}
		}
	}
	on_success = {
		any_attacker = {
			limit = {
				character = ROOT
			}
			participation_scaled_prestige = 100
		}
		any_attacker = {
			limit = {
				NOT = {
					character = ROOT
				}
			}
			hidden_tooltip = {
				participation_scaled_prestige = 100
			}
		}
		FROM = {
			prestige = -100
		}
	}
	on_success_title = {
		custom_tooltip = {
			text = tribal_invasion_succ_tip
			hidden_tooltip = {
				ROOT = {
					vassalize_or_take_under_title = {
						title = PREV
						enemy = FROM
					}
				}
			}
		}
		if = {
			limit = {
				holder_scope = {
					character = FROM
				}
			}
			usurp_title_only = ROOT
		}
	}
	on_fail = {
		ROOT = {
			prestige = -150
		}
	}
	on_reverse_demand = {
		ROOT = {
			transfer_scaled_wealth = {
				to = FROM
				value = 4.0
			}
			ROOT = {
				prestige = -200
			}
		}
		any_defender = {
			participation_scaled_piety = 100
			participation_scaled_prestige = 200
		}
	}
	attacker_ai_victory_worth = {
		factor = -1 # always accept
	}
	attacker_ai_defeat_worth = {
		factor = 100
	}
	defender_ai_victory_worth = {
		factor = -1 # always accept
	}
	defender_ai_defeat_worth = {
		factor = 100
	}
	ai_will_do = {
		factor = 1
		modifier = {
			factor = 0
			FROM = {
				has_landed_title = k_witch_hunters_order
			}
			ROOT = {
				religion = sigmarite
			}
		}
	}
}

necrarch_thrall_raid = {
	name = CB_NAME_NECRARCH_TRHALLS_RAID
	war_name = WAR_NAME_NECRARCH_TRHALLS_RAID
	sprite = 7
	truce_days = 3650
	hostile_against_others = yes
	is_permanent = yes
	can_ask_to_join_war = yes
	can_call_allies = yes
	check_de_jure_tier = DUKE # this scans all de jure kingdoms for the counties which are held by or vassals(or below) of selected character. Only valid if is_permanent = yes
	battle_warscore_mult = 0.75
	allow_distant = yes # AI parameter
	can_use = {
		ROOT = {
			religion = nagashi
			is_undead_trigger = yes
		}
		FROM = {
			is_undead_trigger = no
		}
	}
	can_use_title = {
		wh_cb_albion_check_trigger = yes
		nor = {
			region = world_underempire
			region = world_nehekhara
		}
		# The attacker needs at least one county in the target kingdom, or a border, or be only two sea zones away from one of your counties
		any_direct_de_jure_vassal_title = {
			OR = {
				holder_scope = {
					OR = {
						character = ROOT
						is_liege_or_above = ROOT
					}
				}
				location = {
					any_neighbor_province = {
						OR = {
							AND = {
								has_owner = yes
								owner = {
									OR = {
										character = ROOT
										is_liege_or_above = ROOT
									}
								}
							}
							AND = {
								is_land = no
								any_neighbor_province = {
									OR = {
										AND = {
											has_owner = yes
											owner = {
												OR = {
													character = ROOT
													is_liege_or_above = ROOT
												}
											}
										}
										AND = {
											is_land = no
											any_neighbor_province = {
												owner = {
													OR = {
														character = ROOT
														is_liege_or_above = ROOT
													}
												}
											}
										}
									}
								}
							}
						}
					}
				}
			}
		}
	}
	is_valid = {
		wh_cb_root_not_same_realm_from_rigger = yes
	}
	on_add_title = {
	}
	on_success = {
		ROOT = {
			piety = 150
			participation_scaled_piety = 150
		}
		any_attacker = {
			limit = {
				NOT = {
					character = ROOT
				}
			}
			hidden_tooltip = {
				participation_scaled_prestige = 100
				participation_scaled_piety = 100
			}
		}
		FROM = {
			prestige = -300
		}
	}
	on_fail = {
		FROM = {
			prestige = 100
		}
		any_defender = {
			participation_scaled_piety = 100
			participation_scaled_prestige = 50
		}
		ROOT = {
			prestige = -300
		}
	}
	on_reverse_demand = {
		ROOT = {
			prestige = -300
			transfer_scaled_wealth = {
				to = FROM
				value = 2.0
			}
		}
		FROM = {
			prestige = 150
		}
		any_defender = {
			participation_scaled_prestige = 100
			participation_scaled_piety = 100
		}
	}
	attacker_ai_victory_worth = {
		factor = -1 # Always accept
	}
	attacker_ai_defeat_worth = {
		factor = 80
	}
	defender_ai_victory_worth = {
		factor = -1 # Always accept
	}
	defender_ai_defeat_worth = {
		factor = 80
	}
	ai_will_do = {
		factor = 1
		modifier = {
			factor = 3
			ROOT = {
				trait = greedy
			}
		}
		modifier = {
			factor = 3
			ROOT = {
				trait = mystic
			}
		}
		modifier = {
			factor = 3
			ROOT = {
				trait = impaler
			}
		}
	}
}

jade_eradication_conquest = {
	name = CB_NAME_ERADICATION_CONQUEST
	war_name = WAR_NAME_ERADICATION_CONQUEST
	sprite = 6
	truce_days = 5000
	hostile_against_others = yes
	is_permanent = yes
	can_ask_to_join_war = yes
	can_call_allies = yes
	check_de_jure_tier = DUKE # this scans all de jure kingdoms for the counties which are held by or vassals(or below) of selected character. Only valid if is_permanent = yes
	battle_warscore_mult = 0.1
	allow_distant = yes # AI parameter
	can_use = {
		ROOT = {
			trait = vampire_jade_visible
		}
		FROM = {
			NOT = {
				trait = vampire_jade_visible
			}
			is_within_diplo_range = ROOT
		}
	}
	can_use_title = {
		wh_cb_albion_check_trigger = yes
		nor = {
			region = world_underempire
			region = world_nehekhara
		}
	}
	is_valid = {
		wh_cb_root_not_same_realm_from_rigger = yes
	}
	on_add_title = {
	}
	on_success = {
		ROOT = {
			piety = 150
			participation_scaled_piety = 150
			capital_scope = {
				capital_holding = {
					add_building = ca_jade_stock_1
				}
			}
		}
		any_attacker = {
			limit = {
				NOT = {
					character = ROOT
				}
			}
			hidden_tooltip = {
				participation_scaled_prestige = 100
				participation_scaled_piety = 100
			}
		}
		FROM = {
			prestige = -300
		}
	}
	on_success_title = {
		any_de_jure_vassal_title = {
			limit = {
				tier = COUNT
				OR = {
					holder_scope = {
						character = FROM
					}
					holder_scope = {
						top_liege = {
							character = FROM
						}
					}
				}
				location = {
					NOT = {
						religion = vampiric
					}
					NOT = {
						culture = nehekharan
					}
				}
			}
			location = {
				add_province_modifier = {
					name = jade_mayhem
					duration = 900
				}
			}
		}
		custom_tooltip = {
			text = religious_cb_succ_tip
			hidden_tooltip = {
				ROOT = {
					vassalize_or_take_under_title = {
						title = PREV
						enemy = FROM
						same_religion = yes # Only vassalize rulers of my religion
						is_religious = yes
						type = holy_war
					}
				}
			}
		}
	}
	on_fail = {
		FROM = {
			prestige = 100
		}
		any_defender = {
			participation_scaled_piety = 100
			participation_scaled_prestige = 50
		}
		ROOT = {
			prestige = -300
		}
	}
	on_reverse_demand = {
		ROOT = {
			prestige = -300
			transfer_scaled_wealth = {
				to = FROM
				value = 2.0
			}
		}
		FROM = {
			prestige = 150
		}
		any_defender = {
			participation_scaled_prestige = 100
			participation_scaled_piety = 100
		}
	}
	attacker_ai_victory_worth = {
		factor = -1 # Always accept
	}
	attacker_ai_defeat_worth = {
		factor = 80
	}
	defender_ai_victory_worth = {
		factor = -1 # Always accept
	}
	defender_ai_defeat_worth = {
		factor = 80
	}
	ai_will_do = {
		factor = 1
		modifier = {
			factor = 3
			ROOT = {
				trait = ambitious
			}
		}
	}
}

cathayan_eradication_conquest = {
	name = CB_NAME_ERADICATION_CATHAYAN
	war_name = WAR_NAME_ERADICATION_CATHAYAN
	sprite = 6
	truce_days = 5000
	hostile_against_others = yes
	is_permanent = yes
	can_ask_to_join_war = yes
	can_call_allies = yes
	check_de_jure_tier = DUKE # this scans all de jure kingdoms for the counties which are held by or vassals(or below) of selected character. Only valid if is_permanent = yes
	battle_warscore_mult = 0.25
	allow_distant = yes # AI parameter
	can_use = {
		ROOT = {
			religion = draconite
			culture = cathayan
			is_living_human_trigger = yes
		}
		FROM = {
			NOT = {
				religion = draconite
			}
			trait = vampire_jade_visible
			is_within_diplo_range = ROOT
		}
	}
	can_use_title = {
		wh_cb_albion_check_trigger = yes
		nor = {
			region = world_underempire
			region = world_nehekhara
		}
	}
	is_valid = {
		wh_cb_root_not_same_realm_from_rigger = yes
	}
	on_add_title = {
	}
	on_success = {
		ROOT = {
			piety = 150
			participation_scaled_piety = 150
		}
		any_attacker = {
			limit = {
				NOT = {
					character = ROOT
				}
			}
			hidden_tooltip = {
				participation_scaled_prestige = 100
				participation_scaled_piety = 100
			}
		}
		FROM = {
			prestige = -300
			imprison = ROOT
		}
	}
	on_success_title = {
		custom_tooltip = {
			text = religious_cb_succ_tip
			hidden_tooltip = {
				ROOT = {
					vassalize_or_take_under_title = {
						title = PREV
						enemy = FROM
						same_religion = yes # Only vassalize rulers of my religion
						is_religious = yes
						type = holy_war
					}
				}
			}
		}
	}
	on_fail = {
		FROM = {
			prestige = 100
		}
		any_defender = {
			limit = {
				character = FROM
			}
			participation_scaled_piety = 100
			participation_scaled_prestige = 50
		}
		any_defender = {
			limit = {
				NOT = {
					character = FROM
				}
			}
			hidden_tooltip = {
				participation_scaled_piety = 100
				participation_scaled_prestige = 50
			}
		}
		ROOT = {
			prestige = -300
		}
	}
	on_reverse_demand = {
		ROOT = {
			prestige = -300
			transfer_scaled_wealth = {
				to = FROM
				value = 2.0
			}
		}
		FROM = {
			prestige = 150
		}
		any_defender = {
			limit = {
				character = FROM
			}
			participation_scaled_prestige = 100
			participation_scaled_piety = 100
		}
		any_defender = {
			limit = {
				NOT = {
					character = FROM
				}
			}
			hidden_tooltip = {
				participation_scaled_prestige = 100
				participation_scaled_piety = 100
			}
		}
	}
	attacker_ai_victory_worth = {
		factor = -1 # Always accept
	}
	attacker_ai_defeat_worth = {
		factor = 80
	}
	defender_ai_victory_worth = {
		factor = -1 # Always accept
	}
	defender_ai_defeat_worth = {
		factor = 80
	}
	ai_will_do = {
		factor = 1
		modifier = {
			factor = 3
			ROOT = {
				trait = ambitious
			}
		}
	}
}

cathayan_subjugation = {
	name = CB_NAME_CATHAYAN_SUBJUGATION
	war_name = WAR_NAME_CATHAYAN_SUBJUGATION
	sprite = 8
	truce_days = 7200
	hostile_against_others = yes
	is_permanent = yes
	can_ask_to_join_war = yes
	can_call_allies = yes
	check_de_jure_tier = KING # this scans all de jure kingdoms for the counties which are held by or vassals(or below) of selected character. Only valid if is_permanent = yes
	battle_warscore_mult = 0.75
	can_use = {
		ROOT = {
			religion = draconite
			OR = {
				culture = cathayan
				culture = living_jade
			}
			OR = {
				has_dynasty_flag = relinked_shashala_flag
				has_dynasty_flag = relinked_naparaya_flag
				AND = {
					has_dynasty_flag = link_with_cathay
					prestige = 500
					piety = 1000
				}
			}
			NOT = {
				same_realm = FROM
			}
			NOT = {
				trait = vampire_necrarch_visible
			}
			NOT = {
				is_liege_or_above = FROM
			}
			primary_title = {
				higher_tier_than = KING
			}
		}
		FROM = {
			NOT = {
				religion = draconite
			}
			NOT = {
				culture_group = orc_group
			}
			NOT = {
				culture_group = goblin_group
			}
			NOT = {
				any_war = {
					defender = {
						character = FROM
					}
					using_cb = pagan_subjugation
				}
			}
		}
	}
	is_valid = {
		ROOT = {
			primary_title = {
				higher_tier_than = KING
			}
		}
	}
	is_valid_title = {
		FROM = {
			any_realm_title = {
				de_jure_liege_or_above = PREVPREV
			}
		}
	}
	on_success = {
		ROOT = {
			piety = 100
		}
		any_attacker = {
			limit = {
				character = ROOT
			}
			participation_scaled_prestige = 100
		}
		any_attacker = {
			limit = {
				NOT = {
					character = ROOT
				}
			}
			hidden_tooltip = {
				participation_scaled_prestige = 100
			}
		}
		FROM = {
			piety = -100
			prestige = -100
			any_vassal = {
				if = {
					limit = {
						primary_title = {
							higher_tier_than = DUKE
						}
					}
					set_defacto_liege = ROOT
					hidden_tooltip = {
						opinion = {
							modifier = opinion_subjugated_other_rel
							who = ROOT
							months = 60
						}
					}
				}
			}
			primary_title = {
				if = {
					limit = {
						higher_tier_than = KING
					}
					destroy_landed_title = THIS
				}
			}
			set_defacto_liege = ROOT
			hidden_tooltip = {
				opinion = {
					modifier = opinion_subjugated_other_rel
					who = ROOT
					months = 60
				}
			}
		}
	}
	on_fail = {
		FROM = {
			piety = 50
		}
		any_defender = {
			limit = {
				character = FROM
			}
			participation_scaled_prestige = 50
		}
		any_defender = {
			limit = {
				NOT = {
					character = FROM
				}
			}
			hidden_tooltip = {
				participation_scaled_prestige = 50
			}
		}
		ROOT = {
			piety = -100
		}
	}
	on_reverse_demand = {
		ROOT = {
			piety = -200
			transfer_scaled_wealth = {
				to = FROM
				value = 2.0
			}
		}
		FROM = {
			piety = 100
		}
		any_defender = {
			limit = {
				character = FROM
			}
			participation_scaled_prestige = 100
		}
		any_defender = {
			limit = {
				NOT = {
					character = FROM
				}
			}
			hidden_tooltip = {
				participation_scaled_prestige = 100
			}
		}
		any_defender = {
			set_character_flag = imperial_hero
		}
	}
	attacker_ai_victory_worth = {
		factor = 200
	}
	attacker_ai_defeat_worth = {
		factor = 100
	}
	defender_ai_victory_worth = {
		factor = -1 # always accept
	}
	defender_ai_defeat_worth = {
		factor = 100
	}
}
