namespace = druchiiinv

# Umbrella event when started the preparation for an invasion (Druchii)
character_event = {
	id = druchiiinv.1
	hide_window = yes
	is_triggered_only = yes

	# the chain stops when the modifier expires
	trigger = {
		has_character_modifier = preparing_ulthuan_invasion
	}

	immediate = {
		random_list = {
			30 = {
				# Some troops
				character_event = {
					id = druchiiinv.6
					days = 40
					random = 15
				}
			}
			20 = {
				modifier = {
					factor = 1.25
					martial = 15
				}
				modifier = {
					factor = 1.25
					martial = 20
				}
				modifier = {
					factor = 1.25
					diplomacy = 15
				}
				modifier = {
					factor = 1.25
					diplomacy = 20
				}
				modifier = {
					factor = 1.25
					prestige = 1000
				}
				modifier = {
					factor = 0.75
					NOT = {
						martial = 10
					}
				}
				modifier = {
					factor = 0.5
					NOT = {
						martial = 7
					}
				}
				modifier = {
					factor = 0.75
					NOT = {
						diplomacy = 10
					}
				}
				modifier = {
					factor = 0.5
					NOT = {
						diplomacy = 7
					}
				}
				modifier = {
					factor = 0.5
					NOT = {
						prestige = 100
					}
				}
				# Famous Commander
				character_event = {
					id = druchiiinv.5
					days = 40
					random = 15
				}
			}
			10 = {
				modifier = {
					factor = 1.25
					martial = 15
				}
				modifier = {
					factor = 1.25
					martial = 20
				}
				modifier = {
					factor = 1.25
					diplomacy = 15
				}
				modifier = {
					factor = 1.25
					diplomacy = 20
				}
				modifier = {
					factor = 1.25
					prestige = 1000
				}
				modifier = {
					factor = 0.75
					NOT = {
						martial = 10
					}
				}
				modifier = {
					factor = 0.5
					NOT = {
						martial = 7
					}
				}
				modifier = {
					factor = 0.75
					NOT = {
						diplomacy = 10
					}
				}
				modifier = {
					factor = 0.5
					NOT = {
						diplomacy = 7
					}
				}
				modifier = {
					factor = 0.5
					NOT = {
						prestige = 100
					}
				}
				# More troops
				character_event = {
					id = druchiiinv.4
					days = 40
					random = 15
				}
			}
			40 = {
				# repeat each month until expirement
				character_event = {
					id = druchiiinv.1
					days = 40
					random = 15
				}
			}
		}
	}
}

# Ulthuan is under attack!
character_event = {
	id = druchiiinv.2
	desc = {
		text = EVTDESCA_druchiiinv.2
		trigger = {
			religion_group = cadai_group
		}
	}
	desc = {
		text = EVTDESCB_druchiiinv.2
		trigger = {
			religion_group = cytharai_group
		}
	}
	picture = GFX_evt_ulthuan_war
	border = GFX_event_normal_frame_war
	ai = no
	is_triggered_only = yes

	option = {
		trigger = {
			religion_group = cadai_group
		}
		name = EVTOPTAdruchiiinv.2
	}

	option = {
		trigger = {
			religion_group = cytharai_group
		}
		name = EVTOPTBdruchiiinv.2
	}
}

# You waited to long
character_event = {
	id = druchiiinv.3
	desc = {
		text = EVTDESCA_druchiiinv.3
		trigger = {
			religion_group = cadai_group
		}
	}
	desc = {
		text = EVTDESCB_druchiiinv.3
		trigger = {
			religion_group = cytharai_group
		}
	}
	picture = GFX_evt_ulthuan_war
	border = GFX_event_normal_frame_war
	is_triggered_only = yes

	# If you start the war, the event won't pop up
	trigger = {
		NOT = {
			any_war = {
				using_cb = ulthuan_invasion
			}
		}
	}

	option = {
		trigger = {
			religion_group = cadai_group
		}
		name = EVTOPTAdruchiiinv.3
		disband_event_forces = prepared_invasion
		clr_character_flag = preparing_druchii_invasion
		prestige = -1000
		add_character_modifier = {
			modifier = attempted_ulthuan_invasion
			duration = 3650
		}
	}

	option = {
		trigger = {
			religion_group = cytharai_group
		}
		name = EVTOPTBdruchiiinv.3
		disband_event_forces = prepared_invasion
		clr_character_flag = preparing_druchii_invasion
		prestige = -1000
		add_character_modifier = {
			modifier = attempted_ulthuan_invasion
			duration = 3650
		}
	}
}

# Troops flock to your banner
# The target character is in FROM
character_event = {
	id = druchiiinv.4
	desc = {
		text = EVTDESCA_druchiiinv.4
		trigger = {
			religion_group = cadai_group
		}
	}
	desc = {
		text = EVTDESCB_druchiiinv.4
		trigger = {
			religion_group = cytharai_group
		}
	}
	picture = GFX_evt_ulthuan_war
	border = GFX_event_normal_frame_war
	is_triggered_only = yes

	# the chain stops when the modifier expires
	trigger = {
		has_character_modifier = preparing_ulthuan_invasion
	}

	option = {
		name = EVTOPTBdruchiiinv.4
		capital_scope = {
			ROOT = {
				spawn_unit = {
					province = PREV
					owner = ROOT
					match_character = ROOT
					match_mult = 0.01
					earmark = prepared_invasion
					attrition = 1.0
				}
				spawn_fleet = {
					province = closest
					owner = ROOT
					match_character = ROOT
					match_mult = 0.01
					match_min = 7
					earmark = prepared_invasion
				}
			}
		}
		hidden_tooltip = {
			character_event = {
				id = druchiiinv.1
				days = 40
				random = 15
			}
		}
	}
}

# A hero and his retinue appear in your court
# The target character is in FROM
character_event = {
	id = druchiiinv.5
	desc = {
		text = EVTDESCA_druchiiinv.5
		trigger = {
			religion_group = cadai_group
		}
	}
	desc = {
		text = EVTDESCB_druchiiinv.5
		trigger = {
			religion_group = cytharai_group
		}
	}
	picture = GFX_evt_ulthuan_war
	border = GFX_event_normal_frame_war
	is_triggered_only = yes

	# the chain stops when the modifier expires
	trigger = {
		has_character_modifier = preparing_ulthuan_invasion
	}

	option = {
		name = EVTOPTBdruchiiinv.5
		capital_scope = {
			create_character = {
				random_traits = yes
				dynasty = random
				religion = ROOT
				culture = ROOT
				female = no
				age = 30
				attributes = {
					martial = 8
				}
				trait = brave
				trait = zealous
				trait = brilliant_strategist
				trait = holy_warrior
			}
			new_character = {
				spawn_unit = {
					province = PREV
					owner = ROOT
					match_character = ROOT
					match_mult = 0.015
					earmark = prepared_invasion
					attrition = 1.0
				}
			}
		}
		spawn_fleet = {
			province = closest
			owner = ROOT
			match_character = ROOT
			match_mult = 0.15
			match_min = 10
			earmark = prepared_invasion
		}
		hidden_tooltip = {
			character_event = {
				id = druchiiinv.1
				days = 40
				random = 15
			}
		}
	}
}

# A smaller force arrives for the invasion
# The target character is in FROM
character_event = {
	id = druchiiinv.6
	desc = {
		text = EVTDESCA_druchiiinv.6
		trigger = {
			religion_group = cadai_group
		}
	}
	desc = {
		text = EVTDESCB_druchiiinv.6
		trigger = {
			religion_group = cytharai_group
		}
	}
	picture = GFX_evt_ulthuan_war
	border = GFX_event_normal_frame_war
	is_triggered_only = yes

	# the chain stops when the modifier expires
	trigger = {
		has_character_modifier = preparing_ulthuan_invasion
	}

	option = {
		name = EVTOPTBdruchiiinv.6
		capital_scope = {
			ROOT = {
				spawn_unit = {
					province = PREV
					owner = ROOT
					match_character = ROOT
					match_mult = 0.0075
					earmark = prepared_invasion
					attrition = 1.0
				}
				spawn_fleet = {
					province = closest
					owner = ROOT
					match_character = ROOT
					match_mult = 0.0075
					match_min = 5
					earmark = prepared_invasion
				}
			}
		}
		hidden_tooltip = {
			character_event = {
				id = druchiiinv.1
				days = 40
				random = 15
			}
		}
	}
}

# Stupid AI, attack!
character_event = {
	id = druchiiinv.7
	hide_window = yes
	is_triggered_only = yes

	immediate = {
		e_ulthuan = {
			holder_scope = {
				ROOT = {
					war = {
						casus_belli = ulthuan_invasion
						target = PREVPREV # The top liege of the owner of the province
						thirdparty_title = PREV # The de jure kingdom
					}
				}
			}
		}
	}
}

# Feed to nauglir - (Jailer)
character_event = {
	id = druchiiinv.8
	desc = EVTDESCA_druchiiinv.8
	picture = GFX_evt_nauglir
	border = GFX_event_normal_frame_war
	is_triggered_only = yes

	option = {
		name = EVTOPTAdruchiiinv.8
		any_vassal = {
			limit = {
				nor = {
					trait = brave
					trait = quick
					trait = genius
				}
			}
			opinion = {
				modifier = opinion_scared_into_submission
				who = ROOT
			}
		}
		any_courtier = {
			limit = {
				nor = {
					trait = brave
					trait = quick
					trait = genius
				}
				is_ruler = no
			}
			opinion = {
				modifier = opinion_scared_into_submission
				who = ROOT
			}
		}
	}
}

# Feed to nauglir - (Victim)
character_event = {
	id = druchiiinv.9
	desc = EVTDESCA_druchiiinv.9
	picture = GFX_evt_nauglir
	border = GFX_event_normal_frame_war
	is_triggered_only = yes

	option = {
		name = EVTOPTAdruchiiinv.9
	}
}

# Feed to dragon - (Jailer)
character_event = {
	id = druchiiinv.10
	desc = EVTDESCA_druchiiinv.10
	picture = GFX_evt_dragon
	border = GFX_event_normal_frame_war
	is_triggered_only = yes

	option = {
		name = EVTOPTAdruchiiinv.10
		any_vassal = {
			limit = {
				nor = {
					trait = brave
					trait = quick
					trait = genius
				}
			}
			opinion = {
				modifier = opinion_scared_into_submission
				who = ROOT
			}
		}
		any_courtier = {
			limit = {
				nor = {
					trait = brave
					trait = quick
					trait = genius
				}
				is_ruler = no
			}
			opinion = {
				modifier = opinion_scared_into_submission
				who = ROOT
			}
		}
	}
}

# Feed to dragon - (Victim)
character_event = {
	id = druchiiinv.11
	desc = EVTDESCA_druchiiinv.11
	picture = GFX_evt_dragon
	border = GFX_event_normal_frame_war
	is_triggered_only = yes

	option = {
		name = EVTOPTAdruchiiinv.11
	}
}

# Feed to gryphon - (Jailer)
character_event = {
	id = druchiiinv.12
	desc = EVTDESCA_druchiiinv.12
	picture = GFX_evt_gryphon
	border = GFX_event_normal_frame_war
	is_triggered_only = yes

	option = {
		name = EVTOPTAdruchiiinv.12
		any_vassal = {
			limit = {
				nor = {
					trait = brave
					trait = quick
					trait = genius
				}
			}
			opinion = {
				modifier = opinion_scared_into_submission
				who = ROOT
			}
		}
		any_courtier = {
			limit = {
				nor = {
					trait = brave
					trait = quick
					trait = genius
				}
				is_ruler = no
			}
			opinion = {
				modifier = opinion_scared_into_submission
				who = ROOT
			}
		}
	}
}

# Feed to gryphon - (Victim)
character_event = {
	id = druchiiinv.13
	desc = EVTDESCA_druchiiinv.13
	picture = GFX_evt_gryphon
	border = GFX_event_normal_frame_war
	is_triggered_only = yes

	option = {
		name = EVTOPTAdruchiiinv.13
	}
}

# Feed to wyvern - (Jailer)
character_event = {
	id = druchiiinv.12005
	desc = EVTDESCA_druchiiinv.12005
	picture = GFX_evt_wyvern
	border = GFX_event_normal_frame_war
	is_triggered_only = yes

	option = {
		name = EVTOPTAdruchiiinv.12005
		any_vassal = {
			limit = {
				nor = {
					trait = brave
					trait = quick
					trait = genius
				}
			}
			opinion = {
				modifier = opinion_scared_into_submission
				who = ROOT
			}
		}
		any_courtier = {
			limit = {
				nor = {
					trait = brave
					trait = quick
					trait = genius
				}
				is_ruler = no
			}
			opinion = {
				modifier = opinion_scared_into_submission
				who = ROOT
			}
		}
	}
}

# Feed to wyvern - (Victim)
character_event = {
	id = druchiiinv.13005
	desc = EVTDESCA_druchiiinv.13005
	picture = GFX_evt_wyvern
	border = GFX_event_normal_frame_war
	ai = no
	is_triggered_only = yes

	option = {
		name = EVTOPTAdruchiiinv.13005
	}
}

# Malekith dies (ping)
character_event = {
	id = druchiiinv.14
	hide_window = yes
	is_triggered_only = yes

	trigger = {
		trait = malekith
	}

	immediate = {
		killer = {
			long_character_event = {
				id = druchiiinv.15
			}
		}
		# destroy the Empire
		current_heir = {
			character_event = {
				id = druchiiinv.20 days = 24 random = 15
			}
		}
	}
}

# Malekith dies (killer)
long_character_event = {
	id = druchiiinv.15
	title = EVTTITLE_druchiiinv.15
	desc = {
		text = EVTDESCA_druchiiinv.15
		trigger = {
			is_female = yes
			wh_has_any_magic_potential_reveal_trigger = yes
		}
	}
	desc = {
		text = EVTDESCB_druchiiinv.15
		trigger = {
			is_female = no
			wh_has_any_magic_potential_reveal_trigger = yes
		}
	}
	desc = {
		text = EVTDESCC_druchiiinv.15
		trigger = {
			wh_has_any_magic_potential_reveal_trigger = no
		}
	}
	picture = GFX_evt_malekith
	border = GFX_event_long_frame_war
	is_triggered_only = yes

	option = {
		name = EVTOPTAdruchiiinv.15
		prestige = 500
	}
}

# Malekith cracks on factions
character_event = {
	id = druchiiinv.16
	desc = EVTDESCA_druchiiinv.16
	picture = GFX_evt_malekith
	border = GFX_event_normal_frame_war
	ai = no
	is_triggered_only = yes

	option = {
		name = EVTOPTAdruchiiinv.16
	}
}

# A Druchii is under Malekith, not hiding his magical capabilities
character_event = {
	id = druchiiinv.17
	hide_window = yes
	only_men = yes
	capable_only = yes

	trigger = {
		trait = creature_elf
		is_female = no
		nor = {
			trait = in_hiding
			trait = malekith
		}
		independent = no
		top_liege = {
			trait = malekith
		}
		OR = {
			wh_is_mage_trigger = yes
			wh_has_any_magic_potential_reveal_trigger = yes
		}
	}

	mean_time_to_happen = {
		months = 60
		modifier = {
			factor = 3
			trait = magic_potential_1
		}
		modifier = {
			factor = 2
			trait = magic_potential_2
		}
		modifier = {
			factor = 1.75
			trait = magic_potential_3
		}
		modifier = {
			factor = 1.5
			trait = magic_potential_4
		}
		modifier = {
			factor = 1.25
			has_character_modifier = magic_power_1
		}
		modifier = {
			factor = 0.75
			has_character_modifier = magic_power_2
		}
		modifier = {
			factor = 0.5
			has_character_modifier = magic_power_3
		}
		modifier = {
			factor = 0.25
			has_character_modifier = magic_power_4
		}
	}

	immediate = {
		character_event = {
			id = druchiiinv.18
		}
	}
}

character_event = {
	id = druchiiinv.18
	desc = {
		text = EVTDESCA_druchiiinv.18
		trigger = {
			FROM = {
				father = {
					NOT = {
						character = ROOT
					}
				}
			}
		}
	}
	desc = {
		text = EVTDESCB_druchiiinv.18
		trigger = {
			FROM = {
				father = {
					character = ROOT
				}
			}
		}
	}
	picture = GFX_evt_malekith
	is_triggered_only = yes

	option = {
		name = EVTOPTAdruchiiinv.18
		trigger = {
			FROM = {
				father = {
					NOT = {
						character = ROOT
					}
				}
			}
		}
		character_event = {
			id = druchiiinv.19
		}
	}

	option = {
		name = EVTOPTBdruchiiinv.18
		trigger = {
			FROM = {
				father = {
					character = ROOT
				}
			}
		}
		character_event = {
			id = druchiiinv.19
		}
	}
}

character_event = {
	id = druchiiinv.19
	desc = EVTDESCA_druchiiinv.19
	picture = GFX_evt_malekith
	is_triggered_only = yes

	option = {
		name = EVTOPTAdruchiiinv.19
		if = {
			limit = {
				is_invincible_trigger = yes
			}
			antideath_effect = yes
			break = yes
		}
		death = {
			death_reason = death_execution
		}
	}
}

# Malekith dies - Naggaroth dissolves into infighting
character_event = {
	id = druchiiinv.20
	desc = EVTDESCA_druchiiinv.20
	picture = GFX_evt_malekith
	border = GFX_event_normal_frame_war
	is_triggered_only = yes

	option = {
		name = EVTOPTAdruchiiinv.20
		prestige = -200
		e_naggaroth = {
			destroy_landed_title = THIS
		}
		hidden_tooltip = {
			set_government_type = druchii_government
		}
	}
}

# Malekith loses the title - Naggaroth dissolves into infighting
# ROOT is the new holder, FROM is the title, FROMFROM is the old holder
character_event = {
	id = druchiiinv.21
	desc = EVTDESCA_druchiiinv.21
	picture = GFX_evt_malekith
	border = GFX_event_normal_frame_war
	is_triggered_only = yes

	trigger = {
		FROMFROM = {
			trait = malekith
		}
		FROM = {
			title = e_naggaroth
		}
	}

	option = {
		name = EVTOPTAdruchiiinv.21
		prestige = -200
		if = {
			limit = {
				any_vassal = {
					has_landed_title = d_blackguard
				}
			}
			d_blackguard = {
				set_government_type = druchii_government
				destroy_landed_title = THIS
			}
		}
		e_naggaroth = {
			set_government_type = druchii_government
			destroy_landed_title = THIS
		}
	}
}

# All druchii males are asked to serve a 100 years in the blackguards.
character_event = {
	id = druchiiinv.22
	desc = EVTDESCdruchiiinv22
	picture = "GFX_evt_dark_elf_soldiers"
	border = GFX_event_normal_frame_religion
	only_men = yes
	only_capable = yes
	prisoner = no
	religion = cytharai
	is_triggered_only = yes

	trigger = {
		NOT = {
			trait = disinherited
		}
		trait = creature_elf
		is_ruler = no
		is_heretic = no
		is_title_active = d_blackguard
		is_title_active = e_naggaroth
		liege = {
			holy_order = no
			liege = {
				holy_order = no
			}
		}
	}

	option = {
		name = EVTOPTAdruchiiinv22
		ai_chance = {
			factor = 100
		}
		liege = {
			character_event = {
				id = druchiiinv.22001
			}
		}
	}
}

# Young elf should be drafted
character_event = {
	id = druchiiinv.22001
	desc = EVTDESCdruchiiinv22001
	picture = "GFX_evt_dark_elf_soldiers"
	border = GFX_event_normal_frame_religion
	is_triggered_only = yes

	option = {
		name = EVTOPTAdruchiiinv22001
		ai_chance = {
			factor = 100
		}
		piety = 50
		FROM = {
			character_event = {
				id = druchiiinv.22002
			}
		}
	}

	option = {
		name = EVTOPTBdruchiiinv22001
		wealth = -200
		piety = -150
		prestige = -100
		FROM = {
			character_event = {
				id = druchiiinv.22003
			}
		}
	}
}

# Young elf joins the blackguard
character_event = {
	id = druchiiinv.22002
	desc = EVTDESCdruchiiinv22002
	picture = "GFX_evt_dark_elf_soldiers"
	border = GFX_event_normal_frame_religion
	is_triggered_only = yes

	option = {
		name = EXCELLENT
		hidden_tooltip = {
			random_list = {
				70 = {
					modifier = {
						factor = 0.5
						trait = fragile
					}
					modifier = {
						factor = 0.75
						trait = weak
					}
					modifier = {
						factor = 0.85
						trait = soft
					}
					modifier = {
						factor = 1.25
						trait = hardy
					}
					modifier = {
						factor = 1.5
						trait = tough
					}
					modifier = {
						factor = 1.75
						trait = strong
					}
					modifier = {
						factor = 0.5
						trait = craven
					}
					modifier = {
						factor = 1.15
						trait = diligent
					}
					modifier = {
						factor = 0.85
						trait = drunkard
					}
					modifier = {
						factor = 0.85
						trait = addict
					}
					modifier = {
						factor = 1.75
						trait = brave
					}
					modifier = {
						factor = 0.85
						trait = fat
					}
					modifier = {
						factor = 0.85
						trait = undernourished
					}
					modifier = {
						factor = 1.5
						trait = ambitious
					}
					modifier = {
						factor = 0.85
						trait = content
					}
					modifier = {
						factor = 1.85
						trait = duelist
					}
					modifier = {
						factor = 1.5
						trait = hunter
					}
					modifier = {
						factor = 0.5
						trait = wounded
					}
					modifier = {
						factor = 0.25
						trait = maimed
					}
					modifier = {
						factor = 0.75
						trait = infirm
					}
					modifier = {
						factor = 0.25
						trait = blinded
					}
					modifier = {
						factor = 1.25
						trait = tall
					}
					modifier = {
						factor = 0.5
						trait = dwarf
					}
					modifier = {
						factor = 0.5
						trait = hunchback
					}
					modifier = {
						factor = 0.75
						trait = clubfooted
					}
					modifier = {
						factor = 1.25
						martial = 15
					}
					modifier = {
						factor = 0.85
						trait = stressed
					}
					modifier = {
						factor = 0.75
						trait = depressed
					}
					modifier = {
						factor = 0.95
						trait = dim
					}
					modifier = {
						factor = 0.9
						trait = dumb
					}
					modifier = {
						factor = 0.85
						trait = slow
					}
					modifier = {
						factor = 0.8
						trait = idiot
					}
					modifier = {
						factor = 0.75
						trait = imbecile
					}
					modifier = {
						factor = 1.15
						trait = bright
					}
					modifier = {
						factor = 1.2
						trait = smart
					}
					modifier = {
						factor = 1.25
						trait = quick
					}
					modifier = {
						factor = 1.3
						trait = brilliant
					}
					modifier = {
						factor = 1.35
						trait = genius
					}
					modifier = {
						factor = 0.85
						trait = slothful
					}
					modifier = {
						factor = 0.9
						trait = kind
					}
					modifier = {
						factor = 0.9
						trait = humble
					}
					modifier = {
						factor = 0.9
						trait = shy
					}
					modifier = {
						factor = 1.1
						trait = misguided_warrior
					}
					modifier = {
						factor = 1.35
						trait = tough_soldier
					}
					modifier = {
						factor = 1.5
						trait = skilled_tactician
					}
					modifier = {
						factor = 1.75
						trait = brilliant_strategist
					}
					modifier = {
						factor = 1.35
						trait = zealous
					}
					modifier = {
						factor = 1.15
						trait = cruel
					}
					modifier = {
						factor = 0.95
						trait = just
					}
					modifier = {
						factor = 0.85
						trait = complacent
					}
					modifier = {
						factor = 1.5
						trait = robust
					}
					modifier = {
						factor = 0.75
						trait = feeble
					}
					character_event = {
						id = druchiiinv.22004 days = 18750
					}
				}
				30 = {
					character_event = {
						id = druchiiinv.22006
						days = 2150
						random = 1500
					}
				}
			}

		}
		d_blackguard = {
			holder_scope = {
				ROOT = {
					move_character = PREV
					hidden_tooltip = {
						clear_wealth = PREV
					}
					spouse = {
						remove_spouse = spouse
						hidden_tooltip = {
							character_event = {
								id = SoA.2863
							}
						}
					}
					add_trait = disinherited
					any_spouse = {
						remove_spouse = PREV
					}
					if = {
						limit = {
							trait = in_hiding
						}
						remove_trait = in_hiding
						clr_character_flag = do_not_disturb
						add_character_modifier = {
							name = went_out_of_hiding_timer
							duration = 180
							hidden = yes
						}
						# Notify plotters and family
						hidden_tooltip = {
							character_event = {
								id = CM.6400
							}
						}
					}
				}
			}
		}
	}
}

# Liege buys his son's way out of the draft
character_event = {
	id = druchiiinv.22003
	desc = EVTDESCdruchiiinv22003
	picture = "GFX_evt_dark_elf_soldiers"
	border = GFX_event_normal_frame_religion
	is_triggered_only = yes

	option = {
		name = EVTOPTAdruchiiinv22003
		e_naggaroth = {
			holder_scope = {
				opinion = {
					who = FROM
					modifier = opinion_refused_request_holy_order
				}
			}
		}
	}
}

# 50 years have passed, do you want to come back?
character_event = {
	id = druchiiinv.22004
	desc = EVTDESCdruchiiinv22004
	picture = "GFX_evt_dark_elf_soldiers"
	border = GFX_event_normal_frame_religion
	is_triggered_only = yes

	immediate = {
		random = {
			chance = 30
			add_trait = cruel
		}
		random = {
			chance = 30
			add_trait = brave
		}
		random = {
			chance = 10
			add_trait = robust
		}
		random = {
			chance = 5
			add_trait = zealous
		}
		random = {
			chance = 50
			add_trait = scarred
		}
		random = {
			chance = 5
			add_trait = maimed
		}
		random = {
			chance = 5
			change_variable = {
				which = "lunatic_counter"
				value = 4
			}
			# lunacy counter
			hidden_tooltip = {
				character_event = {
					id = mutation.1005
				}
			}
		}
	}

	option = {
		name = EVTOPTAdruchiiinv22004
		prestige = 100
		add_trait = druchi_black_guard
		remove_trait = disinherited
		hidden_tooltip = {
			if = {
				limit = {
					is_close_relative = FROMFROM
				}
				FROMFROM = {
					character_event = {
						id = druchiiinv.22005 days = 15 random = 7
					}
				}
			}
		}
		ai_chance = {
			factor = 30
			modifier = {
				factor = 0.25
				trait = craven
			}
			modifier = {
				factor = 0.75
				trait = ambitious
			}
			modifier = {
				factor = 0.75
				trait = deceitful
			}
		}
	}

	option = {
		name = EVTOPTBdruchiiinv22004
		move_character = FROMFROM
		remove_trait = disinherited
		prestige = -50
		ai_chance = {
			factor = 70
			modifier = {
				factor = 0.75
				trait = brave
			}
			modifier = {
				factor = 0.75
				trait = content
			}
			modifier = {
				factor = 0.75
				trait = shy
			}
		}
	}
}

# Notify liege the relative is not coming back
character_event = {
	id = druchiiinv.22005
	desc = EVTDESCdruchiiinv22005
	picture = "GFX_evt_dark_elf_soldiers"
	border = GFX_event_normal_frame_religion
	is_triggered_only = yes

	option = {
		name = EVTOPTAdruchiiinv22005
	}
}

# Druchii blackguard dies during draft
character_event = {
	id = druchiiinv.22006
	desc = EVTDESCdruchiiinv22006
	picture = "GFX_evt_dark_elf_soldiers"
	border = GFX_event_normal_frame_religion
	is_triggered_only = yes

	option = {
		name = EVTOPTAdruchiiinv22006
		death = {
			death_reason = death_battle
		}
	}
}

# Young elf wants to be a Witch
character_event = {
	id = druchiiinv.23
	desc = EVTDESCdruchiiinv23
	picture = "GFX_evt_witch_elf"
	border = GFX_event_normal_frame_religion
	is_triggered_only = yes

	option = {
		name = EVTOPTAdruchiiinv23
		ai_chance = {
			factor = 100
		}
		piety = 50
		FROM = {
			character_event = {
				id = druchiiinv.23001
			}
		}
	}

	option = {
		name = EVTOPTBdruchiiinv23
		piety = -250
	}
}

# Become witch, start training.
character_event = {
	id = druchiiinv.23001
	desc = EVTDESCdruchiiinv23001
	picture = "GFX_evt_witch_elf"
	border = GFX_event_normal_frame_religion
	is_triggered_only = yes

	immediate = {
		any_lover = {
			remove_lover = ROOT
		}
		any_spouse = {
			remove_spouse = ROOT
		}
		add_trait = druchi_witch_elf
		random = {
			chance = 15
			add_trait = zealous
		}
		clear_wealth = ROOT
		religion = cytharai
	}

	option = {
		name = EVTOPTAdruchiiinv23001
		hidden_tooltip = {
			random_list = {
				65 = {
					modifier = {
						factor = 1.5
						trait = zealous
					}
					modifier = {
						factor = 0.75
						trait = cynical
					}
					modifier = {
						factor = 0.5
						trait = fragile
					}
					modifier = {
						factor = 0.75
						trait = weak
					}
					modifier = {
						factor = 0.85
						trait = soft
					}
					modifier = {
						factor = 1.25
						trait = hardy
					}
					modifier = {
						factor = 1.5
						trait = tough
					}
					modifier = {
						factor = 1.75
						trait = strong
					}
					modifier = {
						factor = 0.5
						trait = craven
					}
					modifier = {
						factor = 1.15
						trait = diligent
					}
					modifier = {
						factor = 0.85
						trait = drunkard
					}
					modifier = {
						factor = 0.85
						trait = addict
					}
					modifier = {
						factor = 1.75
						trait = brave
					}
					modifier = {
						factor = 0.85
						trait = fat
					}
					modifier = {
						factor = 0.85
						trait = undernourished
					}
					modifier = {
						factor = 1.5
						trait = ambitious
					}
					modifier = {
						factor = 0.85
						trait = content
					}
					modifier = {
						factor = 1.85
						trait = duelist
					}
					modifier = {
						factor = 1.5
						trait = hunter
					}
					modifier = {
						factor = 0.5
						trait = wounded
					}
					modifier = {
						factor = 0.25
						trait = maimed
					}
					modifier = {
						factor = 0.75
						trait = infirm
					}
					modifier = {
						factor = 0.25
						trait = blinded
					}
					modifier = {
						factor = 1.25
						trait = tall
					}
					modifier = {
						factor = 0.5
						trait = dwarf
					}
					modifier = {
						factor = 0.5
						trait = hunchback
					}
					modifier = {
						factor = 0.75
						trait = clubfooted
					}
					modifier = {
						factor = 1.25
						martial = 15
					}
					modifier = {
						factor = 0.85
						trait = stressed
					}
					modifier = {
						factor = 0.75
						trait = depressed
					}
					modifier = {
						factor = 0.95
						trait = dim
					}
					modifier = {
						factor = 0.9
						trait = dumb
					}
					modifier = {
						factor = 0.85
						trait = slow
					}
					modifier = {
						factor = 0.8
						trait = idiot
					}
					modifier = {
						factor = 0.75
						trait = imbecile
					}
					modifier = {
						factor = 1.15
						trait = bright
					}
					modifier = {
						factor = 1.2
						trait = smart
					}
					modifier = {
						factor = 1.25
						trait = quick
					}
					modifier = {
						factor = 1.3
						trait = brilliant
					}
					modifier = {
						factor = 1.35
						trait = genius
					}
					modifier = {
						factor = 0.85
						trait = slothful
					}
					modifier = {
						factor = 0.9
						trait = kind
					}
					modifier = {
						factor = 0.9
						trait = humble
					}
					modifier = {
						factor = 0.9
						trait = shy
					}
					modifier = {
						factor = 1.1
						trait = misguided_warrior
					}
					modifier = {
						factor = 1.35
						trait = tough_soldier
					}
					modifier = {
						factor = 1.5
						trait = skilled_tactician
					}
					modifier = {
						factor = 1.75
						trait = brilliant_strategist
					}
					modifier = {
						factor = 1.35
						trait = zealous
					}
					modifier = {
						factor = 1.15
						trait = cruel
					}
					modifier = {
						factor = 0.95
						trait = just
					}
					modifier = {
						factor = 0.85
						trait = complacent
					}
					modifier = {
						factor = 1.5
						trait = robust
					}
					modifier = {
						factor = 0.75
						trait = feeble
					}
					# End training
					character_event = {
						id = druchiiinv.23003
						days = 3650
					}
					random = {
						chance = 45
						character_event = {
							id = druchiiinv.23004 days = 350 random = 150
						}
					} # cruel
					random = {
						chance = 35
						character_event = {
							id = druchiiinv.23005 days = 650 random = 150
						}
					} # brave
					random = {
						chance = 30
						character_event = {
							id = druchiiinv.23006 days = 750 random = 250
						}
					} # robust
					random = {
						chance = 60
						character_event = {
							id = druchiiinv.23007 days = 950 random = 450
						}
					} # zealous
					random = {
						chance = 25
						character_event = {
							id = druchiiinv.23008 days = 1150 random = 350
						}
					} # scarred
					random = {
						chance = 20
						character_event = {
							id = druchiiinv.23009 days = 150 random = 650
						}
					} # homosexual
					random = {
						chance = 60
						character_event = {
							id = druchiiinv.23010 days = 1350 random = 250
						}
					} # martial1
					random = {
						chance = 30
						character_event = {
							id = druchiiinv.23010 days = 1650 random = 550
						}
					} # martial2
					random = {
						chance = 15
						character_event = {
							id = druchiiinv.23010 days = 1650 random = 750
						}
					} # martial3
					random = {
						chance = 5
						character_event = {
							id = druchiiinv.23010 days = 1950 random = 850
						}
					} # martial4
					random = {
						chance = 5
						character_event = {
							id = druchiiinv.23011 days = 1450 random = 650
						}
					} # maimed
					random = {
						chance = 60
						character_event = {
							id = druchiiinv.23012 days = 2150 random = 750
						}
					} # lunatic
					random = {
						chance = 30
						character_event = {
							id = druchiiinv.23012 days = 2150 random = 750
						}
					} # lunatic
					random = {
						chance = 15
						character_event = {
							id = druchiiinv.23012 days = 2150 random = 750
						}
					} # lunatic

				}
				35 = {
					character_event = {
						id = druchiiinv.23002
						days = 2150
						random = 1500
					}
				}
			}

		}
	}
}

# Druchii witch dies during training
character_event = {
	id = druchiiinv.23002
	desc = EVTDESCdruchiiinv23002
	picture = "GFX_evt_witch_elf"
	border = GFX_event_normal_frame_religion
	is_triggered_only = yes

	option = {
		name = EVTOPTAdruchiiinv23002
		death = {
			death_reason = death_battle
		}
	}
}

# Druchii witch training goes on well
character_event = {
	id = druchiiinv.23003
	desc = EVTDESCdruchiiinv23003
	picture = "GFX_evt_witch_elf"
	border = GFX_event_normal_frame_religion
	is_triggered_only = yes

	option = {
		name = EVTOPTAdruchiiinv23003
		piety = 250
		change_martial = 1
		change_stewardship = -3
		prestige = 100
		if = {
			limit = {
				is_female = no
			}
			remove_trait = disinherited
			diplomatic_immunity = no
			add_trait = druchi_assassin
		}
	}
}

# Witch Elf training: cruelty
character_event = {
	id = druchiiinv.23004
	desc = EVTDESCdruchiiinv23004
	picture = "GFX_evt_witch_elf"
	border = GFX_event_normal_frame_religion
	is_triggered_only = yes

	option = {
		name = EVTOPTAdruchiiinv23004
		add_trait = cruel
	}
}

# Witch Elf training: bravery
character_event = {
	id = druchiiinv.23005
	desc = EVTDESCdruchiiinv23005
	picture = "GFX_evt_witch_elf"
	border = GFX_event_normal_frame_religion
	is_triggered_only = yes

	option = {
		name = EVTOPTAdruchiiinv23005
		add_trait = brave
	}
}

# Witch Elf training: robust
character_event = {
	id = druchiiinv.23006
	desc = EVTDESCdruchiiinv23006
	picture = "GFX_evt_witch_elf"
	border = GFX_event_normal_frame_religion
	is_triggered_only = yes

	option = {
		name = EVTOPTAdruchiiinv23006
		hidden_tooltip = {
			remove_trait = undernourished
			remove_trait = fat
		}
		if = {
			limit = {
				NOT = {
					trait = robust
				}
			}
			add_trait = robust
		}
		if = {
			limit = {
				trait = robust
			}
			change_martial = 2
		}
	}
}

# Witch Elf training: zealotry
character_event = {
	id = druchiiinv.23007
	desc = EVTDESCdruchiiinv23007
	picture = "GFX_evt_witch_elf"
	border = GFX_event_normal_frame_religion
	is_triggered_only = yes

	option = {
		name = EVTOPTAdruchiiinv23007
		add_trait = zealous
	}
}

# Witch Elf training: scarred
character_event = {
	id = druchiiinv.23008
	desc = EVTDESCdruchiiinv23008
	picture = "GFX_evt_witch_elf"
	border = GFX_event_normal_frame_religion
	is_triggered_only = yes

	option = {
		name = EVTOPTAdruchiiinv23008
		add_trait = scarred
	}
}

# Witch Elf training: homosexuality
character_event = {
	id = druchiiinv.23009
	desc = EVTDESCdruchiiinv23009
	picture = "GFX_evt_witch_elf"
	border = GFX_event_normal_frame_religion
	is_triggered_only = yes

	option = {
		name = EVTOPTAdruchiiinv23009
		if = {
			limit = {
				NOT = {
					trait = homosexual
				}
			}
			add_trait = homosexual
		}
		if = {
			limit = {
				trait = homosexual
			}
			add_trait = lustful
		}
	}
}

# Witch Elf training: martial
character_event = {
	id = druchiiinv.23010
	desc = EVTDESCdruchiiinv23010
	picture = "GFX_evt_witch_elf"
	border = GFX_event_normal_frame_religion
	is_triggered_only = yes

	option = {
		name = EVTOPTAdruchiiinv23010
		change_martial = 1
	}
}

# Witch Elf training: maimed
character_event = {
	id = druchiiinv.23011
	desc = EVTDESCdruchiiinv23011
	picture = "GFX_evt_witch_elf"
	border = GFX_event_normal_frame_religion
	is_triggered_only = yes

	option = {
		name = EVTOPTAdruchiiinv23011
		add_trait = maimed
	}
}

# Witch Elf training: lunacy
character_event = {
	id = druchiiinv.23012
	desc = EVTDESCdruchiiinv23012
	picture = "GFX_evt_witch_elf"
	border = GFX_event_normal_frame_religion
	is_triggered_only = yes

	option = {
		name = EVTOPTAdruchiiinv23012
		hidden_tooltip = {
			change_variable = {
				which = "lunatic_counter"
				value = 2
			}
			random = {
				chance = 10
				change_variable = {
					which = "lunatic_counter"
					value = 4
				}
			}
			random = {
				chance = 5
				change_variable = {
					which = "lunatic_counter"
					value = 6
				}
			}
			character_event = {
				id = mutation.1005
			}
		} # lunacy counter
	}
}

# Elven baby is stolen by the Witches to be trained as an Assassin - first hidden event on birth.
character_event = {
	id = druchiiinv.24
	hide_window = yes
	religion_group = cytharai_group
	only_men = yes
	is_triggered_only = yes

	trigger = {
		location = {
			religion = cytharai
		}
	}

	immediate = {
		character_event = {
			id = druchiiinv.24001
			days = 10
			random = 20
		}
	}
}

# Kidnapping
character_event = {
	id = druchiiinv.24001
	desc = EVTDESCdruchiiinv24001
	picture = "GFX_evt_witch_elf"
	border = GFX_event_normal_frame_religion
	is_triggered_only = yes

	option = {
		name = EVTOPTAdruchiiinv24001
		diplomatic_immunity = yes
		abdicate = yes
		clear_wealth = ROOT
		religion = cytharai
		add_trait = in_hiding
		add_trait = disinherited
		father = {
			character_event = {
				id = druchiiinv.24002
			}
		}
		mother = {
			character_event = {
				id = druchiiinv.24002
			}
		}
		hidden_tooltip = {
			random_list = {
				85 = {
					modifier = {
						factor = 1.5
						trait = zealous
					}
					modifier = {
						factor = 0.75
						trait = cynical
					}
					modifier = {
						factor = 0.5
						trait = fragile
					}
					modifier = {
						factor = 0.75
						trait = weak
					}
					modifier = {
						factor = 0.85
						trait = soft
					}
					modifier = {
						factor = 1.25
						trait = hardy
					}
					modifier = {
						factor = 1.5
						trait = tough
					}
					modifier = {
						factor = 1.75
						trait = strong
					}
					modifier = {
						factor = 0.5
						trait = craven
					}
					modifier = {
						factor = 1.15
						trait = diligent
					}
					modifier = {
						factor = 0.85
						trait = drunkard
					}
					modifier = {
						factor = 0.85
						trait = addict
					}
					modifier = {
						factor = 1.75
						trait = brave
					}
					modifier = {
						factor = 0.85
						trait = fat
					}
					modifier = {
						factor = 0.85
						trait = undernourished
					}
					modifier = {
						factor = 1.5
						trait = ambitious
					}
					modifier = {
						factor = 0.85
						trait = content
					}
					modifier = {
						factor = 1.85
						trait = duelist
					}
					modifier = {
						factor = 1.5
						trait = hunter
					}
					modifier = {
						factor = 0.5
						trait = wounded
					}
					modifier = {
						factor = 0.25
						trait = maimed
					}
					modifier = {
						factor = 0.75
						trait = infirm
					}
					modifier = {
						factor = 0.25
						trait = blinded
					}
					modifier = {
						factor = 1.25
						trait = tall
					}
					modifier = {
						factor = 0.5
						trait = dwarf
					}
					modifier = {
						factor = 0.5
						trait = hunchback
					}
					modifier = {
						factor = 0.75
						trait = clubfooted
					}
					modifier = {
						factor = 1.25
						martial = 15
					}
					modifier = {
						factor = 0.85
						trait = stressed
					}
					modifier = {
						factor = 0.75
						trait = depressed
					}
					modifier = {
						factor = 0.95
						trait = dim
					}
					modifier = {
						factor = 0.9
						trait = dumb
					}
					modifier = {
						factor = 0.85
						trait = slow
					}
					modifier = {
						factor = 0.8
						trait = idiot
					}
					modifier = {
						factor = 0.75
						trait = imbecile
					}
					modifier = {
						factor = 1.15
						trait = bright
					}
					modifier = {
						factor = 1.2
						trait = smart
					}
					modifier = {
						factor = 1.25
						trait = quick
					}
					modifier = {
						factor = 1.3
						trait = brilliant
					}
					modifier = {
						factor = 1.35
						trait = genius
					}
					modifier = {
						factor = 0.85
						trait = slothful
					}
					modifier = {
						factor = 0.9
						trait = kind
					}
					modifier = {
						factor = 0.9
						trait = humble
					}
					modifier = {
						factor = 0.9
						trait = shy
					}
					modifier = {
						factor = 1.1
						trait = misguided_warrior
					}
					modifier = {
						factor = 1.35
						trait = tough_soldier
					}
					modifier = {
						factor = 1.5
						trait = skilled_tactician
					}
					modifier = {
						factor = 1.75
						trait = brilliant_strategist
					}
					modifier = {
						factor = 1.35
						trait = zealous
					}
					modifier = {
						factor = 1.15
						trait = cruel
					}
					modifier = {
						factor = 0.95
						trait = just
					}
					modifier = {
						factor = 0.85
						trait = complacent
					}
					modifier = {
						factor = 1.5
						trait = robust
					}
					modifier = {
						factor = 0.75
						trait = feeble
					}
					character_event = {
						id = druchiiinv.23003 days = 36500
					} # End training - 20 years
					random = {
						chance = 45
						character_event = {
							id = druchiiinv.23004 days = 3500 random = 150
						}
					} # cruel
					random = {
						chance = 35
						character_event = {
							id = druchiiinv.23005 days = 6500 random = 1500
						}
					} # brave
					random = {
						chance = 30
						character_event = {
							id = druchiiinv.23006 days = 7500 random = 2500
						}
					} # robust
					random = {
						chance = 60
						character_event = {
							id = druchiiinv.23007 days = 9500 random = 4500
						}
					} # zealous
					random = {
						chance = 25
						character_event = {
							id = druchiiinv.23008 days = 11500 random = 3500
						}
					} # scarred
					random = {
						chance = 20
						character_event = {
							id = druchiiinv.23009 days = 1500 random = 6500
						}
					} # homosexual
					random = {
						chance = 60
						character_event = {
							id = druchiiinv.23010 days = 13500 random = 2500
						}
					} # martial1
					random = {
						chance = 30
						character_event = {
							id = druchiiinv.23010 days = 16500 random = 5500
						}
					} # martial2
					random = {
						chance = 15
						character_event = {
							id = druchiiinv.23010 days = 16500 random = 7500
						}
					} # martial3
					random = {
						chance = 5
						character_event = {
							id = druchiiinv.23010 days = 19500 random = 8500
						}
					} # martial4
					random = {
						chance = 5
						character_event = {
							id = druchiiinv.23011 days = 14500 random = 6500
						}
					} # maimed
					random = {
						chance = 60
						character_event = {
							id = druchiiinv.23012 days = 21500 random = 7500
						}
					} # lunatic
					random = {
						chance = 30
						character_event = {
							id = druchiiinv.23012 days = 21500 random = 7500
						}
					} # lunatic
					random = {
						chance = 15
						character_event = {
							id = druchiiinv.23012 days = 21500 random = 7500
						}
					} # lunatic

				}
				15 = {
					character_event = {
						id = druchiiinv.23002 days = 7500 random = 1500
					}
				}
			}
		}
	}
}

# Notify parent of kidnapping
character_event = {
	id = druchiiinv.24002
	desc = EVTDESCdruchiiinv24002
	picture = "GFX_evt_witch_elf"
	border = GFX_event_normal_frame_religion
	is_triggered_only = yes

	option = {
		name = EVTOPTAdruchiiinv24002
		if = {
			limit = {
				religion = cytharai
			}
			piety = 150
		}
	}
}
